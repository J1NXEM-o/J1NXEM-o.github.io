

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/tubiao.png">
  <link rel="icon" href="/img/tubiao.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#4F4F4F">
  <meta name="author" content="J1NXEM">
  <meta name="keywords" content="zh-CN">
  
    <meta name="description" content="TemporalParadox写这一题用了快半天的时间www，反正得先把函数都理解透了才行 先找到主函数入口，有一个花指令，nop掉之后反编译 这里直接跳转，中间插入的就是花指令   注意，以下函数运行在所给的时间节点下v61 &gt; 1751990400 &amp;&amp; v61 &lt;&#x3D; 1752052051，主要看sub_140001963函数  具体分析看注释  大概就是">
<meta property="og:type" content="article">
<meta property="og:title" content="L3Hctf部分wp">
<meta property="og:url" content="https://j1nxem-o.github.io/2025/08/02/L3Hctf%E9%83%A8%E5%88%86wp/index.html">
<meta property="og:site_name" content="J1NXEM&#39;s blog">
<meta property="og:description" content="TemporalParadox写这一题用了快半天的时间www，反正得先把函数都理解透了才行 先找到主函数入口，有一个花指令，nop掉之后反编译 这里直接跳转，中间插入的就是花指令   注意，以下函数运行在所给的时间节点下v61 &gt; 1751990400 &amp;&amp; v61 &lt;&#x3D; 1752052051，主要看sub_140001963函数  具体分析看注释  大概就是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162340547.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930772.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930156.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162319533.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162331214.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930916.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930921.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930627.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930246.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930578.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930465.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930198.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507182250461.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181759290.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931046.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931624.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181825791.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181742060.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931028.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931733.png">
<meta property="article:published_time" content="2025-08-02T01:29:08.000Z">
<meta property="article:modified_time" content="2025-08-02T01:35:35.628Z">
<meta property="article:author" content="J1NXEM">
<meta property="article:tag" content="zh-CN">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162340547.png">
<meta name="twitter:creator" content="@J1NXEM">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>L3Hctf部分wp - J1NXEM&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="https://fontsapi.zeoseven.com/323/main/result.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"j1nxem-o.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2025-04-25T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>J1NXEM’s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/wenzhang.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="L3Hctf部分wp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        J1NXEM
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-08-02 09:29" pubdate>
          2025年8月2日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          42 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">L3Hctf部分wp</h1>
            
              <p id="updated-time" class="note note-info" style="display: none">
                
                  
                    本文最后更新于 2025-08-02T09:35:35+08:00
                  
                  

                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="TemporalParadox"><a href="#TemporalParadox" class="headerlink" title="TemporalParadox"></a>TemporalParadox</h1><p>写这一题用了快半天的时间www，反正得先把函数都理解透了才行</p>
<p>先找到主函数入口，有一个花指令，nop掉之后反编译</p>
<p>这里直接跳转，中间插入的就是花指令</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162340547.png" srcset="/img/loading.gif" lazyload alt="image-20250716234017426"></p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930772.png" srcset="/img/loading.gif" lazyload alt="image-20250716224607175"></p>
<p>注意，以下函数运行在所给的时间节点下v61 &gt; 1751990400 &amp;&amp; v61 &lt;&#x3D; 1752052051，主要看sub_140001963函数</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930156.png" srcset="/img/loading.gif" lazyload alt="image-20250716231843615"></p>
<p>具体分析看注释</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162319533.png" srcset="/img/loading.gif" lazyload alt="image-20250716231900454"></p>
<p>大概就是通过计算两个表达式是否相等来决定字符串的拼接，然后计算字符串的md5的值看是否与所给的密文相等</p>
<p>Salt: tlkyeueq7fej8vtzitt26yl24kswrgm5  固定值，通过以下代码得到</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">import math<br><br>dword_14000B060 = [<br>    <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000B4</span>, <span class="hljs-number">0xFFFFFF94</span>, <span class="hljs-number">0xFFFFFF86</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0xFFFFFF8A</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0xFFFFFF8E</span>,<br>    <span class="hljs-number">0xFFE7AC2D</span>, <span class="hljs-number">0x000000A2</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0x000000AE</span>, <span class="hljs-number">0xFFB70487</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000DE</span>,<br>    <span class="hljs-number">0xFFFFFF96</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0xFFFFE65F</span>, <span class="hljs-number">0xFFF7E40F</span>, <span class="hljs-number">0xFFFFFF86</span>, <span class="hljs-number">0x000000B4</span>, <span class="hljs-number">0xFFFFE65F</span>,<br>    <span class="hljs-number">0xFFFF1957</span>, <span class="hljs-number">0xFFFFFF94</span>, <span class="hljs-number">0xFFFFFF8C</span>, <span class="hljs-number">0xFFFFFF88</span>, <span class="hljs-number">0x000000C6</span>, <span class="hljs-number">0xFFFFFF98</span>, <span class="hljs-number">0xFFFFFF92</span>, <span class="hljs-number">0xFFFD4C05</span><br>]<br><br>salt_chars = []<br><br>for v9 <span class="hljs-keyword">in</span> dword_14000B060:<br>    if v9 &gt;= <span class="hljs-number">0x80000000</span>:  # 转换负数<br>        v9 -= <span class="hljs-number">0x100000000</span><br>    if v9 &gt;= <span class="hljs-number">0</span>:<br>        v10 = v9 // <span class="hljs-number">3</span> + <span class="hljs-number">48</span><br><span class="hljs-symbol">    else:</span><br>        if v9 &gt;= -<span class="hljs-number">728</span>:<br>            v10 = ~v9<br><span class="hljs-symbol">        else:</span><br>            v10 = <span class="hljs-keyword">int</span>(math<span class="hljs-number">.</span>log(-v9) / <span class="hljs-number">1.09861228866811</span> - <span class="hljs-number">6.0</span> + <span class="hljs-number">48.0</span>)<br>    salt_chars<span class="hljs-number">.</span>append(chr(v10))<br><br>salt = <span class="hljs-string">&#x27;&#x27;.join(salt_chars)</span><br><span class="hljs-string">print(&quot;Salt:&quot;, salt)</span><br></code></pre></td></tr></table></figure>

<p>r,a,b,x,y都与随机数生成有关，cipher的生成来自于函数sub_14000184D，同时也与两个置换盒有关</p>
<p>第 1～3 轮每轮用 sub_1400016A0的片段 xor 进状态，再做 s盒与p盒变换。</p>
<p>第 4 轮取第 4 片段 XOR，再做 仅 S盒；最后取第 5 片段再 xor，返回 cipher。</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162331214.png" srcset="/img/loading.gif" lazyload alt="image-20250716233103122"></p>
<p>这里的判断条件也与随机生成数有关，最终可以通过爆破来实现</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930916.png" srcset="/img/loading.gif" lazyload alt="image-20250716233149894"></p>
<p>整个过程就可以分为字符串为salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;a&#x3D;xxx&amp;b&#x3D;xxx&amp;x&#x3D;xxx&amp;y&#x3D;xxx和salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;cipher&#x3D;xxx两种进行爆破（最终结果是满足salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;a&#x3D;xxx&amp;b&#x3D;xxx&amp;x&#x3D;xxx&amp;y&#x3D;xxx这个字符串爆破成功）</p>
<p>这里贴出脚本，由于要用到openssl这个库，我直接在虚拟机上运行代码了，安装这个库也比在windows端方便多</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-meta">#include &lt;stdio.h&gt;</span><br><span class="hljs-meta">#include &lt;stdint.h&gt;</span><br><span class="hljs-meta">#include &lt;string.h&gt;</span><br><span class="hljs-meta">#include &lt;math.h&gt;</span><br><span class="hljs-meta">#include &lt;openssl/md5.h&gt;</span><br><span class="hljs-meta">#include &lt;openssl/sha.h&gt;</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SALT &quot;tlkyeueq7fej8vtzitt26yl24kswrgm5&quot;</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TARGET_MD5 &quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span><br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uint8_t SBOX[<span class="hljs-number">16</span>] = &#123;<br>    <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x01</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x05</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span><br>&#125;;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uint8_t PERM[<span class="hljs-number">16</span>] = &#123;<br>    <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">13</span>,<br>    <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>,<br>    <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>,<br>    <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> inline uint32_t <span class="hljs-title">truncate_to_u32</span>(<span class="hljs-params">uint64_t v</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> (uint32_t)(v &amp; <span class="hljs-number">0xFFFFFFFF</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> int32_t <span class="hljs-title">to_signed32</span>(<span class="hljs-params">uint32_t v</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (v &amp; <span class="hljs-number">0x80000000</span>)<br>        <span class="hljs-keyword">return</span> (int32_t)(v - <span class="hljs-number">0x100000000</span>);<br>    <span class="hljs-keyword">return</span> (int32_t)v;<br>&#125;<br><br><span class="hljs-comment">// 伪随机数生成器</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">prng_generate</span>(<span class="hljs-params">uint32_t *state, uint32_t *output</span>)</span> &#123;<br>    uint32_t val = *state;<br>    uint32_t v1 = (((val &lt;&lt; <span class="hljs-number">13</span>) ^ val) &gt;&gt; <span class="hljs-number">17</span>) ^ ((val &lt;&lt; <span class="hljs-number">13</span>) ^ val);<br>    uint32_t new_val = (<span class="hljs-number">32</span> * v1) ^ v1;<br>    *state = new_val;<br>    *output = new_val &amp; <span class="hljs-number">0x7FFFFFFF</span>;<br>&#125;<br><br><span class="hljs-function">uint32_t <span class="hljs-title">apply_sbox</span>(<span class="hljs-params">uint32_t input</span>)</span> &#123;<br>    uint32_t s = input;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        uint8_t index = (s &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0xF</span>;<br>        s = ((s &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>) | SBOX[index];<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br><br><span class="hljs-function">uint32_t <span class="hljs-title">apply_pbox</span>(<span class="hljs-params">uint32_t input</span>)</span> &#123;<br>    uint32_t s = input;<br>    uint32_t result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++) &#123;<br>        <span class="hljs-built_in">int</span> src_bit = PERM[i] - <span class="hljs-number">1</span>; <br>        <span class="hljs-keyword">if</span> ((s &gt;&gt; src_bit) &amp; <span class="hljs-number">1</span>) &#123;<br>            result |= (<span class="hljs-number">1</span> &lt;&lt; i);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// 一轮加密变换</span><br><span class="hljs-function">uint32_t <span class="hljs-title">perform_round</span>(<span class="hljs-params">uint32_t state</span>)</span> &#123;<br>    state = apply_sbox(state);<br>    state = apply_pbox(state);<br>    <span class="hljs-keyword">return</span> state;<br>&#125;<br><br><span class="hljs-comment">// 生成某轮轮密钥</span><br><span class="hljs-function">uint16_t <span class="hljs-title">generate_round_key</span>(<span class="hljs-params">uint32_t key, <span class="hljs-built_in">int</span> round</span>)</span> &#123;<br>    uint32_t shifted = (key &lt;&lt; (<span class="hljs-number">4</span> * (round - <span class="hljs-number">1</span>))) &amp; <span class="hljs-number">0xFFFFFFFF</span>;<br>    <span class="hljs-keyword">return</span> (shifted &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>;<br>&#125;<br><br><span class="hljs-comment">// 加密主函数，生成cipher</span><br><span class="hljs-function">uint16_t <span class="hljs-title">encrypt_token</span>(<span class="hljs-params">uint32_t timestamp, uint32_t round_key</span>)</span> &#123;<br>    uint32_t state = timestamp;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> round = <span class="hljs-number">1</span>; round &lt;= <span class="hljs-number">3</span>; round++) &#123;<br>        uint16_t rk = generate_round_key(round_key, round);<br>        state ^= rk;<br>        state = perform_round(state);<br>    &#125;<br><br>    uint16_t rk4 = generate_round_key(round_key, <span class="hljs-number">4</span>);<br>    state ^= rk4;<br>    state = apply_sbox(state);<br><br>    uint16_t rk5 = generate_round_key(round_key, <span class="hljs-number">5</span>);<br>    uint16_t final_state = (uint16_t)(state ^ rk5);<br>    <span class="hljs-keyword">return</span> final_state;<br>&#125;<br><br><span class="hljs-comment">// 计算字符串的MD5并转hex</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">compute_md5_hex</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* input, <span class="hljs-built_in">char</span> output[<span class="hljs-number">33</span>]</span>)</span> &#123;<br>    unsigned <span class="hljs-built_in">char</span> digest[MD5_DIGEST_LENGTH];<br>    MD5((<span class="hljs-keyword">const</span> unsigned <span class="hljs-built_in">char</span>*)input, strlen(input), digest);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; MD5_DIGEST_LENGTH; i++) &#123;<br>        sprintf(output + i * <span class="hljs-number">2</span>, <span class="hljs-string">&quot;%02x&quot;</span>, digest[i]);<br>    &#125;<br>    output[<span class="hljs-number">32</span>] = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// 计算字符串的SHA1并转hex</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">compute_sha1_hex</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* input, <span class="hljs-built_in">char</span> output[<span class="hljs-number">41</span>]</span>)</span> &#123;<br>    unsigned <span class="hljs-built_in">char</span> digest[SHA_DIGEST_LENGTH];<br>    SHA1((<span class="hljs-keyword">const</span> unsigned <span class="hljs-built_in">char</span>*)input, strlen(input), digest);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; SHA_DIGEST_LENGTH; i++) &#123;<br>        sprintf(output + i * <span class="hljs-number">2</span>, <span class="hljs-string">&quot;%02x&quot;</span>, digest[i]);<br>    &#125;<br>    output[<span class="hljs-number">40</span>] = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span> &#123;<br>    <span class="hljs-built_in">char</span> query[<span class="hljs-number">512</span>];<br>    <span class="hljs-built_in">char</span> md5_str[<span class="hljs-number">33</span>];<br>    <span class="hljs-built_in">char</span> sha1_str[<span class="hljs-number">41</span>];<br><br>    <span class="hljs-keyword">for</span> (uint32_t t = <span class="hljs-number">1751990400</span>; t &lt;= <span class="hljs-number">1752052051</span>; t++) &#123;<br>        uint32_t state = t;<br>        uint32_t output;<br>        prng_generate(&amp;state, &amp;output);<br>        uint32_t cnt = output;<br><br>        uint32_t a = <span class="hljs-number">0</span>, b = <span class="hljs-number">0</span>, x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>;<br>        uint32_t i = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">while</span> (i &lt; cnt) &#123;<br>            prng_generate(&amp;state, &amp;a);<br>            prng_generate(&amp;state, &amp;b);<br>            prng_generate(&amp;state, &amp;x);<br>            prng_generate(&amp;state, &amp;y);<br>            prng_generate(&amp;state, &amp;cnt);<br>            i++;<br>        &#125;<br><br>        prng_generate(&amp;state, &amp;output);<br>        uint32_t r = output;<br><br>        int32_t sa = to_signed32(a);<br>        int32_t sb = to_signed32(b);<br>        int32_t sx = to_signed32(x);<br>        int32_t sy = to_signed32(y);<br><br>        <span class="hljs-built_in">double</span> val1 = pow((<span class="hljs-built_in">double</span>)(sa | sx), <span class="hljs-number">2.0</span>);<br>        <span class="hljs-built_in">double</span> val2 = pow((<span class="hljs-built_in">double</span>)(sb | sy), <span class="hljs-number">2.0</span>);<br><br>        <span class="hljs-keyword">if</span> (fabs(<span class="hljs-number">0x61</span> * val1 - <span class="hljs-number">0xb</span> * val2) &lt; <span class="hljs-number">1e-9</span>) &#123;<br>            uint16_t cipher = encrypt_token(t, r);<br>            snprintf(query, <span class="hljs-keyword">sizeof</span>(query), <span class="hljs-string">&quot;salt=%s&amp;t=%u&amp;r=%u&amp;cipher=%u&quot;</span>,<br>                    SALT, t, r, cipher);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            snprintf(query, <span class="hljs-keyword">sizeof</span>(query), <span class="hljs-string">&quot;salt=%s&amp;t=%u&amp;r=%u&amp;a=%u&amp;b=%u&amp;x=%u&amp;y=%u&quot;</span>,<br>                    SALT, t, r, a, b, x, y);<br>        &#125;<br><br>        compute_md5_hex(query, md5_str);<br>        <span class="hljs-keyword">if</span> (strcmp(md5_str, TARGET_MD5) == <span class="hljs-number">0</span>) &#123;<br>            compute_sha1_hex(query, sha1_str);<br>            printf(<span class="hljs-string">&quot;[+] Found!\nQuery: %s\nMD5: %s\nSHA1: %s\n&quot;</span>,<br>                query, md5_str, sha1_str);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930921.png" srcset="/img/loading.gif" lazyload alt="image-20250716233822571"></p>
<h1 id="终焉之门"><a href="#终焉之门" class="headerlink" title="终焉之门"></a>终焉之门</h1><p>直接看看不到什么有用的代码，就直接动调，随便翻翻就看到了这个多层base64，解密一下hhhhh</p>
<p>后来知道这一段是用来循环异或加密得到主要逻辑的</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930627.png" srcset="/img/loading.gif" lazyload alt="image-20250717165521134"></p>
<p>aVersion430Core动调的时候双击进去看看，主加密内容放在了.data段</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930246.png" srcset="/img/loading.gif" lazyload alt="image-20250718000630226"></p>
<p>这段代码实现了一个运行在 GPU 上的简单虚拟机，通过执行<code>opcodes</code>中的指令序列，对栈数据进行运算</p>
<p>这里是核心校验</p>
<p>栈中的前 16 个数，必须等于 <code>cipher[i] - 20</code>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930578.png" srcset="/img/loading.gif" lazyload alt="image-20250718215943468"></p>
<hr>
<p>还可以通过另一个方法得到主要的逻辑</p>
<p>我先搜索字符串，找到那么一串base64编码，然后交叉引用找到函数</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930465.png" srcset="/img/loading.gif" lazyload alt="image-20250719213918550"></p>
<p>这个加密函数调用aVersion430Core的内容与base64编码进行循环异或</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930198.png" srcset="/img/loading.gif" lazyload alt="image-20250719214002648"></p>
<p>写出代码可以直接跑出内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-comment">#version 430 core</span><br><br>layout(local_size_x = <span class="hljs-number">1</span>, local_size_y = <span class="hljs-number">1</span>, local_size_z = <span class="hljs-number">1</span>) <span class="hljs-keyword">in</span>;<br>layout(std430, binding = <span class="hljs-number">0</span>) buffer OpCodes  &#123; <span class="hljs-built_in">int</span> opcodes[]; &#125;;<br>layout(std430, binding = <span class="hljs-number">2</span>) buffer CoConsts &#123; <span class="hljs-built_in">int</span> co_consts[]; &#125;;<br>layout(std430, binding = <span class="hljs-number">3</span>) buffer Cipher   &#123; <span class="hljs-built_in">int</span> cipher[<span class="hljs-number">16</span>]; &#125;;<br>layout(std430, binding = <span class="hljs-number">4</span>) buffer Stack    &#123; <span class="hljs-built_in">int</span> stack_data[<span class="hljs-number">256</span>]; &#125;;<br>layout(std430, binding = <span class="hljs-number">5</span>) buffer Out      &#123; <span class="hljs-built_in">int</span> verdict;         &#125;;<br><br>const <span class="hljs-built_in">int</span> MaxInstructionCount = <span class="hljs-number">1000</span>;<br><br>void main()<br>&#123;<br>    <span class="hljs-keyword">if</span> (gl_GlobalInvocationID.x &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br><br>    uint ip = 0u;<br>    <span class="hljs-built_in">int</span> sp = <span class="hljs-number">0</span>;<br>    verdict = -<span class="hljs-number">233</span>;<br><br>    <span class="hljs-keyword">while</span> (ip &lt; uint(MaxInstructionCount))<br>    &#123;<br>        <span class="hljs-built_in">int</span> opcode = opcodes[<span class="hljs-built_in">int</span>(ip)];<br>        <span class="hljs-built_in">int</span> arg    = opcodes[<span class="hljs-built_in">int</span>(ip)+<span class="hljs-number">1</span>];<br><br>        switch (opcode)<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                stack_data[sp++] = co_consts[arg];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = a + b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                stack_data[sp++] = a - b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">14</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = a ^ b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">15</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = <span class="hljs-built_in">int</span>(a == b);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            &#123;<br>                <span class="hljs-built_in">bool</span> ok = true;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (stack_data[i] != (cipher[i] - <span class="hljs-number">20</span>))<br>                    &#123; <br>                        ok = false; <br>                        <span class="hljs-keyword">break</span>; <br>                    &#125;<br>                &#125;<br>                verdict = ok ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">18</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> c = stack_data[--sp];<br>                <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) ip = uint(arg);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            default:<br>                verdict = <span class="hljs-number">500</span>;<br>                <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        ip+=<span class="hljs-number">2</span>;<br>    &#125;<br>    verdict = <span class="hljs-number">501</span>;<br>&#125;<br>l <br><br>进程已结束，退出代码为 <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>

<hr>
<p>从这三个地址里得到opcodes，co_consts和cipher的内容</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507182250461.png" srcset="/img/loading.gif" lazyload alt="image-20250718225015357"></p>
<p>这里贴出主函数的内容以及注释部分</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs c#">__int64 __<span class="hljs-function">fastcall <span class="hljs-title">sub_7FF656701CF0</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> a1</span>)</span><br>&#123;<br>  <span class="hljs-built_in">int</span> v1; <span class="hljs-comment">// ebx</span><br>  __m128i v2; <span class="hljs-comment">// xmm6</span><br>  unsigned <span class="hljs-built_in">int</span> v3; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v4; <span class="hljs-comment">// r13d</span><br>  unsigned <span class="hljs-built_in">int</span> v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">int</span> v6; <span class="hljs-comment">// eax</span><br>  __int64 v7; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-built_in">bool</span> v8; <span class="hljs-comment">// dl</span><br>  <span class="hljs-built_in">bool</span> v9; <span class="hljs-comment">// al</span><br>  <span class="hljs-built_in">int</span> v10; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">char</span> *v12; <span class="hljs-comment">// r15</span><br>  unsigned <span class="hljs-built_in">int</span> v13; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-built_in">int</span> v14; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v15; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-built_in">int</span> v16; <span class="hljs-comment">// edx</span><br>  <span class="hljs-built_in">int</span> v17; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">int</span> v18; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-built_in">int</span> v19; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v20; <span class="hljs-comment">// [rsp+38h] [rbp-100h]</span><br>  unsigned <span class="hljs-built_in">int</span> v21; <span class="hljs-comment">// [rsp+3Ch] [rbp-FCh]</span><br>  unsigned <span class="hljs-built_in">int</span> v22; <span class="hljs-comment">// [rsp+40h] [rbp-F8h]</span><br>  unsigned <span class="hljs-built_in">int</span> v23; <span class="hljs-comment">// [rsp+44h] [rbp-F4h]</span><br>  unsigned <span class="hljs-built_in">int</span> v24; <span class="hljs-comment">// [rsp+48h] [rbp-F0h]</span><br>  <span class="hljs-built_in">int</span> v25; <span class="hljs-comment">// [rsp+4Ch] [rbp-ECh]</span><br>  __m128i v26; <span class="hljs-comment">// [rsp+50h] [rbp-E8h] BYREF</span><br>  <span class="hljs-built_in">int</span> v27; <span class="hljs-comment">// [rsp+6Ch] [rbp-CCh] BYREF</span><br>  <span class="hljs-built_in">char</span> Str[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+70h] [rbp-C8h] BYREF</span><br>  __int64 v29; <span class="hljs-comment">// [rsp+78h] [rbp-C0h]</span><br>  __int64 v30; <span class="hljs-comment">// [rsp+80h] [rbp-B8h]</span><br>  __int64 v31; <span class="hljs-comment">// [rsp+88h] [rbp-B0h]</span><br>  __int64 v32[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-A8h] BYREF</span><br>  __int64 v33[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [rsp+C8h] [rbp-70h]</span><br><br>  v1 = <span class="hljs-number">0</span>;<br>  sub_7FF6566FE370();<br>  sub_7FF656693480(<span class="hljs-number">8256</span>);<br>  sub_7FF65668F730(<span class="hljs-number">0x500</span>u, <span class="hljs-number">0x320</span>u, <span class="hljs-string">&quot;Password Checker&quot;</span>);<span class="hljs-comment">// 创建窗口</span><br>  sub_7FF656691100(&amp;v26, <span class="hljs-number">0</span>i64, aVersion330Defi);<br>  v2 = _mm_loadu_si128(&amp;v26);<br>  v3 = sub_7FF65667E700(aVersion430Core, <span class="hljs-number">37305</span>i64);<span class="hljs-comment">// 创建计算着色器</span><br>  v20 = sub_7FF65667EEE0(v3);                   <span class="hljs-comment">// 创建着色器程序</span><br>  v21 = sub_7FF65667EFF0(<span class="hljs-number">0x2A0</span>u, &amp;unk_7FF6567030E0, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// opcodes</span><br>  v4 = sub_7FF65667EFF0(<span class="hljs-number">0x80</span>u, &amp;dword_7FF656703060, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// co_consts</span><br>  v22 = sub_7FF65667EFF0(<span class="hljs-number">0x40</span>u, &amp;unk_7FF656703020, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// cipher</span><br>  v23 = sub_7FF65667EFF0(<span class="hljs-number">0x400</span>u, &amp;unk_7FF65675F040, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// stack</span><br>  v5 = sub_7FF65667EFF0(<span class="hljs-number">4u</span>, &amp;dword_7FF656703000, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// verdict</span><br>  v33[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>i64;<br>  v24 = v5;<br>  *Str = <span class="hljs-number">0</span>i64;<br>  v29 = <span class="hljs-number">0</span>i64;<br>  v30 = <span class="hljs-number">0</span>i64;<br>  v31 = <span class="hljs-number">0</span>i64;<br>  memset(v32, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v32));<br>  *(v33 + <span class="hljs-number">5</span>) = <span class="hljs-number">0</span>i64;<br>  sub_7FF6566931A0(<span class="hljs-number">60</span>);<br>  <span class="hljs-keyword">while</span> ( !sub_7FF65668CAC0() )<br>  &#123;<br>    v6 = sub_7FF656695A40();                    <span class="hljs-comment">// 输入</span><br>    <span class="hljs-keyword">if</span> ( v6 &gt; <span class="hljs-number">0</span> &amp;&amp; v1 &lt;= <span class="hljs-number">99</span> )<br>    &#123;<br>      v7 = v1 + <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        Str[v7 - <span class="hljs-number">1</span>] = v6;<br>        v1 = v7;<br>        v6 = sub_7FF656695A40();<br>        v8 = v7++ &lt;= <span class="hljs-number">99</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v8 &amp;&amp; v6 &gt; <span class="hljs-number">0</span> );<br>    &#125;<br>    v9 = sub_7FF6566958E0(<span class="hljs-number">259</span>);<br>    <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">0</span> &amp;&amp; v9 )<br>      Str[--v1] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( sub_7FF6566958E0(<span class="hljs-number">257</span>) &amp;&amp; strlen(Str) == <span class="hljs-number">40</span> &amp;&amp; !strncmp(Str, <span class="hljs-string">&quot;L3HCTF&#123;&quot;</span>, <span class="hljs-number">7u</span>i64) &amp;&amp; HIBYTE(v32[<span class="hljs-number">0</span>]) == <span class="hljs-number">125</span> )<br>    &#123;                                           <span class="hljs-comment">// 提取花括号内的32个字符</span><br>      v25 = v1;<br>      v12 = &amp;Str[<span class="hljs-number">7</span>];<br>      v13 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span>                                        <span class="hljs-comment">// 将十六进制字符串转换为数值</span><br>      &#123;<br>        v17 = *v12;<br>        v18 = v12[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">if</span> ( v17 &gt; <span class="hljs-number">96</span> )<br>          v14 = v17 - <span class="hljs-number">87</span>;                       <span class="hljs-comment">// 字符转数字 (0-9, a-f, A-F)</span><br>        <span class="hljs-keyword">else</span><br>          v14 = v17 - <span class="hljs-number">48</span>;<br>        v19 = <span class="hljs-number">16</span> * v14;<br>        v15 = v13;<br>        v16 = v18 - <span class="hljs-number">48</span>;<br>        <span class="hljs-keyword">if</span> ( v18 &gt;= <span class="hljs-number">97</span> )<br>          v16 = v18 - <span class="hljs-number">87</span>;<br>        v12 += <span class="hljs-number">2</span>;<br>        v13 += <span class="hljs-number">4</span>;<br>        v27 = v16 + v19;                        <span class="hljs-comment">// 组合成一个字节</span><br>                                                <span class="hljs-comment">// 32 个字符被转换为 16 个整数，每个整数由 2 个十六进制字符组成</span><br>        sub_7FF65667F0B0(v4, &amp;v27, <span class="hljs-number">4u</span>, v15);    <span class="hljs-comment">// 将转换后的字节写入co_consts缓冲区</span><br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v32 + <span class="hljs-number">7</span> != v12 );<br>      v1 = v25;<br>      sub_7FF65667C100(v20);                    <span class="hljs-comment">// 执行计算着色器</span><br>      sub_7FF65667F180(v21, <span class="hljs-number">0</span>i64);              <span class="hljs-comment">// opcodes</span><br>      sub_7FF65667F180(v4, <span class="hljs-number">2</span>i64);               <span class="hljs-comment">// co_consts </span><br>      sub_7FF65667F180(v22, <span class="hljs-number">3</span>i64);              <span class="hljs-comment">// cipher</span><br>      sub_7FF65667F180(v23, <span class="hljs-number">4</span>i64);<br>      sub_7FF65667F180(v24, <span class="hljs-number">5</span>i64);<br>      sub_7FF65667EFE0(<span class="hljs-number">1</span>i64, <span class="hljs-number">1</span>i64, <span class="hljs-number">1</span>i64);       <span class="hljs-comment">// 执行着色器</span><br>      sub_7FF65667F140(v24, &amp;dword_7FF656703000, <span class="hljs-number">4</span>i64, <span class="hljs-number">0</span>i64);<br>      sub_7FF65667C110();<br>    &#125;<br>    sub_7FF65668FC90(a1);<br>    v26 = v2;<br>    sub_7FF656690650(&amp;v26);<br>    a1 = sub_7FF65668E170();<br>    v26 = v2;<br>    *&amp;a1 = a1;<br>    v27 = LODWORD(a1);<br>    v10 = sub_7FF656691440(&amp;v26);<br>    v26 = v2;<br>    sub_7FF656691460(v26.m128i_i64, v10, &amp;v27, <span class="hljs-number">0</span>);<br>    sub_7FF6566AB9D0(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1280</span>i64, <span class="hljs-number">0x320</span>u, <span class="hljs-number">0xFFFFFFFF</span>);<br>    sub_7FF656690690();<br>    sub_7FF6566BDA20(Str, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0xC8</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-16777216</span>);<br>    <span class="hljs-keyword">if</span> ( dword_7FF656703000 == <span class="hljs-number">1</span> )<br>      sub_7FF6566BDA20(<span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x12C</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-13863680</span>);<br>    <span class="hljs-keyword">else</span><br>      sub_7FF6566BDA20(<span class="hljs-string">&quot;wrong password&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x12C</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-13162010</span>);<br>    sub_7FF6566BDA20(<span class="hljs-string">&quot;Type password and press [Enter] to check!&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x64</span>u, <span class="hljs-number">20</span>, <span class="hljs-number">-8224126</span>);<br>    sub_7FF6566BDA20(<span class="hljs-string">&quot;Press [Backspace] to delete characters.&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x82</span>u, <span class="hljs-number">20</span>, <span class="hljs-number">-8224126</span>);<br>    sub_7FF656695CE0();<br>  &#125;<br>  sub_7FF65668FAA0();<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>得到关键信息之后，写一个解释器，看看虚拟机解释器是如何操作栈中的数据，得到加密逻辑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs python">STACK_SIZE = <span class="hljs-number">256</span><br>MAX_OPCODES = <span class="hljs-number">1000</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 指令流</span><br>    opcodes = [<br>        <span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">16</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">17</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">18</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">19</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">20</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">21</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">22</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">23</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">24</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">25</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">26</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">27</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">28</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">29</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">30</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">16</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">16</span>,<span class="hljs-number">2</span>,<span class="hljs-number">17</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">18</span>,<span class="hljs-number">84</span>,<span class="hljs-number">2</span>,<span class="hljs-number">31</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span><br>    ]<br><br>    <span class="hljs-comment"># 常量池（输入）</span><br>    co_consts = [<br>        <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBF</span>,<br>        <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x00</span><br>    ]<br><br>    <span class="hljs-comment"># cipher（目标值）</span><br>    cipher = [<br>        <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1FD</span>, <span class="hljs-number">0x150</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xDE</span>,<br>        <span class="hljs-number">0x15A</span>, <span class="hljs-number">0x197</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1D7</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x146</span>, <span class="hljs-number">0x97</span><br>    ]<br><br>    <span class="hljs-comment"># 初始化栈</span><br>    stack_data = [<span class="hljs-number">0</span>] * STACK_SIZE<br>    sp = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># 执行指令</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(opcodes):<br>        opcode = opcodes[i]<br>        arg = opcodes[i + <span class="hljs-number">1</span>]<br><br>        sp0 = sp  <span class="hljs-comment"># 保存执行前的栈指针位置</span><br><br>        <span class="hljs-keyword">if</span> opcode == <span class="hljs-number">2</span>:<br>            <span class="hljs-comment"># PUSH co_consts[arg]</span><br>            v = co_consts[arg] <span class="hljs-keyword">if</span> arg &lt; <span class="hljs-built_in">len</span>(co_consts) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            stack_data[sp] = v<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = co_consts[<span class="hljs-subst">&#123;arg&#125;</span>] = 0x<span class="hljs-subst">&#123;v:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">7</span>:<br>            <span class="hljs-comment"># ADD</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a + b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a + b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] + stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a + b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">8</span>:<br>            <span class="hljs-comment"># SUB a - b</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a - b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a - b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] - stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a - b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">14</span>:<br>            <span class="hljs-comment"># XOR</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a ^ b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a ^ b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] ^ stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a ^ b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">15</span>:<br>            <span class="hljs-comment"># EQ</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            result = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> a == b <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            stack_data[sp] = result<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = (a == b) = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] == stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;result:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">16</span>:<br>            <span class="hljs-comment"># VERIFY</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\t=== VERIFY cipher check ===&quot;</span>)<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>                expected = cipher[j] - <span class="hljs-number">20</span><br>                actual = stack_data[j]<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;    stack[<span class="hljs-subst">&#123;j:2d&#125;</span>]=0x<span class="hljs-subst">&#123;actual:X&#125;</span> vs cipher[<span class="hljs-subst">&#123;j:2d&#125;</span>]-20=0x<span class="hljs-subst">&#123;expected:X&#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;✅ Verification complete.&quot;</span>)<br>            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># 假设验证后程序结束</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">18</span>:<br>            <span class="hljs-comment"># JZ</span><br>            c = stack_data[sp - <span class="hljs-number">1</span>]<br>            sp -= <span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tJZ if top==0 jump to <span class="hljs-subst">&#123;arg&#125;</span> (top=0x<span class="hljs-subst">&#123;c:X&#125;</span>)&quot;</span>)<br>            <span class="hljs-keyword">if</span> c == <span class="hljs-number">0</span>:<br>                i = arg * <span class="hljs-number">2</span> - <span class="hljs-number">2</span>  <span class="hljs-comment"># 跳转到指定指令位置</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tUNKNOWN OPCODE <span class="hljs-subst">&#123;opcode&#125;</span>, abort&quot;</span>)<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>        i += <span class="hljs-number">2</span>  <span class="hljs-comment"># 下一条指令</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>过程：</p>
<p>每一步操作都是基于栈的，利用这三种运算<strong>异或（opcode&#x3D;14）</strong>、<strong>加法（opcode&#x3D;7）</strong>、<strong>减法（opcode&#x3D;8）</strong>，</p>
<p><em><strong>stack [2] 的生成为例（对应目标 t2）</strong></em></p>
<p>用户输入即co_consts的内容为x0-x15</p>
<p>步骤：</p>
<ul>
<li><p>[IP&#x3D;6]    加载 x2 到栈     stack[2] &#x3D; 0xFA &#x3D; x2；</p>
</li>
<li><p>[IP&#x3D;7]    加载 x1 到栈     stack[3] &#x3D; 0xC8 &#x3D; x1；</p>
</li>
<li><p>[IP&#x3D;8]    异或                   stack[2] &#x3D; stack[2]  ^ stack[3] &#x3D; x2 ^ x1；</p>
</li>
<li><p>[IP&#x3D;9]    加载 0到栈        stack[3] &#x3D; 0x0；</p>
</li>
<li><p>[IP&#x3D;10]   减法                  stack[2] &#x3D; stack[2] - stack[3]  &#x3D; stack[2] - 0  &#x3D; x2 ^ x1 。</p>
<p>需要满足x2 ^ x1 &#x3D; t2</p>
</li>
</ul>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs inform7"><span class="hljs-comment">[IP=0]</span>	stack_data<span class="hljs-comment">[0]</span> = co_consts<span class="hljs-comment">[0]</span> = 0xB0<br><span class="hljs-comment">[IP=1]</span>	stack_data<span class="hljs-comment">[1]</span> = co_consts<span class="hljs-comment">[1]</span> = 0xC8<br><span class="hljs-comment">[IP=2]</span>	stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[0]</span> = 0xB0<br><span class="hljs-comment">[IP=3]</span>	stack_data<span class="hljs-comment">[1]</span> = a ^ b = stack_data<span class="hljs-comment">[1]</span> ^ stack_data<span class="hljs-comment">[2]</span> = 0x78<br><span class="hljs-comment">[IP=4]</span>	stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[16]</span> = 0x0<br><span class="hljs-comment">[IP=5]</span>	stack_data<span class="hljs-comment">[1]</span> = a - b = stack_data<span class="hljs-comment">[1]</span> - stack_data<span class="hljs-comment">[2]</span> = 0x78<br><span class="hljs-comment">[IP=6]</span>	stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[2]</span> = 0xFA<br><span class="hljs-comment">[IP=7]</span>	stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[1]</span> = 0xC8<br><span class="hljs-comment">[IP=8]</span>	stack_data<span class="hljs-comment">[2]</span> = a ^ b = stack_data<span class="hljs-comment">[2]</span> ^ stack_data<span class="hljs-comment">[3]</span> = 0x32<br><span class="hljs-comment">[IP=9]</span>	stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[17]</span> = 0x0<br><span class="hljs-comment">[IP=10]</span>	stack_data<span class="hljs-comment">[2]</span> = a - b = stack_data<span class="hljs-comment">[2]</span> - stack_data<span class="hljs-comment">[3]</span> = 0x32<br><span class="hljs-comment">[IP=11]</span>	stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[3]</span> = 0x86<br><span class="hljs-comment">[IP=12]</span>	stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[2]</span> = 0xFA<br><span class="hljs-comment">[IP=13]</span>	stack_data<span class="hljs-comment">[3]</span> = a ^ b = stack_data<span class="hljs-comment">[3]</span> ^ stack_data<span class="hljs-comment">[4]</span> = 0x7C<br><span class="hljs-comment">[IP=14]</span>	stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[18]</span> = 0x0<br><span class="hljs-comment">[IP=15]</span>	stack_data<span class="hljs-comment">[3]</span> = a + b = stack_data<span class="hljs-comment">[3]</span> + stack_data<span class="hljs-comment">[4]</span> = 0x7C<br><span class="hljs-comment">[IP=16]</span>	stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[4]</span> = 0x6E<br><span class="hljs-comment">[IP=17]</span>	stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[3]</span> = 0x86<br><span class="hljs-comment">[IP=18]</span>	stack_data<span class="hljs-comment">[4]</span> = a ^ b = stack_data<span class="hljs-comment">[4]</span> ^ stack_data<span class="hljs-comment">[5]</span> = 0xE8<br><span class="hljs-comment">[IP=19]</span>	stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[19]</span> = 0x0<br><span class="hljs-comment">[IP=20]</span>	stack_data<span class="hljs-comment">[4]</span> = a + b = stack_data<span class="hljs-comment">[4]</span> + stack_data<span class="hljs-comment">[5]</span> = 0xE8<br><span class="hljs-comment">[IP=21]</span>	stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[5]</span> = 0x8F<br><span class="hljs-comment">[IP=22]</span>	stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[4]</span> = 0x6E<br><span class="hljs-comment">[IP=23]</span>	stack_data<span class="hljs-comment">[5]</span> = a ^ b = stack_data<span class="hljs-comment">[5]</span> ^ stack_data<span class="hljs-comment">[6]</span> = 0xE1<br><span class="hljs-comment">[IP=24]</span>	stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[20]</span> = 0x0<br><span class="hljs-comment">[IP=25]</span>	stack_data<span class="hljs-comment">[5]</span> = a - b = stack_data<span class="hljs-comment">[5]</span> - stack_data<span class="hljs-comment">[6]</span> = 0xE1<br><span class="hljs-comment">[IP=26]</span>	stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[6]</span> = 0xAF<br><span class="hljs-comment">[IP=27]</span>	stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[5]</span> = 0x8F<br><span class="hljs-comment">[IP=28]</span>	stack_data<span class="hljs-comment">[6]</span> = a ^ b = stack_data<span class="hljs-comment">[6]</span> ^ stack_data<span class="hljs-comment">[7]</span> = 0x20<br><span class="hljs-comment">[IP=29]</span>	stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[21]</span> = 0x0<br><span class="hljs-comment">[IP=30]</span>	stack_data<span class="hljs-comment">[6]</span> = a + b = stack_data<span class="hljs-comment">[6]</span> + stack_data<span class="hljs-comment">[7]</span> = 0x20<br><span class="hljs-comment">[IP=31]</span>	stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[7]</span> = 0xBF<br><span class="hljs-comment">[IP=32]</span>	stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[6]</span> = 0xAF<br><span class="hljs-comment">[IP=33]</span>	stack_data<span class="hljs-comment">[7]</span> = a ^ b = stack_data<span class="hljs-comment">[7]</span> ^ stack_data<span class="hljs-comment">[8]</span> = 0x10<br><span class="hljs-comment">[IP=34]</span>	stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[22]</span> = 0x0<br><span class="hljs-comment">[IP=35]</span>	stack_data<span class="hljs-comment">[7]</span> = a + b = stack_data<span class="hljs-comment">[7]</span> + stack_data<span class="hljs-comment">[8]</span> = 0x10<br><span class="hljs-comment">[IP=36]</span>	stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[8]</span> = 0xC9<br><span class="hljs-comment">[IP=37]</span>	stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[7]</span> = 0xBF<br><span class="hljs-comment">[IP=38]</span>	stack_data<span class="hljs-comment">[8]</span> = a ^ b = stack_data<span class="hljs-comment">[8]</span> ^ stack_data<span class="hljs-comment">[9]</span> = 0x76<br><span class="hljs-comment">[IP=39]</span>	stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[23]</span> = 0x0<br><span class="hljs-comment">[IP=40]</span>	stack_data<span class="hljs-comment">[8]</span> = a + b = stack_data<span class="hljs-comment">[8]</span> + stack_data<span class="hljs-comment">[9]</span> = 0x76<br><span class="hljs-comment">[IP=41]</span>	stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[9]</span> = 0x64<br><span class="hljs-comment">[IP=42]</span>	stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[8]</span> = 0xC9<br><span class="hljs-comment">[IP=43]</span>	stack_data<span class="hljs-comment">[9]</span> = a ^ b = stack_data<span class="hljs-comment">[9]</span> ^ stack_data<span class="hljs-comment">[10]</span> = 0xAD<br><span class="hljs-comment">[IP=44]</span>	stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[24]</span> = 0x0<br><span class="hljs-comment">[IP=45]</span>	stack_data<span class="hljs-comment">[9]</span> = a + b = stack_data<span class="hljs-comment">[9]</span> + stack_data<span class="hljs-comment">[10]</span> = 0xAD<br><span class="hljs-comment">[IP=46]</span>	stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[10]</span> = 0xD7<br><span class="hljs-comment">[IP=47]</span>	stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[9]</span> = 0x64<br><span class="hljs-comment">[IP=48]</span>	stack_data<span class="hljs-comment">[10]</span> = a ^ b = stack_data<span class="hljs-comment">[10]</span> ^ stack_data<span class="hljs-comment">[11]</span> = 0xB3<br><span class="hljs-comment">[IP=49]</span>	stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[25]</span> = 0x0<br><span class="hljs-comment">[IP=50]</span>	stack_data<span class="hljs-comment">[10]</span> = a + b = stack_data<span class="hljs-comment">[10]</span> + stack_data<span class="hljs-comment">[11]</span> = 0xB3<br><span class="hljs-comment">[IP=51]</span>	stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[11]</span> = 0xC3<br><span class="hljs-comment">[IP=52]</span>	stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[10]</span> = 0xD7<br><span class="hljs-comment">[IP=53]</span>	stack_data<span class="hljs-comment">[11]</span> = a ^ b = stack_data<span class="hljs-comment">[11]</span> ^ stack_data<span class="hljs-comment">[12]</span> = 0x14<br><span class="hljs-comment">[IP=54]</span>	stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[26]</span> = 0x0<br><span class="hljs-comment">[IP=55]</span>	stack_data<span class="hljs-comment">[11]</span> = a + b = stack_data<span class="hljs-comment">[11]</span> + stack_data<span class="hljs-comment">[12]</span> = 0x14<br><span class="hljs-comment">[IP=56]</span>	stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[12]</span> = 0xE3<br><span class="hljs-comment">[IP=57]</span>	stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[11]</span> = 0xC3<br><span class="hljs-comment">[IP=58]</span>	stack_data<span class="hljs-comment">[12]</span> = a ^ b = stack_data<span class="hljs-comment">[12]</span> ^ stack_data<span class="hljs-comment">[13]</span> = 0x20<br><span class="hljs-comment">[IP=59]</span>	stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[27]</span> = 0x0<br><span class="hljs-comment">[IP=60]</span>	stack_data<span class="hljs-comment">[12]</span> = a - b = stack_data<span class="hljs-comment">[12]</span> - stack_data<span class="hljs-comment">[13]</span> = 0x20<br><span class="hljs-comment">[IP=61]</span>	stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[13]</span> = 0xEF<br><span class="hljs-comment">[IP=62]</span>	stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[12]</span> = 0xE3<br><span class="hljs-comment">[IP=63]</span>	stack_data<span class="hljs-comment">[13]</span> = a ^ b = stack_data<span class="hljs-comment">[13]</span> ^ stack_data<span class="hljs-comment">[14]</span> = 0xC<br><span class="hljs-comment">[IP=64]</span>	stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[28]</span> = 0x0<br><span class="hljs-comment">[IP=65]</span>	stack_data<span class="hljs-comment">[13]</span> = a - b = stack_data<span class="hljs-comment">[13]</span> - stack_data<span class="hljs-comment">[14]</span> = 0xC<br><span class="hljs-comment">[IP=66]</span>	stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[14]</span> = 0x87<br><span class="hljs-comment">[IP=67]</span>	stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[13]</span> = 0xEF<br><span class="hljs-comment">[IP=68]</span>	stack_data<span class="hljs-comment">[14]</span> = a ^ b = stack_data<span class="hljs-comment">[14]</span> ^ stack_data<span class="hljs-comment">[15]</span> = 0x68<br><span class="hljs-comment">[IP=69]</span>	stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[29]</span> = 0x0<br><span class="hljs-comment">[IP=70]</span>	stack_data<span class="hljs-comment">[14]</span> = a + b = stack_data<span class="hljs-comment">[14]</span> + stack_data<span class="hljs-comment">[15]</span> = 0x68<br><span class="hljs-comment">[IP=71]</span>	stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[15]</span> = 0x0<br><span class="hljs-comment">[IP=72]</span>	stack_data<span class="hljs-comment">[16]</span> = co_consts<span class="hljs-comment">[14]</span> = 0x87<br><span class="hljs-comment">[IP=73]</span>	stack_data<span class="hljs-comment">[15]</span> = a ^ b = stack_data<span class="hljs-comment">[15]</span> ^ stack_data<span class="hljs-comment">[16]</span> = 0x87<br><span class="hljs-comment">[IP=74]</span>	stack_data<span class="hljs-comment">[16]</span> = co_consts<span class="hljs-comment">[30]</span> = 0x0<br><span class="hljs-comment">[IP=75]</span>	stack_data<span class="hljs-comment">[15]</span> = a - b = stack_data<span class="hljs-comment">[15]</span> - stack_data<span class="hljs-comment">[16]</span> = 0x87<br><span class="hljs-comment">[IP=76]</span>	=== VERIFY cipher check ===<br>    stack<span class="hljs-comment">[ 0]</span>=0xB0 vs cipher<span class="hljs-comment">[ 0]</span>-20=0xDF<br>    stack<span class="hljs-comment">[ 1]</span>=0x78 vs cipher<span class="hljs-comment">[ 1]</span>-20=0x6E<br>    stack<span class="hljs-comment">[ 2]</span>=0x32 vs cipher<span class="hljs-comment">[ 2]</span>-20=0x-E<br>    stack<span class="hljs-comment">[ 3]</span>=0x7C vs cipher<span class="hljs-comment">[ 3]</span>-20=0x1E9<br>    stack<span class="hljs-comment">[ 4]</span>=0xE8 vs cipher<span class="hljs-comment">[ 4]</span>-20=0x13C<br>    stack<span class="hljs-comment">[ 5]</span>=0xE1 vs cipher<span class="hljs-comment">[ 5]</span>-20=0x24<br>    stack<span class="hljs-comment">[ 6]</span>=0x20 vs cipher<span class="hljs-comment">[ 6]</span>-20=0x9E<br>    stack<span class="hljs-comment">[ 7]</span>=0x10 vs cipher<span class="hljs-comment">[ 7]</span>-20=0xCA<br>    stack<span class="hljs-comment">[ 8]</span>=0x76 vs cipher<span class="hljs-comment">[ 8]</span>-20=0x146<br>    stack<span class="hljs-comment">[ 9]</span>=0xAD vs cipher<span class="hljs-comment">[ 9]</span>-20=0x183<br>    stack<span class="hljs-comment">[10]</span>=0xB3 vs cipher<span class="hljs-comment">[10]</span>-20=0x88<br>    stack<span class="hljs-comment">[11]</span>=0x14 vs cipher<span class="hljs-comment">[11]</span>-20=0x1C3<br>    stack<span class="hljs-comment">[12]</span>=0x20 vs cipher<span class="hljs-comment">[12]</span>-20=0x5A<br>    stack<span class="hljs-comment">[13]</span>=0xC vs cipher<span class="hljs-comment">[13]</span>-20=0x14<br>    stack<span class="hljs-comment">[14]</span>=0x68 vs cipher<span class="hljs-comment">[14]</span>-20=0x132<br>    stack<span class="hljs-comment">[15]</span>=0x87 vs cipher<span class="hljs-comment">[15]</span>-20=0x83<br><br></code></pre></td></tr></table></figure>

<p>最终解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = [<span class="hljs-number">0xF3</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x97</span>]<br>target = [c - <span class="hljs-number">20</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher]<br>co_consts_fixed = [<span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x87</span>]<br><br>x = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br><br>x[<span class="hljs-number">0</span>] = target[<span class="hljs-number">0</span>]<br><br>x1_xor_x0 = target[<span class="hljs-number">1</span>] + co_consts_fixed[<span class="hljs-number">0</span>]<br>x[<span class="hljs-number">1</span>] = x1_xor_x0 ^ x[<span class="hljs-number">0</span>]<br>x1_xor_x0 = co_consts_fixed[<span class="hljs-number">0</span>] - target[<span class="hljs-number">1</span>]<br>x[<span class="hljs-number">1</span>] = x1_xor_x0 ^ x[<span class="hljs-number">0</span>]<br><br>x = [<br>    <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x4C</span>,<br>    <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x58</span><br>]<br><br><span class="hljs-comment"># 转换为32位十六进制（每个x[i]→2位，补0）</span><br>hex_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num:02x&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> x)<br><br><span class="hljs-comment"># 最终密码</span><br>password = <span class="hljs-string">f&quot;L3HCTF&#123;&#123;<span class="hljs-subst">&#123;hex_str&#125;</span>&#125;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;正确解密密码：&quot;</span>)<br><span class="hljs-built_in">print</span>(password)<br></code></pre></td></tr></table></figure>

<h1 id="ez-android"><a href="#ez-android" class="headerlink" title="ez_android"></a>ez_android</h1><p>这题也是花了一天多的时间才解决QAQ，真是不容易啊，还是得好好理解，多动动脑筋嘞~</p>
<p>直接在com目录下找到mainactivity，发现TauriActivity，不太清楚Tauri 框架是啥</p>
<p>在swdd的指导下先学习一下理论知识</p>
<hr>
<h2 id="TauriActivity"><a href="#TauriActivity" class="headerlink" title="TauriActivity"></a>TauriActivity</h2><p><code>TauriActivity</code> 是 Tauri 框架为 Android 平台提供的桥接 Activity 类，Tauri 是一个跨平台应用开发框架（主要用 Rust 编写），允许使用 Web 技术（HTML&#x2F;JS&#x2F;CSS） 构建前端，同时通过 Rust 后端实现逻辑。</p>
<p><code>TauriActivity</code> 的主要功能：</p>
<ol>
<li>提供一个 WebView 容器，加载应用前端（HTML&#x2F;JS）。</li>
<li>通过 JNI 调用 Rust 编译的共享库（<code>libtauri.so</code>）。</li>
<li>提供文件选择、权限处理、JS ↔ Rust 通信接口。</li>
</ol>
<hr>
<h4 id="Tauri-框架的静态资源提取方法"><a href="#Tauri-框架的静态资源提取方法" class="headerlink" title="Tauri 框架的静态资源提取方法:"></a><strong>Tauri 框架的静态资源提取方法:</strong></h4><p>先直接搜索关键词：index.html，交叉引用发现这里的包含文件名和文件位置的表</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181759290.png" srcset="/img/loading.gif" lazyload alt="image-20250718175941196"></p>
<p>以下代码把文件内容dump出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ida_python">import ida_bytes<br><br>addr = 0x00000000000C9498  <br>size = 0xEB                <br><br>dump = ida_bytes.get_bytes(addr, size)<br><br>file_path = r&quot;C:\Users\38489\Desktop\index_html.br&quot;<br>with open(file_path, &quot;wb&quot;) as f:<br>    f.write(dump)<br><br>print(f&quot;[+] 提取完成，文件已保存到: &#123;file_path&#125; (大小 &#123;len(dump)&#125; bytes)&quot;)<br></code></pre></td></tr></table></figure>

<p>由于我的idapython一直没法安装成功brotli，就先dump出来文件之后在本地解压缩</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> brotli<br><br>compressed_file_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index_html.br&quot;</span><br>output_file_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\dumpp&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(compressed_file_path, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Compressed file size: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(content)&#125;</span> bytes&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">try_decompress</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> brotli.decompress(data)<br>    <span class="hljs-keyword">except</span> brotli.error:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>decompressed = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(content), <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    decompressed = try_decompress(content[:i])<br>    <span class="hljs-keyword">if</span> decompressed <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">if</span> decompressed <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file_path, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decompressed)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decompressed content written to <span class="hljs-subst">&#123;output_file_path&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to decompress the content.&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>然后就可以读取html文件内容啦</p>
<hr>
<h4 id="这题的解题wp："><a href="#这题的解题wp：" class="headerlink" title="这题的解题wp："></a>这题的解题wp：</h4><p>解包apk文件之后看看有啥内容</p>
<p>打开assets想要找到.js文件或者.html文件，但是只有prof文件，说明前端资源被打包或者压缩了，结合tauri框架，前端文件可能被打包进rust后端可执行文件里了</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931046.png" srcset="/img/loading.gif" lazyload alt="image-20250717161547585"></p>
<p>ida反编译so文件</p>
<p>依照上面写的静态资源提取方法，解压缩index.html内容</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931624.png" srcset="/img/loading.gif" lazyload alt="image-20250718173951503"></p>
<p>index内容</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181825791.png" srcset="/img/loading.gif" lazyload alt="image-20250718182510695"></p>
<p>加载核心 JS，<code>index-BsFf5qny.js</code> 是打包后的 <strong>入口 JS</strong> 文件。负责启动 Vue 应用、挂载到 <code>#app</code>，以及通过 Tauri 的 API 调用 Rust 后端。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;module&quot;</span> crossorigin src=<span class="hljs-string">&quot;/assets/index-BsFf5qny.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>和上述过程一样，继续搜索关键词，找到这个js文件，dump出来后解压</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181742060.png" srcset="/img/loading.gif" lazyload alt="image-20250718174211972"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs idapython">import ida_bytes<br>import idc<br>import os<br><br>OUT_DIR = r&quot;C:\Users\38489\Desktop&quot;<br>RES_NAME = &quot;index-BsFf5qny.js.br&quot;  <br><br>data_ea = idc.get_name_ea_simple(&quot;unk_C356F&quot;)<br>if data_ea == idc.BADADDR:<br>    raise RuntimeError(&quot;找不到符号 unk_C356F，请确认名字一致。&quot;)<br><br>comp_size = 0x5D50<br><br>print(f&quot;[+] Dumping resource from 0x&#123;data_ea:X&#125;, size 0x&#123;comp_size:X&#125; (&#123;comp_size&#125; bytes)&quot;)<br><br>blob = ida_bytes.get_bytes(data_ea, comp_size)<br>if blob is None:<br>    raise RuntimeError(&quot;读取资源失败（可能地址或长度不对）。&quot;)<br><br>os.makedirs(OUT_DIR, exist_ok=True)<br>out_path = os.path.join(OUT_DIR, RES_NAME)<br>with open(out_path, &quot;wb&quot;) as f:<br>    f.write(blob)<br><br>print(f&quot;[+] 写出压缩文件: &#123;out_path&#125; (size=&#123;len(blob)&#125; bytes)&quot;)<br><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> brotli<br><br>in_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index-BsFf5qny.js.br&quot;</span><br>out_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index-BsFf5qny.js&quot;</span><br><br>data = <span class="hljs-built_in">open</span>(in_path, <span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-keyword">try</span>:<br>    dec = brotli.decompress(data)<br>    <span class="hljs-built_in">open</span>(out_path, <span class="hljs-string">&quot;wb&quot;</span>).write(dec)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] 成功解压 -&gt;&quot;</span>, out_path, <span class="hljs-string">&quot;长度&quot;</span>, <span class="hljs-built_in">len</span>(dec))<br><span class="hljs-keyword">except</span> brotli.error <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] 解压失败:&quot;</span>, e)<br><br></code></pre></td></tr></table></figure>

<p>解压出来之后，找到关键点：js与后端rust交互，后端接口是greet，</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931028.png" srcset="/img/loading.gif" lazyload alt="image-20250718183114865"></p>
<p>直接在ida里搜索greet，找到函数，就是主加密函数</p>
<p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931733.png" srcset="/img/loading.gif" lazyload></p>
<p>脚本</p>
<p>写脚本的时候还是要注意一下密文的提取，最后是v8的第19位与v19的第三位数据往后的八字节内容，当时脚本在密文这没好好分析，结果一直没出来，还是得注意一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>TABLE = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x64</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x7A</span>,<br>    <span class="hljs-number">0x59</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x51</span>,<br>    <span class="hljs-number">0x57</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x72</span><br>])<br><br>target_values = [<br>    <span class="hljs-number">0x0A409663A025150C</span>,<br>    <span class="hljs-number">0x1FE106294065165C</span>,<br>    <span class="hljs-number">0xFC020A4C0E2C7290</span>,<br>    <span class="hljs-number">0x2A324F</span><br>]<br><br>full_data = <span class="hljs-string">b&#x27;&#x27;</span>.join(struct.pack(<span class="hljs-string">&#x27;&lt;Q&#x27;</span>, v) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> target_values)<br>TARGET = full_data[:<span class="hljs-number">27</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol8</span>(<span class="hljs-params">x, n</span>): <span class="hljs-keyword">return</span> ((x &lt;&lt; (n&amp;<span class="hljs-number">7</span>)) | (x &gt;&gt; (<span class="hljs-number">8</span>-(n&amp;<span class="hljs-number">7</span>)))) &amp; <span class="hljs-number">0xFF</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror8</span>(<span class="hljs-params">x, n</span>): <span class="hljs-keyword">return</span> ((x &gt;&gt; (n&amp;<span class="hljs-number">7</span>)) | (x &lt;&lt; (<span class="hljs-number">8</span>-(n&amp;<span class="hljs-number">7</span>)))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward_byte</span>(<span class="hljs-params">i, b_in</span>):<br>    idx_mix = i <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">14</span> <span class="hljs-keyword">else</span> i - <span class="hljs-number">14</span><br>    tblA = TABLE[idx_mix]<br>    idx_dyn = (((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>) - <span class="hljs-number">14</span> * ((<span class="hljs-number">147</span> * ((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>)) &gt;&gt; <span class="hljs-number">11</span>)) &amp; <span class="hljs-number">0xFF</span><br>    tblB = TABLE[idx_dyn % <span class="hljs-built_in">len</span>(TABLE)]<br>    rot_src = TABLE[(i + <span class="hljs-number">3</span>) % <span class="hljs-number">14</span>]<br>    xsrc    = TABLE[(i + <span class="hljs-number">4</span>) % <span class="hljs-number">14</span>]<br>    rot     = rot_src &amp; <span class="hljs-number">7</span><br>    v11 = (tblB + (b_in ^ tblA)) &amp; <span class="hljs-number">0xFF</span><br>    <span class="hljs-keyword">return</span> xsrc ^ rol8(v11, rot)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_byte</span>(<span class="hljs-params">i, b_out</span>):<br>    idx_mix = i <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">14</span> <span class="hljs-keyword">else</span> i - <span class="hljs-number">14</span><br>    tblA = TABLE[idx_mix]<br>    idx_dyn = (((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>) - <span class="hljs-number">14</span> * ((<span class="hljs-number">147</span> * ((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>)) &gt;&gt; <span class="hljs-number">11</span>)) &amp; <span class="hljs-number">0xFF</span><br>    tblB = TABLE[idx_dyn % <span class="hljs-built_in">len</span>(TABLE)]<br>    rot_src = TABLE[(i + <span class="hljs-number">3</span>) % <span class="hljs-number">14</span>]<br>    xsrc    = TABLE[(i + <span class="hljs-number">4</span>) % <span class="hljs-number">14</span>]<br>    rot     = rot_src &amp; <span class="hljs-number">7</span><br>    r   = b_out ^ xsrc<br>    v11 = ror8(r, rot)<br>    tmp = (v11 - tblB) &amp; <span class="hljs-number">0xFF</span><br>    <span class="hljs-keyword">return</span> tmp ^ tblA<br><br>recovered = <span class="hljs-built_in">bytes</span>(reverse_byte(i, TARGET[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(TARGET)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Recovered 27-byte input:&quot;</span>, recovered)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hex:&quot;</span>, recovered.<span class="hljs-built_in">hex</span>())<br><br>recheck = <span class="hljs-built_in">bytes</span>(forward_byte(i, recovered[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(TARGET)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Forward recompute matches TARGET?:&quot;</span>, recheck == TARGET)<br><br></code></pre></td></tr></table></figure>

<p>完结撒花~</p>
<p>另附，学习这位师傅的tauri框架静态资源提取的方法<a target="_blank" rel="noopener" href="https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/">https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>L3Hctf部分wp</div>
      <div>https://j1nxem-o.github.io/2025/08/02/L3Hctf部分wp/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>J1NXEM</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年8月2日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年8月2日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/08/13/Justctf2025/" title="Justctf2025">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Justctf2025</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/02/%E8%8A%B1%E6%8C%87%E4%BB%A4-%E8%BF%91%E8%B7%B3%E8%BD%AC%E5%92%8Ccall0h%E5%9E%8B/" title="花指令-近跳转和call0h型">
                        <span class="hidden-mobile">花指令-近跳转和call0h型</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://imagegoo-twikoo.hf.space","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              Fluid.utils.listenDOMLoaded(function() {
                var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
                Fluid.plugins.imageCaption(imgSelector);
                Fluid.plugins.fancyBox(imgSelector);
              });
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <div>
  <span id="timeDate">正在载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
  var now = new Date();
  function createtime(){
      var grt= new Date("01/09/2025 00:00:00");
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "🚀已持续航行&nbsp"+dnum+"&nbsp天";
      document.getElementById("times").innerHTML = hnum + "&nbsp时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
  }
  setInterval("createtime()",250);
  </script>
</div>

  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  var relativeDate = function() {
    var updatedTime = document.getElementById('updated-time');
    if (updatedTime) {
      var text = updatedTime.textContent;
      var reg = /\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|[+-]\d{2}:\d{2})/;
      var matchs = text.match(reg);
      if (matchs) {
        var relativeTime = moment(matchs[0]).fromNow();
        updatedTime.textContent = text.replace(reg, relativeTime);
      }
      updatedTime.style.display = '';
    }
  };
  Fluid.utils.createScript('https://lib.baomitu.com/moment.js/2.29.4/moment.min.js', function() {
    if (!'zh-cn'.startsWith('en')) {
      Fluid.utils.createScript('https://lib.baomitu.com/moment.js/2.29.4/locale/zh-cn.min.js', function() {
        relativeDate();
      });
    } else {
      relativeDate();
    }
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="https://static.kevinchu.top/blog/assets/js/stars.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
